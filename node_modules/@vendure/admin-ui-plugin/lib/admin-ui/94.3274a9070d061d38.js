"use strict";(self.webpackChunkvendure_admin=self.webpackChunkvendure_admin||[]).push([[94],{94:(Os,Ue,d)=>{d.r(Ue),d.d(Ue,{AddCountryToZoneDialogComponent:()=>ee,AdminDetailComponent:()=>te,AdministratorListComponent:()=>ne,ChannelDetailComponent:()=>oe,ChannelListComponent:()=>ie,CountryDetailComponent:()=>ae,CountryListComponent:()=>se,GET_ADMINISTRATOR_DETAIL:()=>Wt,GET_ADMINISTRATOR_LIST:()=>pn,GET_CHANNEL_DETAIL:()=>Dn,GET_CHANNEL_LIST:()=>wn,GET_COUNTRY_DETAIL:()=>Hn,GET_COUNTRY_LIST:()=>lo,GET_GLOBAL_SETTINGS_DETAIL:()=>uo,GET_PAYMENT_METHOD_DETAIL:()=>Ao,GET_PAYMENT_METHOD_LIST:()=>Uo,GET_PROFILE_DETAIL:()=>wo,GET_ROLE_DETAIL:()=>zo,GET_ROLE_LIST:()=>vi,GET_SELLER_DETAIL:()=>xi,GET_SHIPPING_METHOD_DETAIL:()=>da,GET_SHIPPING_METHOD_LIST:()=>ya,GET_TAX_CATEGORY_DETAIL:()=>Ia,GET_TAX_CATEGORY_LIST:()=>Ra,GET_TAX_RATE_DETAIL:()=>za,GET_TAX_RATE_LIST:()=>us,GET_ZONE_DETAIL:()=>Cs,GET_ZONE_LIST:()=>Us,GET_ZONE_MEMBERS:()=>Ut,GlobalSettingsComponent:()=>re,PaymentMethodDetailComponent:()=>le,PaymentMethodListComponent:()=>ce,PermissionGridComponent:()=>B,ProfileComponent:()=>de,ProfileResolver:()=>xe,RoleDetailComponent:()=>me,RoleListComponent:()=>ue,SellerDetailComponent:()=>pe,SellerListComponent:()=>ge,SettingsModule:()=>Fe,ShippingEligibilityTestResultComponent:()=>he,ShippingMethodDetailComponent:()=>fe,ShippingMethodListComponent:()=>Ce,ShippingMethodTestResultComponent:()=>_e,TaxCategoryDetailComponent:()=>ve,TaxCategoryListComponent:()=>be,TaxRateDetailComponent:()=>Ze,TaxRateListComponent:()=>Te,TestAddressFormComponent:()=>z,TestOrderBuilderComponent:()=>H,TestShippingMethodsComponent:()=>ye,ZoneDetailComponent:()=>Ae,ZoneListComponent:()=>Le,ZoneMemberControlsDirective:()=>X,ZoneMemberListComponent:()=>w,ZoneMemberListHeaderDirective:()=>W,assignPaymentMethodsToChannelBulkAction:()=>nt,assignShippingMethodsToChannelBulkAction:()=>ct,createRoutes:()=>ft,deleteAdministratorsBulkAction:()=>Ye,deleteChannelsBulkAction:()=>Be,deleteCountriesBulkAction:()=>je,deletePaymentMethodsBulkAction:()=>tt,deleteRolesBulkAction:()=>it,deleteSellersBulkAction:()=>at,deleteShippingMethodsBulkAction:()=>lt,deleteTaxCategoriesBulkAction:()=>mt,deleteTaxRatesBulkAction:()=>ut,deleteZonesBulkAction:()=>pt,removePaymentMethodsFromChannelBulkAction:()=>ot,removeShippingMethodsFromChannelBulkAction:()=>dt,removeZoneMembersBulkAction:()=>_t});var s=d(5209),f=d(7698),Ct=d(9931),Oe=d(2493),vt=d(3346),bt=d(5300),Zt=d(5855),Tt=d(4789);function $e(...o){const n=(0,Tt.jO)(o);return(0,Ct.e)((t,i)=>{const a=o.length,c=new Array(a);let m=o.map(()=>!1),C=!1;for(let _=0;_<a;_++)(0,vt.Xf)(o[_]).subscribe((0,Oe.x)(i,$=>{c[_]=$,!C&&!m[_]&&(m[_]=!0,(C=m.every(bt.y))&&(m=null))},Zt.Z));t.subscribe((0,Oe.x)(i,_=>{if(C){const $=[_,...c];i.next(n?n(...$):$)}}))})}var b=d(2303),e=d(3162),yt=d(8356),At=d(8279),r=d(6008),Je=d(8077),Lt=d(4400),Se=d(7826),Ie=d(407),Pe=d(2680),K=d(7296),J=d(233),Re=d(4467),xt=d(6821);class X{constructor(n){this.templateRef=n}}X.\u0275fac=function(n){return new(n||X)(e.Y36(e.Rgc))},X.\u0275dir=e.lG2({type:X,selectors:[["","vdrZoneMemberControls",""]]});class W{constructor(n){this.templateRef=n}}W.\u0275fac=function(n){return new(n||W)(e.Y36(e.Rgc))},W.\u0275dir=e.lG2({type:W,selectors:[["","vdrZoneMemberListHeader",""]]});var g=d(296),u=d(7347),y=d(3576),E=d(6489),I=d(5757),P=d(8862),D=d(7869),k=d(4246),h=d(2477),N=d(2050);function Ft(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function Jt(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function It(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}const Pt=function(o){return["/settings/countries",o]};function Dt(o,n){if(1&o&&(e.TgZ(0,"a",6)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",7),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,Pt,t.id)),e.xp6(2),e.hij(" ",t.name,"")}}function kt(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.code," ")}}function Nt(o,n){1&o&&(e.TgZ(0,"vdr-chip",10),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.enabled")))}function St(o,n){1&o&&(e.TgZ(0,"vdr-chip",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.disabled")))}function qt(o,n){if(1&o&&(e.YNc(0,Nt,3,3,"vdr-chip",8),e.YNc(1,St,3,3,"vdr-chip",9)),2&o){const t=n.item;e.Q6J("ngIf",t.enabled),e.xp6(1),e.Q6J("ngIf",!t.enabled)}}class w{constructor(n){this.dataService=n,this.selectedMemberIds=[],this.selectionChange=new e.vpe,this.filterTermControl=new r.NI(""),this.currentPage=1,this.itemsPerPage=10,this.selectionManager=new s.ZE0({multiSelect:!0,itemsAreEqual:(t,i)=>t.id===i.id,additiveMode:!0}),this.membersInput$=new Je.x,this.activeZoneInput$=new Lt.X(void 0),this.destroy$=new Je.x,this.refresh$=new Je.x}ngOnInit(){const n=(0,Se.T)(this.activeZoneInput$,this.refresh$).pipe((0,Ie.w)(t=>this.activeZone?this.dataService.query(s.iWU,{zoneId:this.activeZone.id}).mapSingle(({zone:i})=>i?.members??[]):(0,Pe.of)([])));this.members$=(0,Se.T)(n,this.membersInput$),this.members$.pipe((0,J.q)(1)).subscribe(t=>{this.selectionManager.setCurrentItems(t?.filter(i=>this.selectedMemberIds.includes(i.id))??[])}),this.selectionManager.selectionChanges$.pipe((0,Re.R)(this.destroy$)).subscribe(t=>{this.selectionChange.emit(t.map(i=>i.id))}),this.filteredMembers$=(0,K.a)(this.members$,this.filterTermControl.valueChanges.pipe((0,xt.O)(""))).pipe((0,b.U)(([t,i])=>{if(i){const a=i?.toLocaleLowerCase()??"";return t.filter(c=>c.name.toLocaleLowerCase().includes(a)||c.code.toLocaleLowerCase().includes(a))}return t})),this.totalItems$=this.filteredMembers$.pipe((0,b.U)(t=>t.length))}ngOnChanges(n){"members"in n&&this.membersInput$.next(this.members??[]),"activeZone"in n&&this.activeZoneInput$.next(this.activeZone)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}refresh(){this.refresh$.next()}}w.\u0275fac=function(n){return new(n||w)(e.Y36(s.DoR))},w.\u0275cmp=e.Xpm({type:w,selectors:[["vdr-zone-member-list"]],contentQueries:function(n,t,i){if(1&n&&(e.Suo(i,W,5),e.Suo(i,X,5)),2&n){let a;e.iGM(a=e.CRH())&&(t.headerTemplate=a.first),e.iGM(a=e.CRH())&&(t.controlsTemplate=a.first)}},inputs:{locationId:"locationId",members:"members",selectedMemberIds:"selectedMemberIds",activeZone:"activeZone"},outputs:{selectionChange:"selectionChange"},features:[e.TTD],decls:24,vars:38,consts:[[3,"id","items","totalItems","itemsPerPage","currentPage","itemsPerPageChange","pageChange"],[3,"locationId","hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault"],[3,"heading","optional"],[3,"heading"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],["colorType","success",4,"ngIf"],["colorType","warning",4,"ngIf"],["colorType","success"],["colorType","warning"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-data-table-2",0),e.NdJ("itemsPerPageChange",function(a){return t.itemsPerPage=a})("pageChange",function(a){return t.currentPage=a}),e.ALo(1,"async"),e.ALo(2,"async"),e._UZ(3,"vdr-bulk-action-menu",1)(4,"vdr-dt2-search",2),e.ALo(5,"translate"),e.TgZ(6,"vdr-dt2-column",3),e.ALo(7,"translate"),e.YNc(8,Ft,1,1,"ng-template"),e.qZA(),e.TgZ(9,"vdr-dt2-column",3),e.ALo(10,"translate"),e.YNc(11,Jt,2,4,"ng-template"),e.qZA(),e.TgZ(12,"vdr-dt2-column",3),e.ALo(13,"translate"),e.YNc(14,It,2,4,"ng-template"),e.qZA(),e.TgZ(15,"vdr-dt2-column",4),e.ALo(16,"translate"),e.YNc(17,Dt,4,4,"ng-template"),e.qZA(),e.TgZ(18,"vdr-dt2-column",5),e.ALo(19,"translate"),e.YNc(20,kt,1,1,"ng-template"),e.qZA(),e.TgZ(21,"vdr-dt2-column",5),e.ALo(22,"translate"),e.YNc(23,qt,2,2,"ng-template"),e.qZA()()),2&n&&(e.Q6J("id",t.locationId)("items",e.lcZ(1,20,t.filteredMembers$))("totalItems",e.lcZ(2,22,t.totalItems$))("itemsPerPage",t.itemsPerPage)("currentPage",t.currentPage),e.xp6(3),e.Q6J("locationId",t.locationId)("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.filterTermControl)("searchTermPlaceholder",e.lcZ(5,24,"common.search-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(7,26,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(10,28,"common.created-at"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(13,30,"common.updated-at"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(16,32,"common.name"))("optional",!1),e.xp6(3),e.Q6J("heading",e.lcZ(19,34,"common.code")),e.xp6(3),e.Q6J("heading",e.lcZ(22,36,"common.enabled")))},dependencies:[g.qvL,u.O5,y.rH,E.Y,I.c,P.e,D.U,k.J,u.Ov,h.X$,N.H],styles:[".members-header[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);position:sticky;top:0;padding:6px;z-index:5;border-bottom:1px solid var(--color-component-border-200)}.members-header[_ngcontent-%COMP%]   .header-title-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.members-header[_ngcontent-%COMP%]   .clr-input[_ngcontent-%COMP%]{width:100%}"],changeDetection:0});const we=function(o){return{zoneName:o}};function Mt(o,n){if(1&o&&(e._uU(0),e.ALo(1,"translate")),2&o){const t=e.oxw();e.Oqu(e.xi3(1,1,"settings.add-countries-to-zone",e.VKq(4,we,t.zoneName)))}}function Qt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",3),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"button",4),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.add())}),e._uU(4),e.ALo(5,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"common.cancel")),e.xp6(2),e.Q6J("disabled",!t.selectedMemberIds.length),e.xp6(1),e.hij(" ",e.xi3(5,5,"settings.add-countries-to-zone",e.VKq(8,we,t.zoneName))," ")}}const Ut=f.Ps`
    query GetZoneMembers($zoneId: ID!) {
        zone(id: $zoneId) {
            id
            createdAt
            updatedAt
            name
            members {
                createdAt
                updatedAt
                id
                name
                code
                enabled
            }
        }
    }
`;class ee{constructor(n){this.dataService=n,this.selectedMemberIds=[]}ngOnInit(){this.currentMembers$=this.dataService.query(s.iWU,{zoneId:this.zoneId}).mapSingle(({zone:n})=>n?.members??[]),this.availableCountries$=this.dataService.query(s.p6B,{options:{take:999}}).mapStream(n=>n.countries.items).pipe($e(this.currentMembers$),(0,b.U)(([n,t])=>n.filter(i=>!t.find(a=>a.id===i.id))))}cancel(){this.resolveWith()}add(){this.resolveWith(this.selectedMemberIds)}}ee.\u0275fac=function(n){return new(n||ee)(e.Y36(s.DoR))},ee.\u0275cmp=e.Xpm({type:ee,selectors:[["vdr-add-country-to-zone-dialog"]],decls:4,vars:4,consts:[["vdrDialogTitle",""],[3,"members","selectedMemberIds","selectionChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(n,t){1&n&&(e.YNc(0,Mt,2,6,"ng-template",0),e.TgZ(1,"vdr-zone-member-list",1),e.NdJ("selectionChange",function(a){return t.selectedMemberIds=a}),e.ALo(2,"async"),e.qZA(),e.YNc(3,Qt,6,10,"ng-template",2)),2&n&&(e.xp6(1),e.Q6J("members",e.lcZ(2,2,t.availableCountries$))("selectedMemberIds",t.selectedMemberIds))},dependencies:[yt.n,At.q,w,u.Ov,h.X$],changeDetection:0});var l=d(8511),G=d(6884),Ot=d(5387),L=d(8227),$t=d(7734),p=d(8763),x=d(4889),A=d(8434),T=d(3736),Z=d(4753),S=d(7536),q=d(9617),v=d(3827),M=d(7362),Q=d(3332),U=d(3661),F=d(7790),Rt=d(9555);function wt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,c=e.oxw();return e.KtG(c.toggleAll(a.permissions))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"common.toggle-all")," "))}function Yt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"td")(1,"vdr-select-toggle",5),e.NdJ("selectedChange",function(a){const m=e.CHM(t).$implicit,C=e.oxw(2);return e.KtG(C.setPermission(m.name,a))}),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw().$implicit,a=e.oxw();e.uIk("colspan",1===i.permissions.length?4:1),e.xp6(1),e.Q6J("title",t.description)("label",t.name)("disabled",a.readonly)("selected",null==a.activePermissions?null:a.activePermissions.includes(t.name))}}function Et(o,n){if(1&o&&(e.TgZ(0,"tr")(1,"td",2)(2,"div")(3,"strong"),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"small"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e._UZ(9,"br"),e.YNc(10,wt,3,3,"button",3),e.qZA(),e.YNc(11,Yt,2,5,"td",1),e.qZA()),2&o){const t=n.$implicit,i=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,4,t.label)),e.xp6(3),e.Oqu(e.lcZ(8,6,t.description)),e.xp6(3),e.Q6J("ngIf",1<t.permissions.length&&!i.readonly),e.xp6(1),e.Q6J("ngForOf",t.permissions)}}class B{constructor(){this.readonly=!1,this.permissionChange=new e.vpe}ngOnInit(){this.buildGrid()}setPermission(n,t){this.readonly||this.permissionChange.emit({permission:n,value:t})}toggleAll(n){const t=n.some(i=>!this.activePermissions.includes(i.name));for(const i of n)this.permissionChange.emit({permission:i.name,value:t})}buildGrid(){const n=new Map,t=[],i=/^(Create|Read|Update|Delete)([a-zA-Z]+)$/;for(const a of this.permissionDefinitions)if(i.test(a.name)){const m=a.name.match(i)?.[2];if(m){const C=n.get(m);C?C.push(a):n.set(m,[a])}}else a.assignable&&t.push(a);this.gridData=[...t.map(a=>({label:a.name,description:a.description,permissions:[a]})),...Array.from(n.entries()).map(([a,c])=>({label:a,description:this.extractCrudDescription(c[0]),permissions:c}))]}extractCrudDescription(n){return n.description.replace(/Grants permission to [\w]+/,"Grants permissions on")}}B.\u0275fac=function(n){return new(n||B)},B.\u0275cmp=e.Xpm({type:B,selectors:[["vdr-permission-grid"]],inputs:{permissionDefinitions:"permissionDefinitions",activePermissions:"activePermissions",readonly:"readonly"},outputs:{permissionChange:"permissionChange"},decls:3,vars:1,consts:[[1,"table"],[4,"ngFor","ngForOf"],[1,"permission-group","left"],["class","button-small",3,"click",4,"ngIf"],[1,"button-small",3,"click"],["size","small",3,"title","label","disabled","selected","selectedChange"]],template:function(n,t){1&n&&(e.TgZ(0,"table",0)(1,"tbody"),e.YNc(2,Et,12,8,"tr",1),e.qZA()()),2&n&&(e.xp6(2),e.Q6J("ngForOf",t.gridData))},dependencies:[u.sg,u.O5,Rt.a,h.X$],styles:["[_nghost-%COMP%]{display:block}td.permission-group[_ngcontent-%COMP%]{max-width:300px;background-color:var(--color-component-bg-200)}"],changeDetection:0});var O=d(8064),De=d(5734);function Gt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function Bt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function jt(o,n){1&o&&e.YNc(0,Bt,3,4,"button",22),2&o&&e.Q6J("vdrIfPermissions","UpdateAdministrator")}function Ht(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",23),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function zt(o,n){1&o&&(e.TgZ(0,"vdr-form-field",24),e.ALo(1,"translate"),e._UZ(2,"input",25),e.qZA()),2&o&&e.Q6J("label",e.lcZ(1,1,"settings.password"))}function Vt(o,n){1&o&&(e.TgZ(0,"vdr-form-field",26),e.ALo(1,"translate"),e._UZ(2,"input",25),e.qZA()),2&o&&e.Q6J("label",e.lcZ(1,2,"settings.password"))("readOnlyToggle",!0)}function Kt(o,n){if(1&o&&(e.TgZ(0,"vdr-card",27),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",28),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))}}function Xt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"li",29)(1,"button",30),e.NdJ("click",function(){const c=e.CHM(t).$implicit,m=e.oxw();return e.KtG(m.selectedChannelId=c.channelId)}),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"channelCodeToLabel"),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw();e.xp6(1),e.ekj("active",i.selectedChannelId===t.channelId),e.Q6J("id",t.channelId),e.uIk("aria-selected",i.selectedChannelId===t.channelId),e.xp6(1),e.hij(" ",e.lcZ(3,5,e.lcZ(4,7,t.channelCode))," ")}}const ke=function(){return["CreateAdministrator","UpdateAdministrator"]},Wt=f.Ps`
    query GetAdministratorDetail($id: ID!) {
        administrator(id: $id) {
            ...Administrator
        }
    }
    ${s.EEY}
`;class te extends s.VE7{getAvailableChannels(){return Object.values(this.selectedRolePermissions)}constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.customFields=this.getCustomFieldConfig("Administrator"),this.detailForm=this.formBuilder.group({emailAddress:["",r.kI.required],firstName:["",r.kI.required],lastName:["",r.kI.required],password:[""],roles:[[]],customFields:this.formBuilder.group(this.customFields.reduce((c,m)=>({...c,[m.name]:""}),{}))}),this.selectedRoles=[],this.selectedRolePermissions={},this.selectedChannelId=null}ngOnInit(){this.init(),this.allRoles$=this.dataService.administrator.getRoles(999).mapStream(n=>n.roles.items.filter(t=>t.code!==G.RO)),this.dataService.client.userStatus().single$.subscribe(({userStatus:n})=>{if(!n.permissions.includes(s.y3$.CreateAdministrator)&&!n.permissions.includes(s.y3$.UpdateAdministrator)){const t=this.detailForm.get("roles");t&&t.disable()}}),this.permissionDefinitions=this.serverConfigService.getPermissionDefinitions()}ngOnDestroy(){this.destroy()}rolesChanged(n){this.buildPermissionsMap()}getPermissionsForSelectedChannel(){function n(i){return Object.entries(i).filter(([a,c])=>c).map(([a,c])=>a)}if(this.selectedChannelId&&this.selectedRolePermissions[this.selectedChannelId]){return n(this.selectedRolePermissions[this.selectedChannelId].permissions)}const t=Object.values(this.selectedRolePermissions);return 0<t.length?(this.selectedChannelId=t[0].channelId,n(t[0].permissions)):[]}create(){const{emailAddress:n,firstName:t,lastName:i,password:a,customFields:c,roles:m}=this.detailForm.value;if(!(n&&t&&i&&a))return;const C={emailAddress:n,firstName:t,lastName:i,password:a,customFields:c,roleIds:m?.map(_=>_.id).filter(Ot.notNullOrUndefined)??[]};this.dataService.administrator.createAdministrator(C).subscribe(_=>{this.notificationService.success((0,l.J)("common.notify-create-success"),{entity:"Administrator"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",_.createAdministrator.id],{relativeTo:this.route})},_=>{this.notificationService.error((0,l.J)("common.notify-create-error"),{entity:"Administrator"})})}save(){this.entity$.pipe((0,J.q)(1),(0,L.z)(({id:n})=>{const t=this.detailForm.value,i={id:n,emailAddress:t.emailAddress,firstName:t.firstName,lastName:t.lastName,password:t.password,customFields:t.customFields,roleIds:t.roles?.map(a=>a.id)};return this.dataService.administrator.updateAdministrator(i)})).subscribe(n=>{this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"Administrator"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},n=>{this.notificationService.error((0,l.J)("common.notify-update-error"),{entity:"Administrator"})})}setFormValues(n,t){this.detailForm.patchValue({emailAddress:n.emailAddress,firstName:n.firstName,lastName:n.lastName,roles:n.user.roles}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),n);const i=this.detailForm.get("password");i&&(n.id?i.setValidators([]):i.setValidators([r.kI.required])),this.buildPermissionsMap()}buildPermissionsMap(){const n=this.detailForm.get("roles");if(n){const t=n.value,i=new Map,a=new Map;for(const c of t??[])for(const m of c.channels){const _=i.get(m.id)||new Set;c.permissions.forEach($=>_.add($)),i.set(m.id,_),a.set(m.id,m.code)}this.selectedRolePermissions={};for(const c of Array.from(i.keys())){const m=i.get(c),C={};for(const _ of this.serverConfigService.getPermissionDefinitions())C[_.name]=m.has(_.name);this.selectedRolePermissions[c]={channelId:c,channelCode:a.get(c),permissions:C}}}}}te.\u0275fac=function(n){return new(n||te)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},te.\u0275cmp=e.Xpm({type:te,selectors:[["vdr-admin-detail"]],features:[e.qOj],decls:44,vars:53,consts:[["locationId","administrator-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],[4,"ngIf"],[1,"form-grid"],["for","emailAddress",1,"form-grid-span",3,"label"],["id","emailAddress","type","text","formControlName","emailAddress",3,"readonly"],["for","firstName",3,"label"],["id","firstName","type","text","formControlName","firstName",3,"readonly"],["for","lastName",3,"label"],["id","lastName","type","text","formControlName","lastName",3,"readonly"],["for","password",3,"label",4,"ngIf"],["for","password",3,"label","readOnlyToggle",4,"ngIf"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","administrator-detail",3,"entity$","detailForm"],[3,"title"],["formControlName","roles","bindLabel","description",3,"items","multiple","hideSelected","change"],["role","tablist",1,"nav","mt-2"],["role","presentation","class","nav-item",4,"ngFor","ngForOf"],[3,"activePermissions","permissionDefinitions","readonly"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],["for","password",3,"label"],["id","password","type","password","formControlName","password"],["for","password",3,"label","readOnlyToggle"],["formGroupName","customFields",3,"title"],["entityName","Administrator",3,"customFields","customFieldsFormGroup"],["role","presentation",1,"nav-item"],["type","button",1,"btn","btn-link","nav-link",3,"id","click"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,Gt,3,4,"button",1),e.ALo(6,"async"),e.YNc(7,jt,1,1,"ng-template",null,2,e.W1O),e.qZA()()(),e.TgZ(9,"form",3)(10,"vdr-page-detail-layout")(11,"vdr-page-detail-sidebar"),e.YNc(12,Ht,2,1,"vdr-card",4),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"vdr-page-block")(15,"vdr-card")(16,"div",5)(17,"vdr-form-field",6),e.ALo(18,"translate"),e._UZ(19,"input",7),e.ALo(20,"hasPermission"),e.qZA(),e.TgZ(21,"vdr-form-field",8),e.ALo(22,"translate"),e._UZ(23,"input",9),e.ALo(24,"hasPermission"),e.qZA(),e.TgZ(25,"vdr-form-field",10),e.ALo(26,"translate"),e._UZ(27,"input",11),e.ALo(28,"hasPermission"),e.qZA(),e.YNc(29,zt,3,3,"vdr-form-field",12),e.ALo(30,"async"),e.YNc(31,Vt,3,4,"vdr-form-field",13),e.ALo(32,"async"),e.ALo(33,"hasPermission"),e.qZA()(),e.YNc(34,Kt,3,5,"vdr-card",14),e._UZ(35,"vdr-custom-detail-component-host",15),e.qZA()(),e.TgZ(36,"vdr-page-block")(37,"vdr-card",16),e.ALo(38,"translate"),e.TgZ(39,"ng-select",17),e.NdJ("change",function(a){return t.rolesChanged(a)}),e.ALo(40,"async"),e.qZA(),e.TgZ(41,"ul",18),e.YNc(42,Xt,5,9,"li",19),e.qZA(),e._UZ(43,"vdr-permission-grid",20),e.qZA()()()),2&n){const i=e.MAs(8);e.xp6(5),e.Q6J("ngIf",e.lcZ(6,23,t.isNew$))("ngIfElse",i),e.xp6(4),e.Q6J("formGroup",t.detailForm),e.xp6(3),e.Q6J("ngIf",e.lcZ(13,25,t.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(18,27,"settings.email-address-or-identifier")),e.xp6(2),e.Q6J("readonly",!e.lcZ(20,29,e.DdM(49,ke))),e.xp6(2),e.Q6J("label",e.lcZ(22,31,"settings.first-name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(24,33,e.DdM(50,ke))),e.xp6(2),e.Q6J("label",e.lcZ(26,35,"settings.last-name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(28,37,e.DdM(51,ke))),e.xp6(2),e.Q6J("ngIf",e.lcZ(30,39,t.isNew$)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(32,41,t.isNew$)&&e.lcZ(33,43,e.DdM(52,ke))),e.xp6(3),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm),e.xp6(2),e.Q6J("title",e.lcZ(38,45,"settings.roles")),e.xp6(2),e.Q6J("items",e.lcZ(40,47,t.allRoles$))("multiple",!0)("hideSelected",!0),e.xp6(3),e.Q6J("ngForOf",t.getAvailableChannels()),e.xp6(1),e.Q6J("activePermissions",t.getPermissionsForSelectedChannel())("permissionDefinitions",t.permissionDefinitions)("readonly",!0)}},dependencies:[u.sg,u.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,r.x0,$t.w9,p.Kk,p.BN,p.mz,x.h,A.y,T.H,Z.W,S.y,q.C,v.z,M.D,Q.T,U.W,F.A,B,u.Ov,h.X$,O.j,De.E],styles:["ul.nav[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}"],changeDetection:0});const Ye=(0,s.wwB)({location:"administrator-list",requiresPermission:o=>o.includes(s.y3$.DeleteAdministrator),getItemName:o=>o.firstName+" "+o.lastName,bulkDelete:(o,n)=>o.administrator.deleteAdministrators(n).pipe((0,b.U)(t=>t.deleteAdministrators))});var R=d(9002);const en=function(){return["./","create"]};function tn(o,n){1&o&&(e.TgZ(0,"a",11),e._UZ(1,"clr-icon",12),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,en)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"admin.create-new-administrator")," "))}function nn(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function on(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function an(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const sn=function(o){return["./",o]};function rn(o,n){if(1&o&&(e.TgZ(0,"a",13)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",14),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(3,sn,t.id)),e.xp6(2),e.AsE("",t.firstName," ",t.lastName,"")}}function ln(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.emailAddress," ")}}function cn(o,n){if(1&o&&(e.TgZ(0,"vdr-chip"),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Oqu(t.description)}}function dn(o,n){if(1&o&&e.YNc(0,cn,2,1,"vdr-chip",15),2&o){const t=n.item;e.Q6J("ngForOf",t.user.roles)}}function mn(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",16),2&o){const t=n.$implicit,i=e.oxw();e.Q6J("customField",t)("sorts",i.sorts)}}const un=function(){return["CreateAdministrator"]},pn=f.Ps`
    query GetAdministratorList($options: AdministratorListOptions) {
        administrators(options: $options) {
            items {
                ...AdministratorListItem
            }
            totalItems
        }
    }
    fragment AdministratorListItem on Administrator {
        id
        createdAt
        updatedAt
        firstName
        lastName
        emailAddress
        user {
            id
            identifier
            lastLogin
            roles {
                id
                createdAt
                updatedAt
                code
                description
            }
        }
    }
`;class ne extends s.$ms{constructor(){super(),this.customFields=this.getCustomFieldConfig("Administrator"),this.filters=this.createFilterCollection().addDateFilters().addFilter({name:"firstName",type:{kind:"text"},label:(0,l.J)("settings.first-name"),filterField:"firstName"}).addFilter({name:"lastName",type:{kind:"text"},label:(0,l.J)("settings.last-name"),filterField:"lastName"}).addFilter({name:"emailAddress",type:{kind:"text"},label:(0,l.J)("settings.email-address"),filterField:"emailAddress"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"lastName"}).addSort({name:"emailAddress"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:s.tE5,getItems:n=>n.administrators,setVariables:(n,t)=>this.createSearchQuery(n,t,this.searchTermControl.value),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}createSearchQuery(n,t,i){let a={},c=s.FnJ.AND;return i&&(a={emailAddress:{contains:i},firstName:{contains:i},lastName:{contains:i}},c=s.FnJ.OR),{options:{skip:n,take:t,filter:{...a??{},...this.filters.createFilterInput()},sort:this.sorts.createSortInput(),filterOperator:c}}}}ne.\u0275fac=function(n){return new(n||ne)},ne.\u0275cmp=e.Xpm({type:ne,selectors:[["vdr-administrator-list"]],features:[e.qOj],decls:33,vars:48,consts:[["locationId","administrator-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],["id","administrator-list",1,"mt-2",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","administrator-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault"],[3,"heading","hiddenByDefault","sort"],[3,"heading","optional","sort"],[3,"heading","sort"],[3,"heading"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[4,"ngFor","ngForOf"],[3,"customField","sorts"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,tn,4,5,"a",1),e.qZA()()(),e.TgZ(6,"vdr-data-table-2",2),e.NdJ("pageChange",function(a){return t.setPageNumber(a)})("itemsPerPageChange",function(a){return t.setItemsPerPage(a)}),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"async"),e.ALo(10,"async"),e._UZ(11,"vdr-bulk-action-menu",3)(12,"vdr-dt2-search",4),e.ALo(13,"translate"),e.TgZ(14,"vdr-dt2-column",5),e.ALo(15,"translate"),e.YNc(16,nn,1,1,"ng-template"),e.qZA(),e.TgZ(17,"vdr-dt2-column",6),e.ALo(18,"translate"),e.YNc(19,on,2,4,"ng-template"),e.qZA(),e.TgZ(20,"vdr-dt2-column",6),e.ALo(21,"translate"),e.YNc(22,an,2,4,"ng-template"),e.qZA(),e.TgZ(23,"vdr-dt2-column",7),e.ALo(24,"translate"),e.YNc(25,rn,4,5,"ng-template"),e.qZA(),e.TgZ(26,"vdr-dt2-column",8),e.ALo(27,"translate"),e.YNc(28,ln,1,1,"ng-template"),e.qZA(),e.TgZ(29,"vdr-dt2-column",9),e.ALo(30,"translate"),e.YNc(31,dn,1,1,"ng-template"),e.qZA(),e.YNc(32,mn,1,2,"vdr-dt2-custom-field-column",10),e.qZA()),2&n&&(e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(47,un)),e.xp6(1),e.Q6J("items",e.lcZ(7,25,t.items$))("itemsPerPage",e.lcZ(8,27,t.itemsPerPage$))("totalItems",e.lcZ(9,29,t.totalItems$))("currentPage",e.lcZ(10,31,t.currentPage$))("filters",t.filters),e.xp6(5),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(13,33,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(15,35,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(18,37,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(21,39,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(24,41,"common.name"))("optional",!1)("sort",t.sorts.get("lastName")),e.xp6(3),e.Q6J("heading",e.lcZ(27,43,"settings.email-address"))("sort",t.sorts.get("emailAddress")),e.xp6(3),e.Q6J("heading",e.lcZ(30,45,"settings.roles")),e.xp6(3),e.Q6J("ngForOf",t.customFields))},dependencies:[g.qvL,u.sg,y.rH,p.Kk,p.BN,p.mz,E.Y,T.H,Z.W,I.c,P.e,D.U,k.J,R.j,v.z,u.Ov,h.X$,N.H],styles:[".search-input[_ngcontent-%COMP%]{min-width:300px}"]});var gn=d(2810),Y=d(1567),Ee=d(9973),hn=d(7312),Ge=d(5639),_n=d(2799),fn=d(7273);function Cn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",!t.saveButtonEnabled()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function vn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",!t.saveButtonEnabled()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}const bn=function(){return["SuperAdmin","UpdateChannel"]};function Zn(o,n){1&o&&e.YNc(0,vn,3,4,"button",33),2&o&&e.Q6J("vdrIfPermissions",e.DdM(1,bn))}function Tn(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",34),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function yn(o,n){if(1&o&&(e.TgZ(0,"vdr-form-field",35),e.ALo(1,"translate"),e._UZ(2,"input",36),e.ALo(3,"hasPermission"),e.qZA()),2&o){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,"common.code")),e.xp6(2),e.Q6J("readonly",!e.lcZ(3,4,t.updatePermission))}}function An(o,n){if(1&o&&(e.TgZ(0,"vdr-form-item",37),e.ALo(1,"translate"),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"channelCodeToLabel"),e.qZA()),2&o){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,"common.code")),e.xp6(2),e.hij(" ",e.lcZ(3,4,e.lcZ(4,6,null==t.entity?null:t.entity.code))," ")}}function Ln(o,n){if(1&o&&(e.TgZ(0,"option",38),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function xn(o,n){if(1&o&&(e.TgZ(0,"option",38),e._uU(1),e.ALo(2,"localeCurrencyName"),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",e.lcZ(2,2,t)," ")}}function Fn(o,n){if(1&o&&(e.TgZ(0,"option",38),e._uU(1),e.ALo(2,"localeLanguageName"),e.ALo(3,"uppercase"),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.AsE(" ",e.lcZ(2,3,t)," (",e.lcZ(3,5,t),") ")}}function Jn(o,n){1&o&&(e.TgZ(0,"clr-alert",39)(1,"clr-alert-item")(2,"span",40),e._uU(3),e.ALo(4,"translate"),e.qZA()()()),2&o&&(e.Q6J("clrAlertClosable",!1),e.xp6(3),e.hij(" ",e.lcZ(4,2,"error.no-default-tax-zone-set")," "))}function In(o,n){1&o&&(e.TgZ(0,"clr-alert",41)(1,"clr-alert-item")(2,"span",40),e._uU(3),e.ALo(4,"translate"),e.qZA()()()),2&o&&(e.Q6J("clrAlertClosable",!1),e.xp6(3),e.hij(" ",e.lcZ(4,2,"error.no-default-shipping-zone-set")," "))}function Pn(o,n){if(1&o&&(e.TgZ(0,"vdr-card",42),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",43),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))}}const Dn=f.Ps`
    query GetChannelDetail($id: ID!) {
        channel(id: $id) {
            ...Channel
        }
    }
    ${s.J71}
`;class oe extends s.VE7{constructor(n,t,i,a,c){super(),this.serverConfigService=n,this.changeDetector=t,this.dataService=i,this.formBuilder=a,this.notificationService=c,this.DEFAULT_CHANNEL_CODE=G.z$,this.customFields=this.getCustomFieldConfig("Channel"),this.detailForm=this.formBuilder.group({code:["",r.kI.required],token:["",r.kI.required],pricesIncludeTax:[!1],availableLanguageCodes:[[]],availableCurrencyCodes:[[]],defaultCurrencyCode:[""],defaultShippingZoneId:["",r.kI.required],defaultLanguageCode:[void 0],defaultTaxZoneId:["",r.kI.required],sellerId:["",r.kI.required],customFields:this.formBuilder.group(this.customFields.reduce((m,C)=>({...m,[C.name]:""}),{}))}),this.updatePermission=[s.y3$.SuperAdmin,s.y3$.UpdateChannel,s.y3$.CreateChannel]}ngOnInit(){this.init(),this.sellers$=this.dataService.settings.getSellerList().mapSingle(n=>n.sellers.items),this.availableLanguageCodes$=this.serverConfigService.getAvailableLanguages()}ngOnDestroy(){this.destroy()}saveButtonEnabled(){return this.detailForm.dirty&&this.detailForm.valid}create(){if(!this.detailForm.dirty)return;const{code:n,token:t,defaultLanguageCode:i,pricesIncludeTax:a,defaultCurrencyCode:c,defaultShippingZoneId:m,defaultTaxZoneId:C,customFields:_,sellerId:$}=this.detailForm.value;if(!(n&&t&&i&&c&&m&&C))return;const Ne={code:n,token:t,defaultLanguageCode:i,pricesIncludeTax:!!a,defaultCurrencyCode:c,defaultShippingZoneId:m,defaultTaxZoneId:C,customFields:_,sellerId:$};this.dataService.settings.createChannel(Ne).pipe((0,L.z)(({createChannel:V})=>this.dataService.auth.currentUser().single$.pipe((0,b.U)(({me:Qe})=>({me:Qe,createChannel:V})))),(0,L.z)(({me:V,createChannel:Qe})=>this.dataService.client.updateUserChannels(V.channels).pipe((0,b.U)(()=>Qe)))).subscribe(V=>{switch(V.__typename){case"Channel":this.notificationService.success((0,l.J)("common.notify-create-success"),{entity:"Channel"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",V.id],{relativeTo:this.route});break;case"LanguageNotAvailableError":this.notificationService.error(V.message)}})}save(){if(!this.detailForm.dirty)return;const n=this.detailForm.value;this.entity$.pipe((0,J.q)(1),(0,L.z)(t=>{const i={id:t.id,code:n.code,token:n.token,pricesIncludeTax:n.pricesIncludeTax,availableLanguageCodes:n.availableLanguageCodes,availableCurrencyCodes:n.availableCurrencyCodes,defaultCurrencyCode:n.defaultCurrencyCode,defaultShippingZoneId:n.defaultShippingZoneId,defaultLanguageCode:n.defaultLanguageCode,defaultTaxZoneId:n.defaultTaxZoneId,customFields:n.customFields,sellerId:n.sellerId};return this.dataService.settings.updateChannel(i)})).subscribe(({updateChannel:t})=>{switch(t.__typename){case"Channel":this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"Channel"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck();break;case"LanguageNotAvailableError":this.notificationService.error(t.message)}})}setFormValues(n,t){if(this.detailForm.patchValue({code:n.code,token:n.token||this.generateToken(),pricesIncludeTax:n.pricesIncludeTax,availableLanguageCodes:n.availableLanguageCodes,availableCurrencyCodes:n.availableCurrencyCodes,defaultCurrencyCode:n.defaultCurrencyCode,defaultShippingZoneId:n.defaultShippingZone?.id??"",defaultLanguageCode:n.defaultLanguageCode,defaultTaxZoneId:n.defaultTaxZone?.id??"",sellerId:n.seller?.id??""}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),n),n.code===G.z$){const i=this.detailForm.get("code");i&&i.disable()}}generateToken(){return Array.from(crypto.getRandomValues(new Uint8Array(10))).map(n=>n.toString(16).padStart(2,"0")).join("")}}oe.\u0275fac=function(n){return new(n||oe)(e.Y36(s.iHG),e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},oe.\u0275cmp=e.Xpm({type:oe,selectors:[["vdr-channel-detail"]],features:[e.qOj],decls:69,vars:74,consts:[["locationId","channel-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],[4,"ngIf"],[1,"form-grid"],["class","form-grid-span","for","code",3,"label",4,"ngIf"],["class","form-grid-span",3,"label",4,"ngIf"],["for","token",3,"label"],["id","token","type","text","formControlName","token",3,"readonly"],["for","sellerId",3,"label"],["name","sellerId","formControlName","sellerId",3,"vdrDisabled"],["selected","","value","",2,"display","none"],[3,"value",4,"ngFor","ngForOf"],["for","availableLanguageCodes",3,"label"],["formControlName","availableLanguageCodes",3,"languageCodes"],["for","availableCurrencyCodes",3,"label"],["formControlName","availableCurrencyCodes"],[3,"title"],["for","defaultTaxZoneId",3,"label"],["name","defaultCurrencyCode","formControlName","defaultCurrencyCode",3,"vdrDisabled"],["for","defaultLanguage",3,"label"],["name","defaultLanguageCode","formControlName","defaultLanguageCode",3,"vdrDisabled"],["formControlName","defaultTaxZoneId",3,"vdrDisabled"],["clrAlertType","danger",3,"clrAlertClosable",4,"ngIf"],["for","defaultShippingZoneId",3,"label"],["name","defaultShippingZoneId","formControlName","defaultShippingZoneId",3,"vdrDisabled"],["clrAlertType","warning",3,"clrAlertClosable",4,"ngIf"],["for","pricesIncludeTax",3,"label"],["type","checkbox","clrToggle","","id","pricesIncludeTax","formControlName","pricesIncludeTax",3,"vdrDisabled"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","channel-detail",3,"entity$","detailForm"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],["for","code",1,"form-grid-span",3,"label"],["id","code","type","text","formControlName","code",3,"readonly"],[1,"form-grid-span",3,"label"],[3,"value"],["clrAlertType","danger",3,"clrAlertClosable"],[1,"alert-text"],["clrAlertType","warning",3,"clrAlertClosable"],["formGroupName","customFields",3,"title"],["entityName","Channel",3,"customFields","customFieldsFormGroup"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,Cn,3,4,"button",1),e.ALo(6,"async"),e.YNc(7,Zn,1,2,"ng-template",null,2,e.W1O),e.qZA()()(),e.TgZ(9,"form",3)(10,"vdr-page-detail-layout")(11,"vdr-page-detail-sidebar"),e.YNc(12,Tn,2,1,"vdr-card",4),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"vdr-page-block")(15,"vdr-card")(16,"div",5),e.YNc(17,yn,4,6,"vdr-form-field",6),e.YNc(18,An,5,8,"vdr-form-item",7),e.TgZ(19,"vdr-form-field",8),e.ALo(20,"translate"),e._UZ(21,"input",9),e.ALo(22,"hasPermission"),e.qZA(),e.TgZ(23,"vdr-form-field",10),e.ALo(24,"translate"),e.TgZ(25,"select",11),e.ALo(26,"hasPermission"),e._UZ(27,"option",12),e.YNc(28,Ln,2,2,"option",13),e.ALo(29,"async"),e.qZA()(),e.TgZ(30,"vdr-form-field",14),e.ALo(31,"translate"),e._UZ(32,"vdr-language-code-selector",15),e.ALo(33,"async"),e.qZA(),e.TgZ(34,"vdr-form-field",16),e.ALo(35,"translate"),e._UZ(36,"vdr-currency-code-selector",17),e.qZA()()(),e.TgZ(37,"vdr-card",18),e.ALo(38,"translate"),e.TgZ(39,"div",5)(40,"vdr-form-field",19),e.ALo(41,"translate"),e.TgZ(42,"select",20),e.ALo(43,"hasPermission"),e.YNc(44,xn,3,4,"option",13),e.qZA()(),e.TgZ(45,"vdr-form-field",21),e.ALo(46,"translate"),e.TgZ(47,"select",22),e.ALo(48,"hasPermission"),e.YNc(49,Fn,4,7,"option",13),e.qZA()(),e.TgZ(50,"div")(51,"vdr-form-field",19),e.ALo(52,"translate"),e._UZ(53,"vdr-zone-selector",23),e.ALo(54,"hasPermission"),e.qZA(),e.YNc(55,Jn,5,4,"clr-alert",24),e.qZA(),e.TgZ(56,"div")(57,"vdr-form-field",25),e.ALo(58,"translate"),e._UZ(59,"vdr-zone-selector",26),e.ALo(60,"hasPermission"),e.qZA(),e.YNc(61,In,5,4,"clr-alert",27),e.qZA(),e.TgZ(62,"vdr-form-field",28),e.ALo(63,"translate"),e.TgZ(64,"clr-toggle-wrapper"),e._UZ(65,"input",29),e.ALo(66,"hasPermission"),e.qZA()()()(),e.YNc(67,Pn,3,5,"vdr-card",30),e._UZ(68,"vdr-custom-detail-component-host",31),e.qZA()()()),2&n){const i=e.MAs(8);e.xp6(5),e.Q6J("ngIf",e.lcZ(6,32,t.isNew$))("ngIfElse",i),e.xp6(4),e.Q6J("formGroup",t.detailForm),e.xp6(3),e.Q6J("ngIf",e.lcZ(13,34,t.entity$)),e.xp6(5),e.Q6J("ngIf",(null==t.entity?null:t.entity.code)!==t.DEFAULT_CHANNEL_CODE),e.xp6(1),e.Q6J("ngIf",(null==t.entity?null:t.entity.code)===t.DEFAULT_CHANNEL_CODE),e.xp6(1),e.Q6J("label",e.lcZ(20,36,"settings.channel-token")),e.xp6(2),e.Q6J("readonly",!e.lcZ(22,38,t.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(24,40,"common.seller")),e.xp6(2),e.Q6J("vdrDisabled",!e.lcZ(26,42,t.updatePermission)),e.xp6(3),e.Q6J("ngForOf",e.lcZ(29,44,t.sellers$)),e.xp6(2),e.Q6J("label",e.lcZ(31,46,"common.available-languages")),e.xp6(2),e.Q6J("languageCodes",e.lcZ(33,48,t.availableLanguageCodes$)),e.xp6(2),e.Q6J("label",e.lcZ(35,50,"common.available-currencies")),e.xp6(3),e.Q6J("title",e.lcZ(38,52,"settings.defaults")),e.xp6(3),e.Q6J("label",e.lcZ(41,54,"settings.default-currency")),e.xp6(2),e.Q6J("vdrDisabled",!e.lcZ(43,56,t.updatePermission)),e.xp6(2),e.Q6J("ngForOf",t.detailForm.value.availableCurrencyCodes),e.xp6(1),e.Q6J("label",e.lcZ(46,58,"common.default-language")),e.xp6(2),e.Q6J("vdrDisabled",!e.lcZ(48,60,t.updatePermission)),e.xp6(2),e.Q6J("ngForOf",t.detailForm.value.availableLanguageCodes),e.xp6(2),e.Q6J("label",e.lcZ(52,62,"settings.default-tax-zone")),e.xp6(2),e.Q6J("vdrDisabled",!e.lcZ(54,64,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",t.detailForm.value.code&&!t.detailForm.value.defaultTaxZoneId),e.xp6(2),e.Q6J("label",e.lcZ(58,66,"settings.default-shipping-zone")),e.xp6(2),e.Q6J("vdrDisabled",!e.lcZ(60,68,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",t.detailForm.value.code&&!t.detailForm.value.defaultShippingZoneId),e.xp6(1),e.Q6J("label",e.lcZ(63,70,"settings.prices-include-tax")),e.xp6(3),e.Q6J("vdrDisabled",!e.lcZ(66,72,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm)}},dependencies:[g.TIm,g.CyW,g.I9z,g.KKC,g.PEh,u.sg,u.O5,r._Y,r.YN,r.Kr,r.Fj,r.Wl,r.EJ,r.JJ,r.JL,r.sg,r.u,r.x0,p.Kk,p.BN,p.mz,x.h,A.y,gn.J,T.H,Z.W,Y.x,S.y,q.C,v.z,M.D,Q.T,U.W,F.A,Ee.A,hn.H,Ge.D,u.Ov,u.gd,h.X$,_n.u,O.j,De.E,fn.B],styles:["clr-alert[_ngcontent-%COMP%]{max-width:30rem;margin-bottom:12px}"],changeDetection:0});const Be=(0,s.wwB)({location:"channel-list",requiresPermission:o=>o.includes(s.y3$.SuperAdmin)||o.includes(s.y3$.DeleteChannel),getItemName:o=>o.code,bulkDelete:(o,n)=>o.settings.deleteChannels(n).pipe((0,b.U)(t=>t.deleteChannels))}),kn=function(){return["./","create"]};function Nn(o,n){1&o&&(e.TgZ(0,"a",10),e._UZ(1,"clr-icon",11),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,kn)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"settings.create-new-channel")," "))}function Sn(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function qn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function Mn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const Qn=function(o){return["./",o]};function Un(o,n){if(1&o&&(e.TgZ(0,"a",12)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"channelCodeToLabel"),e.qZA(),e._UZ(5,"clr-icon",13),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(6,Qn,t.id)),e.xp6(2),e.Oqu(e.lcZ(3,2,e.lcZ(4,4,t.code)))}}function On(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.token," ")}}function $n(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",14),2&o){const t=n.$implicit,i=e.oxw();e.Q6J("customField",t)("sorts",i.sorts)}}const Rn=function(){return["SuperAdmin","CreateChannel"]},wn=f.Ps`
    query GetChannelList($options: ChannelListOptions) {
        channels(options: $options) {
            items {
                ...Channel
            }
            totalItems
        }
    }
    ${s.J71}
`;class ie extends s.$ms{constructor(){super(),this.customFields=this.getCustomFieldConfig("Channel"),this.filters=this.createFilterCollection().addDateFilters().addFilter({name:"code",type:{kind:"text"},label:(0,l.J)("common.code"),filterField:"code"}).addFilter({name:"token",type:{kind:"text"},label:(0,l.J)("settings.channel-token"),filterField:"token"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"code"}).addSort({name:"token"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:s.zax,getItems:n=>n.channels,setVariables:(n,t)=>({options:{skip:n,take:t,filter:{code:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}isDefaultChannel(n){return n===G.z$}}ie.\u0275fac=function(n){return new(n||ie)},ie.\u0275cmp=e.Xpm({type:ie,selectors:[["vdr-channel-list"]],features:[e.qOj],decls:30,vars:45,consts:[["locationId","channel-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],["id","channel-list",1,"mt-2",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","channel-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault"],[3,"heading","hiddenByDefault","sort"],[3,"heading","optional","sort"],[3,"heading","sort"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"customField","sorts"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,Nn,4,5,"a",1),e.qZA()()(),e.TgZ(6,"vdr-data-table-2",2),e.NdJ("pageChange",function(a){return t.setPageNumber(a)})("itemsPerPageChange",function(a){return t.setItemsPerPage(a)}),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"async"),e.ALo(10,"async"),e._UZ(11,"vdr-bulk-action-menu",3)(12,"vdr-dt2-search",4),e.ALo(13,"translate"),e.TgZ(14,"vdr-dt2-column",5),e.ALo(15,"translate"),e.YNc(16,Sn,1,1,"ng-template"),e.qZA(),e.TgZ(17,"vdr-dt2-column",6),e.ALo(18,"translate"),e.YNc(19,qn,2,4,"ng-template"),e.qZA(),e.TgZ(20,"vdr-dt2-column",6),e.ALo(21,"translate"),e.YNc(22,Mn,2,4,"ng-template"),e.qZA(),e.TgZ(23,"vdr-dt2-column",7),e.ALo(24,"translate"),e.YNc(25,Un,6,8,"ng-template"),e.qZA(),e.TgZ(26,"vdr-dt2-column",8),e.ALo(27,"translate"),e.YNc(28,On,1,1,"ng-template"),e.qZA(),e.YNc(29,$n,1,2,"vdr-dt2-custom-field-column",9),e.qZA()),2&n&&(e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(44,Rn)),e.xp6(1),e.Q6J("items",e.lcZ(7,24,t.items$))("itemsPerPage",e.lcZ(8,26,t.itemsPerPage$))("totalItems",e.lcZ(9,28,t.totalItems$))("currentPage",e.lcZ(10,30,t.currentPage$))("filters",t.filters),e.xp6(5),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(13,32,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(15,34,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(18,36,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(21,38,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(24,40,"common.code"))("optional",!1)("sort",t.sorts.get("code")),e.xp6(3),e.Q6J("heading",e.lcZ(27,42,"settings.channel-token"))("sort",t.sorts.get("token")),e.xp6(3),e.Q6J("ngForOf",t.customFields))},dependencies:[g.qvL,u.sg,y.rH,p.Kk,p.BN,p.mz,T.H,Z.W,I.c,P.e,D.U,k.J,R.j,v.z,u.Ov,h.X$,De.E,N.H],changeDetection:0});var j=d(2039);function Yn(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function En(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function Gn(o,n){if(1&o&&e.YNc(0,En,3,4,"button",16),2&o){const t=e.oxw();e.Q6J("vdrIfPermissions",t.updatePermission)}}function Bn(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",17),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function jn(o,n){if(1&o&&(e.TgZ(0,"vdr-card",18),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",19),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))}}const Hn=f.Ps`
    query GetCountryDetail($id: ID!) {
        country(id: $id) {
            ...Country
        }
    }
    ${s.fn3}
`;class ae extends s.VE7{constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.customFields=this.getCustomFieldConfig("Region"),this.detailForm=this.formBuilder.group({code:["",r.kI.required],name:["",r.kI.required],enabled:[!0],customFields:this.formBuilder.group(this.customFields.reduce((c,m)=>({...c,[m.name]:""}),{}))}),this.updatePermission=[s.y3$.UpdateSettings,s.y3$.UpdateCountry]}ngOnInit(){this.init()}ngOnDestroy(){this.destroy()}create(){if(!this.detailForm.dirty)return;const n=this.detailForm.value,t=(0,s.iSy)({translatable:{id:"",createdAt:"",updatedAt:"",code:"",name:"",enabled:!1,translations:[]},updatedFields:n,languageCode:this.languageCode,customFieldConfig:this.customFields,defaultTranslation:{name:n.name??"",languageCode:this.languageCode}});this.dataService.settings.createCountry(t).subscribe(i=>{this.notificationService.success((0,l.J)("common.notify-create-success"),{entity:"Country"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",i.createCountry.id],{relativeTo:this.route})},i=>{this.notificationService.error((0,l.J)("common.notify-create-error"),{entity:"Country"})})}save(){(0,K.a)(this.entity$,this.languageCode$).pipe((0,J.q)(1),(0,L.z)(([n,t])=>{const i=this.detailForm.value,a=(0,s.iSy)({translatable:n,updatedFields:i,customFieldConfig:this.customFields,languageCode:t,defaultTranslation:{name:i.name??"",languageCode:t}});return this.dataService.settings.updateCountry(a)})).subscribe(n=>{this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"Country"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},n=>{this.notificationService.error((0,l.J)("common.notify-update-error"),{entity:"Country"})})}setFormValues(n,t){const i=(0,s.ZIM)(n,t);this.detailForm.patchValue({code:n.code,name:i?i.name:"",enabled:n.enabled}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),n,i)}}ae.\u0275fac=function(n){return new(n||ae)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},ae.\u0275cmp=e.Xpm({type:ae,selectors:[["vdr-country-detail"]],features:[e.qOj],decls:37,vars:38,consts:[[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","country-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","enabled",3,"label"],["type","checkbox","clrToggle","","id","enabled","formControlName","enabled",3,"vdrDisabled"],[4,"ngIf"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["for","code",3,"label"],["id","code","type","text","formControlName","code",3,"readonly"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","country-detail",3,"entity$","detailForm"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],["formGroupName","customFields",3,"title"],["entityName","Region",3,"customFields","customFieldsFormGroup"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(a){return t.setLanguage(a)}),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e.qZA()(),e.TgZ(7,"vdr-ab-right"),e._UZ(8,"vdr-action-bar-items",1),e.YNc(9,Yn,3,4,"button",2),e.ALo(10,"async"),e.YNc(11,Gn,1,1,"ng-template",null,3,e.W1O),e.qZA()()(),e.TgZ(13,"form",4)(14,"vdr-page-detail-layout")(15,"vdr-page-detail-sidebar")(16,"vdr-card")(17,"vdr-form-field",5),e.ALo(18,"translate"),e.TgZ(19,"clr-toggle-wrapper"),e._UZ(20,"input",6),e.ALo(21,"hasPermission"),e.qZA()()(),e.YNc(22,Bn,2,1,"vdr-card",7),e.ALo(23,"async"),e.qZA(),e.TgZ(24,"vdr-page-block")(25,"vdr-card")(26,"div",8)(27,"vdr-form-field",9),e.ALo(28,"translate"),e._UZ(29,"input",10),e.ALo(30,"hasPermission"),e.qZA(),e.TgZ(31,"vdr-form-field",11),e.ALo(32,"translate"),e._UZ(33,"input",12),e.ALo(34,"hasPermission"),e.qZA()()(),e.YNc(35,jn,3,5,"vdr-card",13),e._UZ(36,"vdr-custom-detail-component-host",14),e.qZA()()()),2&n){const i=e.MAs(12);e.xp6(3),e.Q6J("disabled",e.lcZ(4,16,t.isNew$))("availableLanguageCodes",e.lcZ(5,18,t.availableLanguages$))("currentLanguageCode",e.lcZ(6,20,t.languageCode$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(10,22,t.isNew$))("ngIfElse",i),e.xp6(4),e.Q6J("formGroup",t.detailForm),e.xp6(4),e.Q6J("label",e.lcZ(18,24,"common.enabled")),e.xp6(3),e.Q6J("vdrDisabled",!e.lcZ(21,26,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",e.lcZ(23,28,t.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(28,30,"common.name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(30,32,t.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(32,34,"common.code")),e.xp6(2),e.Q6J("readonly",!e.lcZ(34,36,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm)}},dependencies:[g.KKC,g.PEh,u.O5,r._Y,r.Fj,r.Wl,r.JJ,r.JL,r.sg,r.u,r.x0,p.Kk,p.BN,p.mz,x.h,A.y,j.S,T.H,Z.W,Y.x,S.y,q.C,v.z,M.D,Q.T,U.W,F.A,u.Ov,h.X$,O.j],changeDetection:0});const je=(0,s.wwB)({location:"country-list",requiresPermission:o=>o.includes(s.y3$.DeleteSettings)||o.includes(s.y3$.DeleteCountry),getItemName:o=>o.name,bulkDelete:(o,n)=>o.settings.deleteCountries(n).pipe((0,b.U)(t=>t.deleteCountries))}),zn=function(){return["./","create"]};function Vn(o,n){1&o&&(e.TgZ(0,"a",12),e._UZ(1,"clr-icon",13),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,zn)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"settings.create-new-country")," "))}function Kn(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function Xn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function Wn(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const eo=function(o){return["./",o]};function to(o,n){if(1&o&&(e.TgZ(0,"a",14)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",15),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,eo,t.id)),e.xp6(2),e.Oqu(t.name)}}function no(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.code," ")}}function oo(o,n){1&o&&(e.TgZ(0,"vdr-chip",18),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.enabled")))}function io(o,n){1&o&&(e.TgZ(0,"vdr-chip",19),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.disabled")))}function ao(o,n){if(1&o&&(e.YNc(0,oo,3,3,"vdr-chip",16),e.YNc(1,io,3,3,"vdr-chip",17)),2&o){const t=n.item;e.Q6J("ngIf",t.enabled),e.xp6(1),e.Q6J("ngIf",!t.enabled)}}function so(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",20),2&o){const t=n.$implicit,i=e.oxw();e.Q6J("customField",t)("sorts",i.sorts)}}const ro=function(){return["CreateSettings","CreateCountry"]},lo=f.Ps`
    query GetCountryList($options: CountryListOptions) {
        countries(options: $options) {
            items {
                ...CountryListItem
            }
            totalItems
        }
    }
    fragment CountryListItem on Country {
        id
        createdAt
        updatedAt
        code
        name
        type
        enabled
    }
`;class se extends s.$ms{constructor(){super(),this.customFields=this.getCustomFieldConfig("Region"),this.filters=this.createFilterCollection().addDateFilters().addFilter({name:"name",type:{kind:"text"},label:(0,l.J)("common.name"),filterField:"name"}).addFilter({name:"cpde",type:{kind:"text"},label:(0,l.J)("common.code"),filterField:"code"}).addFilter({name:"enabled",type:{kind:"boolean"},label:(0,l.J)("common.enabled"),filterField:"enabled"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("name","ASC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"name"}).addSort({name:"code"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:s.p6B,getItems:n=>n.countries,setVariables:(n,t)=>({options:{skip:n,take:t,filter:{name:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}}se.\u0275fac=function(n){return new(n||se)},se.\u0275cmp=e.Xpm({type:se,selectors:[["vdr-country-list"]],features:[e.qOj],decls:36,vars:54,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","country-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],["id","country-list",1,"mt-2",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","country-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault"],[3,"heading","hiddenByDefault","sort"],[3,"heading","optional","sort"],[3,"heading","sort"],[3,"heading"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],["colorType","success",4,"ngIf"],["colorType","warning",4,"ngIf"],["colorType","success"],["colorType","warning"],[3,"customField","sorts"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(a){return t.setLanguage(a)}),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()(),e.TgZ(6,"vdr-ab-right"),e._UZ(7,"vdr-action-bar-items",1),e.YNc(8,Vn,4,5,"a",2),e.qZA()()(),e.TgZ(9,"vdr-data-table-2",3),e.NdJ("pageChange",function(a){return t.setPageNumber(a)})("itemsPerPageChange",function(a){return t.setItemsPerPage(a)}),e.ALo(10,"async"),e.ALo(11,"async"),e.ALo(12,"async"),e.ALo(13,"async"),e._UZ(14,"vdr-bulk-action-menu",4)(15,"vdr-dt2-search",5),e.ALo(16,"translate"),e.TgZ(17,"vdr-dt2-column",6),e.ALo(18,"translate"),e.YNc(19,Kn,1,1,"ng-template"),e.qZA(),e.TgZ(20,"vdr-dt2-column",7),e.ALo(21,"translate"),e.YNc(22,Xn,2,4,"ng-template"),e.qZA(),e.TgZ(23,"vdr-dt2-column",7),e.ALo(24,"translate"),e.YNc(25,Wn,2,4,"ng-template"),e.qZA(),e.TgZ(26,"vdr-dt2-column",8),e.ALo(27,"translate"),e.YNc(28,to,4,4,"ng-template"),e.qZA(),e.TgZ(29,"vdr-dt2-column",9),e.ALo(30,"translate"),e.YNc(31,no,1,1,"ng-template"),e.qZA(),e.TgZ(32,"vdr-dt2-column",10),e.ALo(33,"translate"),e.YNc(34,ao,2,2,"ng-template"),e.qZA(),e.YNc(35,so,1,2,"vdr-dt2-custom-field-column",11),e.qZA()),2&n&&(e.xp6(3),e.Q6J("availableLanguageCodes",e.lcZ(4,27,t.availableLanguages$))("currentLanguageCode",e.lcZ(5,29,t.contentLanguage$)),e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(53,ro)),e.xp6(1),e.Q6J("items",e.lcZ(10,31,t.items$))("itemsPerPage",e.lcZ(11,33,t.itemsPerPage$))("totalItems",e.lcZ(12,35,t.totalItems$))("currentPage",e.lcZ(13,37,t.currentPage$))("filters",t.filters),e.xp6(5),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(16,39,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(18,41,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(21,43,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(24,45,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(27,47,"common.name"))("optional",!1)("sort",t.sorts.get("name")),e.xp6(3),e.Q6J("heading",e.lcZ(30,49,"common.code"))("sort",t.sorts.get("code")),e.xp6(3),e.Q6J("heading",e.lcZ(33,51,"common.enabled")),e.xp6(3),e.Q6J("ngForOf",t.customFields))},dependencies:[g.qvL,u.sg,u.O5,y.rH,p.Kk,p.BN,p.mz,E.Y,j.S,T.H,Z.W,I.c,P.e,D.U,k.J,R.j,v.z,u.Ov,h.X$,N.H],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"],changeDetection:0});var He=d(5244);function co(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function mo(o,n){if(1&o&&(e.TgZ(0,"vdr-card",13),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",14),e.ALo(3,"hasPermission"),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,4,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))("readonly",!e.lcZ(3,6,t.updatePermission))}}const uo=f.Ps`
    query GetGlobalSettingsDetail {
        globalSettings {
            ...GlobalSettingsDetail
        }
    }
    fragment GlobalSettingsDetail on GlobalSettings {
        id
        createdAt
        updatedAt
        availableLanguages
        trackInventory
        outOfStockThreshold
    }
`;class re extends s.VE7{constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.customFields=this.getCustomFieldConfig("GlobalSettings"),this.detailForm=this.formBuilder.group({availableLanguages:[[]],trackInventory:!1,outOfStockThreshold:[0,r.kI.required],customFields:this.formBuilder.group(this.customFields.reduce((c,m)=>({...c,[m.name]:""}),{}))}),this.languageCodes=Object.values(s.spR),this.updatePermission=[s.y3$.UpdateSettings,s.y3$.UpdateGlobalSettings]}ngOnInit(){this.init(),this.dataService.client.userStatus().single$.subscribe(({userStatus:n})=>{if(!n.permissions.includes(s.y3$.UpdateSettings)){const t=this.detailForm.get("availableLanguages");t&&t.disable()}})}ngOnDestroy(){this.destroy()}save(){this.detailForm.dirty&&this.dataService.settings.updateGlobalSettings(this.detailForm.value).pipe((0,He.b)(({updateGlobalSettings:n})=>{switch(n.__typename){case"GlobalSettings":this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"Settings"});break;case"ChannelDefaultLanguageError":this.notificationService.error(n.message)}}),(0,Ie.w)(()=>this.serverConfigService.refreshGlobalSettings()),$e(this.dataService.client.uiState().single$)).subscribe(([{globalSettings:n},{uiState:t}])=>{const i=n.availableLanguages;i.length&&!i.includes(t.contentLanguage)&&this.dataService.client.setContentLanguage(i[0]).subscribe()})}setFormValues(n,t){this.detailForm.patchValue({availableLanguages:n.availableLanguages,trackInventory:n.trackInventory,outOfStockThreshold:n.outOfStockThreshold}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get("customFields"),n)}}re.\u0275fac=function(n){return new(n||re)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},re.\u0275cmp=e.Xpm({type:re,selectors:[["vdr-global-settings"]],features:[e.qOj],decls:26,vars:30,consts:[["locationId","global-settings-detail"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],[1,"form-grid"],["for","availableLanguages",3,"label","tooltip"],["formControlName","availableLanguages",3,"languageCodes"],["for","outOfStockThreshold",3,"label","tooltip"],["id","outOfStockThreshold","type","number","formControlName","outOfStockThreshold",3,"readonly"],["for","enabled",3,"label","tooltip"],["type","checkbox","clrToggle","","name","enabled","formControlName","trackInventory",3,"vdrDisabled"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","global-settings-detail",3,"entity$","detailForm"],[1,"btn","btn-primary",3,"disabled","click"],["formGroupName","customFields",3,"title"],["entityName","GlobalSettings",3,"customFields","customFieldsFormGroup","readonly"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-right"),e._UZ(3,"vdr-action-bar-items",0),e.YNc(4,co,3,4,"button",1),e.qZA()()(),e.TgZ(5,"form",2)(6,"vdr-page-block")(7,"vdr-card")(8,"div",3)(9,"vdr-form-field",4),e.ALo(10,"translate"),e.ALo(11,"translate"),e._UZ(12,"vdr-language-code-selector",5),e.qZA(),e.TgZ(13,"vdr-form-field",6),e.ALo(14,"translate"),e.ALo(15,"translate"),e._UZ(16,"input",7),e.ALo(17,"hasPermission"),e.qZA(),e.TgZ(18,"vdr-form-field",8),e.ALo(19,"translate"),e.ALo(20,"translate"),e.TgZ(21,"clr-toggle-wrapper"),e._UZ(22,"input",9),e.ALo(23,"hasPermission"),e.qZA()()()(),e.YNc(24,mo,4,8,"vdr-card",10),e._UZ(25,"vdr-custom-detail-component-host",11),e.qZA()()),2&n&&(e.xp6(4),e.Q6J("vdrIfPermissions",t.updatePermission),e.xp6(1),e.Q6J("formGroup",t.detailForm),e.xp6(4),e.Q6J("label",e.lcZ(10,14,"common.available-languages"))("tooltip",e.lcZ(11,16,"settings.global-available-languages-tooltip")),e.xp6(3),e.Q6J("languageCodes",t.languageCodes),e.xp6(1),e.Q6J("label",e.lcZ(14,18,"settings.global-out-of-stock-threshold"))("tooltip",e.lcZ(15,20,"settings.global-out-of-stock-threshold-tooltip")),e.xp6(3),e.Q6J("readonly",!e.lcZ(17,22,t.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(19,24,"settings.track-inventory-default"))("tooltip",e.lcZ(20,26,"catalog.track-inventory-tooltip")),e.xp6(4),e.Q6J("vdrDisabled",!e.lcZ(23,28,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm))},dependencies:[g.KKC,g.PEh,u.O5,r._Y,r.Fj,r.wV,r.Wl,r.JJ,r.JL,r.sg,r.u,r.x0,p.Kk,p.mz,x.h,A.y,T.H,Z.W,Y.x,S.y,q.C,v.z,F.A,Ge.D,h.X$,O.j],styles:["ng-select .ng-value>span{margin:0!important}  ng-select .ng-arrow-wrapper .ng-arrow{margin:0!important}  ng-select .ng-select-container>span{margin:0!important}"],changeDetection:0});var qe=d(4707),ze=d(7747),Ve=d(3677),Ke=d(9014),Xe=d(433),We=d(8308),et=d(9182);function po(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.pristine||t.detailForm.invalid||!t.selectedHandler),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function go(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.detailForm.pristine||t.detailForm.invalid||!t.selectedHandler),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function ho(o,n){if(1&o&&e.YNc(0,go,3,4,"button",20),2&o){const t=e.oxw();e.Q6J("vdrIfPermissions",t.updatePermission)}}function _o(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",21),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function fo(o,n){if(1&o&&(e.TgZ(0,"vdr-card",22),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",23),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))}}function Co(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-configurable-input",24),e.NdJ("remove",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.removeChecker())}),e.ALo(1,"hasPermission"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("operation",t.selectedChecker)("operationDefinition",t.selectedCheckerDefinition)("readonly",!e.lcZ(1,3,t.updatePermission))}}function vo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){const c=e.CHM(t).$implicit,m=e.oxw(2);return e.KtG(m.selectChecker(c))}),e._uU(1),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function bo(o,n){if(1&o&&(e.TgZ(0,"div")(1,"vdr-dropdown")(2,"button",25),e._UZ(3,"clr-icon",26),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"vdr-dropdown-menu",27),e.YNc(7,vo,2,1,"button",28),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,2,"common.select")," "),e.xp6(3),e.Q6J("ngForOf",t.checkers)}}function Zo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-configurable-input",30),e.NdJ("remove",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.removeHandler())}),e.ALo(1,"hasPermission"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("operation",t.selectedHandler)("operationDefinition",t.selectedHandlerDefinition)("readonly",!e.lcZ(1,3,t.updatePermission))}}function To(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){const c=e.CHM(t).$implicit,m=e.oxw(2);return e.KtG(m.selectHandler(c))}),e._uU(1),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function yo(o,n){if(1&o&&(e.TgZ(0,"div")(1,"vdr-dropdown")(2,"button",25),e._UZ(3,"clr-icon",26),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"vdr-dropdown-menu",27),e.YNc(7,To,2,1,"button",28),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,2,"common.select")," "),e.xp6(3),e.Q6J("ngForOf",t.handlers)}}const Ao=f.Ps`
    query GetPaymentMethodDetail($id: ID!) {
        paymentMethod(id: $id) {
            ...PaymentMethod
        }
    }
    ${s.tRw}
`;class le extends s.VE7{constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.customFields=this.getCustomFieldConfig("PaymentMethod"),this.detailForm=this.formBuilder.group({code:["",r.kI.required],name:["",r.kI.required],description:"",enabled:[!0,r.kI.required],checker:{},handler:{},customFields:this.formBuilder.group(this.customFields.reduce((c,m)=>({...c,[m.name]:""}),{}))}),this.checkers=[],this.handlers=[],this.updatePermission=[s.y3$.UpdateSettings,s.y3$.UpdatePaymentMethod]}ngOnInit(){this.init(),this.dataService.settings.getPaymentMethodOperations().single$.subscribe(n=>{this.checkers=n.paymentMethodEligibilityCheckers,this.handlers=n.paymentMethodHandlers,this.changeDetector.markForCheck(),this.selectedCheckerDefinition=n.paymentMethodEligibilityCheckers.find(t=>t.code===this.entity?.checker?.code),this.selectedHandlerDefinition=n.paymentMethodHandlers.find(t=>t.code===this.entity?.handler?.code)})}ngOnDestroy(){this.destroy()}updateCode(n,t){if(!n){const i=this.detailForm.get("code");i&&i.pristine&&i.setValue((0,qe.U)(t,"-"))}}selectChecker(n){this.selectedCheckerDefinition=n,this.selectedChecker=(0,s.miO)(n);const t=this.detailForm.get("checker");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedChecker)),this.detailForm.markAsDirty()}selectHandler(n){this.selectedHandlerDefinition=n,this.selectedHandler=(0,s.miO)(n);const t=this.detailForm.get("handler");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedHandler)),this.detailForm.markAsDirty()}removeChecker(){this.selectedChecker=null,this.detailForm.markAsDirty()}removeHandler(){this.selectedHandler=null,this.detailForm.markAsDirty()}create(){const n=this.selectedChecker,t=this.selectedHandler;if(!t)return;const i=this.getUpdatedPaymentMethod({id:"",createdAt:"",updatedAt:"",name:"",code:"",description:"",enabled:!0,checker:void 0,handler:void 0,translations:[]},this.detailForm,this.languageCode,t,n);this.dataService.settings.createPaymentMethod(i).subscribe(a=>{this.notificationService.success((0,l.J)("common.notify-create-success"),{entity:"PaymentMethod"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",a.createPaymentMethod.id],{relativeTo:this.route})},a=>{this.notificationService.error((0,l.J)("common.notify-create-error"),{entity:"PaymentMethod"})})}save(){const n=this.selectedChecker,t=this.selectedHandler;t&&(0,K.a)(this.entity$,this.languageCode$).pipe((0,J.q)(1),(0,L.z)(([i,a])=>{const c=this.getUpdatedPaymentMethod(i,this.detailForm,a,t,n);return this.dataService.settings.updatePaymentMethod(c)})).subscribe(i=>{this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"PaymentMethod"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},i=>{this.notificationService.error((0,l.J)("common.notify-update-error"),{entity:"PaymentMethod"})})}getUpdatedPaymentMethod(n,t,i,a,c){return{...(0,s.iSy)({translatable:n,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:i,defaultTranslation:{languageCode:i,name:n.name||"",description:n.description||""}}),checker:c?(0,s.RnJ)(c,t.value.checker):null,handler:(0,s.RnJ)(a,t.value.handler)}}setFormValues(n,t){const i=(0,s.ZIM)(n,t);this.detailForm.patchValue({name:i?.name,code:n.code,description:i?.description,enabled:n.enabled,checker:n.checker||{},handler:n.handler||{}}),this.selectedChecker||(this.selectedChecker=n.checker&&{code:n.checker.code,args:n.checker.args.map(a=>({...a,value:(0,s.sux)(a.value)}))}),this.selectedHandler||(this.selectedHandler=n.handler&&{code:n.handler.code,args:n.handler.args.map(a=>({...a,value:(0,s.sux)(a.value)}))}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get("customFields"),n)}}le.\u0275fac=function(n){return new(n||le)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},le.\u0275cmp=e.Xpm({type:le,selectors:[["vdr-payment-method-detail"]],features:[e.qOj],decls:49,vars:57,consts:[[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","payment-method-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","description",3,"label"],["type","checkbox","clrToggle","","id","enabled","formControlName","enabled",3,"vdrDisabled"],[4,"ngIf"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","code",3,"label","readOnlyToggle"],["id","code","type","text","formControlName","code",3,"readonly"],["formControlName","description",1,"form-grid-span",3,"readonly","label"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","payment-method-detail",3,"entity$","detailForm"],[3,"title"],["formControlName","checker",3,"operation","operationDefinition","readonly","remove",4,"ngIf"],["formControlName","handler",3,"operation","operationDefinition","readonly","remove",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],["formGroupName","customFields",3,"title"],["entityName","PaymentMethod",3,"customFields","customFieldsFormGroup"],["formControlName","checker",3,"operation","operationDefinition","readonly","remove"],["vdrDropdownTrigger","",1,"btn","btn-outline"],["shape","plus"],["vdrPosition","bottom-left"],["type","button","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["type","button","vdrDropdownItem","",3,"click"],["formControlName","handler",3,"operation","operationDefinition","readonly","remove"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(a){return t.setLanguage(a)}),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e.qZA()(),e.TgZ(7,"vdr-ab-right"),e._UZ(8,"vdr-action-bar-items",1),e.YNc(9,po,3,4,"button",2),e.ALo(10,"async"),e.YNc(11,ho,1,1,"ng-template",null,3,e.W1O),e.qZA()()(),e.TgZ(13,"form",4)(14,"vdr-page-detail-layout")(15,"vdr-page-detail-sidebar")(16,"vdr-card")(17,"vdr-form-field",5),e.ALo(18,"translate"),e.TgZ(19,"clr-toggle-wrapper"),e._UZ(20,"input",6),e.ALo(21,"hasPermission"),e.qZA()()(),e.YNc(22,_o,2,1,"vdr-card",7),e.ALo(23,"async"),e.qZA(),e.TgZ(24,"vdr-page-block")(25,"vdr-card")(26,"div",8)(27,"vdr-form-field",9),e.ALo(28,"translate"),e.TgZ(29,"input",10),e.NdJ("input",function(a){return t.updateCode(null==t.entity?null:t.entity.code,a.target.value)}),e.ALo(30,"hasPermission"),e.qZA()(),e.TgZ(31,"vdr-form-field",11),e.ALo(32,"translate"),e.ALo(33,"hasPermission"),e._UZ(34,"input",12),e.ALo(35,"hasPermission"),e.qZA(),e._UZ(36,"vdr-rich-text-editor",13),e.ALo(37,"hasPermission"),e.ALo(38,"translate"),e.qZA()(),e.YNc(39,fo,3,5,"vdr-card",14),e._UZ(40,"vdr-custom-detail-component-host",15),e.TgZ(41,"vdr-card",16),e.ALo(42,"translate"),e.YNc(43,Co,2,5,"vdr-configurable-input",17),e.YNc(44,bo,8,4,"div",7),e.qZA(),e.TgZ(45,"vdr-card",16),e.ALo(46,"translate"),e.YNc(47,Zo,2,5,"vdr-configurable-input",18),e.YNc(48,yo,8,4,"div",7),e.qZA()()()()),2&n){const i=e.MAs(12);e.xp6(3),e.Q6J("disabled",e.lcZ(4,25,t.isNew$))("availableLanguageCodes",e.lcZ(5,27,t.availableLanguages$))("currentLanguageCode",e.lcZ(6,29,t.languageCode$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(10,31,t.isNew$))("ngIfElse",i),e.xp6(4),e.Q6J("formGroup",t.detailForm),e.xp6(4),e.Q6J("label",e.lcZ(18,33,"common.enabled")),e.xp6(3),e.Q6J("vdrDisabled",!e.lcZ(21,35,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",e.lcZ(23,37,t.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(28,39,"common.name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(30,41,t.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(32,43,"common.code"))("readOnlyToggle",e.lcZ(33,45,t.updatePermission)),e.xp6(3),e.Q6J("readonly",!e.lcZ(35,47,t.updatePermission)),e.xp6(2),e.Q6J("readonly",!e.lcZ(37,49,t.updatePermission))("label",e.lcZ(38,51,"common.description")),e.xp6(3),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm),e.xp6(1),e.Q6J("title",e.lcZ(42,53,"settings.payment-eligibility-checker")),e.xp6(2),e.Q6J("ngIf",t.selectedChecker&&t.selectedCheckerDefinition),e.xp6(1),e.Q6J("ngIf",!t.selectedChecker||!t.selectedCheckerDefinition),e.xp6(1),e.Q6J("title",e.lcZ(46,55,"settings.payment-handler")),e.xp6(2),e.Q6J("ngIf",t.selectedHandler&&t.selectedHandlerDefinition),e.xp6(1),e.Q6J("ngIf",!t.selectedHandler||!t.selectedHandlerDefinition)}},dependencies:[g.qvL,g.KKC,g.PEh,u.sg,u.O5,r._Y,r.Fj,r.Wl,r.JJ,r.JL,r.sg,r.u,r.x0,p.Kk,p.BN,p.mz,ze.q,x.h,A.y,j.S,Ve.Y,Ke.J,Xe.N,We.U,et.H,T.H,Z.W,Y.x,S.y,q.C,v.z,M.D,Q.T,U.W,F.A,u.Ov,h.X$,O.j],changeDetection:0});const tt=(0,s.wwB)({location:"payment-method-list",requiresPermission:o=>o.includes(s.y3$.DeletePaymentMethod)||o.includes(s.y3$.DeleteSettings),getItemName:o=>o.name,shouldRetryItem:(o,n)=>!!o.message,bulkDelete:(o,n,t)=>o.settings.deletePaymentMethods(n,t).pipe((0,b.U)(i=>i.deletePaymentMethods))}),nt=(f.Ps`
    mutation AssignPaymentMethodsToChannel($input: AssignPaymentMethodsToChannelInput!) {
        assignPaymentMethodsToChannel(input: $input) {
            id
            name
        }
    }
`,f.Ps`
    mutation RemovePaymentMethodsFromChannel($input: RemovePaymentMethodsFromChannelInput!) {
        removePaymentMethodsFromChannel(input: $input) {
            id
            name
        }
    }
`,(0,s.z1G)({location:"payment-method-list",requiresPermission:o=>o.includes(s.y3$.UpdatePaymentMethod)||o.includes(s.y3$.UpdateSettings),getItemName:o=>o.name,bulkAssignToChannel:(o,n,t)=>o.mutate(s.m4U,{input:{channelId:t,paymentMethodIds:n}}).pipe((0,b.U)(i=>i.assignPaymentMethodsToChannel))})),ot=(0,s.RBx)({location:"payment-method-list",requiresPermission:o=>o.includes(s.y3$.DeletePaymentMethod)||o.includes(s.y3$.DeleteSettings),getItemName:o=>o.name,bulkRemoveFromChannel:(o,n,t)=>o.mutate(s.zBk,{input:{channelId:t,paymentMethodIds:n}}).pipe((0,b.U)(i=>i.removePaymentMethodsFromChannel))}),Lo=function(){return["./","create"]};function xo(o,n){1&o&&(e.TgZ(0,"a",11),e._UZ(1,"clr-icon",12),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,Lo)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"settings.create-new-payment-method")," "))}function Fo(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function Jo(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function Io(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const Po=function(o){return["./",o]};function Do(o,n){if(1&o&&(e.TgZ(0,"a",13)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",14),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,Po,t.id)),e.xp6(2),e.Oqu(t.name)}}function ko(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.code," ")}}function No(o,n){1&o&&(e.TgZ(0,"vdr-chip",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.enabled")))}function So(o,n){1&o&&(e.TgZ(0,"vdr-chip",18),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.disabled")))}function qo(o,n){if(1&o&&(e.YNc(0,No,3,3,"vdr-chip",15),e.YNc(1,So,3,3,"vdr-chip",16)),2&o){const t=n.item;e.Q6J("ngIf",t.enabled),e.xp6(1),e.Q6J("ngIf",!t.enabled)}}function Mo(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",19),2&o){const t=n.$implicit,i=e.oxw();e.Q6J("customField",t)("sorts",i.sorts)}}const Qo=function(){return["CreateSettings","CreatePaymentMethod"]},Uo=f.Ps`
    query GetPaymentMethodList($options: PaymentMethodListOptions!) {
        paymentMethods(options: $options) {
            items {
                ...PaymentMethodListItem
            }
            totalItems
        }
    }
    fragment PaymentMethodListItem on PaymentMethod {
        id
        createdAt
        updatedAt
        name
        description
        code
        enabled
    }
`;class ce extends s.$ms{constructor(){super(),this.customFields=this.getCustomFieldConfig("PaymentMethod"),this.filters=this.createFilterCollection().addDateFilters().addFilter({name:"name",type:{kind:"text"},label:(0,l.J)("common.name"),filterField:"name"}).addFilter({name:"code",type:{kind:"text"},label:(0,l.J)("common.code"),filterField:"code"}).addFilter({name:"enabled",type:{kind:"boolean"},label:(0,l.J)("common.enabled"),filterField:"enabled"}).addFilter({name:"description",type:{kind:"text"},label:(0,l.J)("common.description"),filterField:"description"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"id"}).addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"name"}).addSort({name:"code"}).addSort({name:"description"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:s.hVB,getItems:n=>n.paymentMethods,setVariables:(n,t)=>({options:{skip:n,take:t,filter:{name:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}}function Oo(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",16),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function $o(o,n){1&o&&(e.TgZ(0,"vdr-form-field",17),e.ALo(1,"translate"),e._UZ(2,"input",13),e.qZA()),2&o&&e.Q6J("label",e.lcZ(1,1,"settings.password"))}function Ro(o,n){if(1&o&&(e.TgZ(0,"vdr-card",18),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",19),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))}}ce.\u0275fac=function(n){return new(n||ce)},ce.\u0275cmp=e.Xpm({type:ce,selectors:[["vdr-payment-method-list"]],features:[e.qOj],decls:36,vars:55,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","payment-method-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],["id","payment-method-list",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","payment-method-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault","sort"],[3,"heading","optional","sort"],[3,"heading","sort"],[3,"heading"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],["colorType","success",4,"ngIf"],["colorType","warning",4,"ngIf"],["colorType","success"],["colorType","warning"],[3,"customField","sorts"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(a){return t.setLanguage(a)}),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()(),e.TgZ(6,"vdr-ab-right"),e._UZ(7,"vdr-action-bar-items",1),e.YNc(8,xo,4,5,"a",2),e.qZA()()(),e.TgZ(9,"vdr-data-table-2",3),e.NdJ("pageChange",function(a){return t.setPageNumber(a)})("itemsPerPageChange",function(a){return t.setItemsPerPage(a)}),e.ALo(10,"async"),e.ALo(11,"async"),e.ALo(12,"async"),e.ALo(13,"async"),e._UZ(14,"vdr-bulk-action-menu",4)(15,"vdr-dt2-search",5),e.ALo(16,"translate"),e.TgZ(17,"vdr-dt2-column",6),e.ALo(18,"translate"),e.YNc(19,Fo,1,1,"ng-template"),e.qZA(),e.TgZ(20,"vdr-dt2-column",6),e.ALo(21,"translate"),e.YNc(22,Jo,2,4,"ng-template"),e.qZA(),e.TgZ(23,"vdr-dt2-column",6),e.ALo(24,"translate"),e.YNc(25,Io,2,4,"ng-template"),e.qZA(),e.TgZ(26,"vdr-dt2-column",7),e.ALo(27,"translate"),e.YNc(28,Do,4,4,"ng-template"),e.qZA(),e.TgZ(29,"vdr-dt2-column",8),e.ALo(30,"translate"),e.YNc(31,ko,1,1,"ng-template"),e.qZA(),e.TgZ(32,"vdr-dt2-column",9),e.ALo(33,"translate"),e.YNc(34,qo,2,2,"ng-template"),e.qZA(),e.YNc(35,Mo,1,2,"vdr-dt2-custom-field-column",10),e.qZA()),2&n&&(e.xp6(3),e.Q6J("availableLanguageCodes",e.lcZ(4,28,t.availableLanguages$))("currentLanguageCode",e.lcZ(5,30,t.contentLanguage$)),e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(54,Qo)),e.xp6(1),e.Q6J("items",e.lcZ(10,32,t.items$))("itemsPerPage",e.lcZ(11,34,t.itemsPerPage$))("totalItems",e.lcZ(12,36,t.totalItems$))("currentPage",e.lcZ(13,38,t.currentPage$))("filters",t.filters),e.xp6(5),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(16,40,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(18,42,"common.id"))("hiddenByDefault",!0)("sort",t.sorts.get("id")),e.xp6(3),e.Q6J("heading",e.lcZ(21,44,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(24,46,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(27,48,"common.name"))("optional",!1)("sort",t.sorts.get("name")),e.xp6(3),e.Q6J("heading",e.lcZ(30,50,"common.code"))("sort",t.sorts.get("code")),e.xp6(3),e.Q6J("heading",e.lcZ(33,52,"common.enabled")),e.xp6(3),e.Q6J("ngForOf",t.customFields))},dependencies:[g.qvL,u.sg,u.O5,y.rH,p.Kk,p.BN,p.mz,E.Y,j.S,T.H,Z.W,I.c,P.e,D.U,k.J,R.j,v.z,u.Ov,h.X$,N.H],changeDetection:0});const wo=f.Ps`
    query GetProfileDetail {
        activeAdministrator {
            ...ProfileDetail
        }
    }
    fragment ProfileDetail on Administrator {
        id
        createdAt
        updatedAt
        firstName
        lastName
        emailAddress
        user {
            id
            lastLogin
            verified
        }
    }
`;class de extends s.VE7{constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.customFields=this.getCustomFieldConfig("Administrator"),this.detailForm=this.formBuilder.group({emailAddress:["",r.kI.required],firstName:["",r.kI.required],lastName:["",r.kI.required],password:[""],customFields:this.formBuilder.group(this.customFields.reduce((c,m)=>({...c,[m.name]:""}),{}))})}ngOnInit(){this.init()}ngOnDestroy(){this.destroy()}save(){this.entity$.pipe((0,J.q)(1),(0,L.z)(({id:n})=>{const t=this.detailForm.value,i={emailAddress:t.emailAddress,firstName:t.firstName,lastName:t.lastName,password:t.password,customFields:t.customFields};return this.dataService.administrator.updateActiveAdministrator(i)})).subscribe(n=>{this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"Administrator"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},n=>{this.notificationService.error((0,l.J)("common.notify-update-error"),{entity:"Administrator"})})}setFormValues(n,t){this.detailForm.patchValue({emailAddress:n.emailAddress,firstName:n.firstName,lastName:n.lastName}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get("customFields"),n)}}de.\u0275fac=function(n){return new(n||de)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},de.\u0275cmp=e.Xpm({type:de,selectors:[["vdr-profile"]],features:[e.qOj],decls:32,vars:27,consts:[["locationId","profile"],[1,"btn","btn-primary",3,"disabled","click"],[1,"form",3,"formGroup"],[4,"ngIf"],[1,"form-grid"],["for","emailAddress",3,"label"],["id","emailAddress","type","text","formControlName","emailAddress"],["for","firstName",3,"label"],["id","firstName","type","text","formControlName","firstName"],["for","lastName",3,"label"],["id","lastName","type","text","formControlName","lastName"],["for","password",3,"label",4,"ngIf"],["for","password",3,"label","readOnlyToggle"],["id","password","type","password","formControlName","password"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","administrator-profile",3,"entity$","detailForm"],[3,"entity"],["for","password",3,"label"],["formGroupName","customFields",3,"title"],["entityName","Administrator",3,"customFields","customFieldsFormGroup"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.TgZ(5,"button",1),e.NdJ("click",function(){return t.save()}),e._uU(6),e.ALo(7,"translate"),e.qZA()()()(),e.TgZ(8,"form",2)(9,"vdr-page-detail-layout")(10,"vdr-page-detail-sidebar"),e.YNc(11,Oo,2,1,"vdr-card",3),e.ALo(12,"async"),e.qZA(),e.TgZ(13,"vdr-page-block")(14,"vdr-card")(15,"div",4)(16,"vdr-form-field",5),e.ALo(17,"translate"),e._UZ(18,"input",6),e.qZA(),e.TgZ(19,"vdr-form-field",7),e.ALo(20,"translate"),e._UZ(21,"input",8),e.qZA(),e.TgZ(22,"vdr-form-field",9),e.ALo(23,"translate"),e._UZ(24,"input",10),e.qZA(),e.YNc(25,$o,3,3,"vdr-form-field",11),e.ALo(26,"async"),e.TgZ(27,"vdr-form-field",12),e.ALo(28,"translate"),e._UZ(29,"input",13),e.qZA()()(),e.YNc(30,Ro,3,5,"vdr-card",14),e._UZ(31,"vdr-custom-detail-component-host",15),e.qZA()()()),2&n&&(e.xp6(5),e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(7,13,"common.update")," "),e.xp6(2),e.Q6J("formGroup",t.detailForm),e.xp6(3),e.Q6J("ngIf",e.lcZ(12,15,t.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(17,17,"settings.email-address")),e.xp6(3),e.Q6J("label",e.lcZ(20,19,"settings.first-name")),e.xp6(3),e.Q6J("label",e.lcZ(23,21,"settings.last-name")),e.xp6(3),e.Q6J("ngIf",e.lcZ(26,23,t.isNew$)),e.xp6(2),e.Q6J("label",e.lcZ(28,25,"settings.password"))("readOnlyToggle",!0),e.xp6(3),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm))},dependencies:[u.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,r.x0,p.Kk,p.BN,p.mz,x.h,A.y,Z.W,S.y,q.C,v.z,M.D,Q.T,U.W,F.A,u.Ov,h.X$],changeDetection:0});var Yo=d(1044),Eo=d(3027);function Go(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function Bo(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.detailForm.invalid||t.detailForm.pristine),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function jo(o,n){1&o&&e.YNc(0,Bo,3,4,"button",16),2&o&&e.Q6J("vdrIfPermissions","UpdateAdministrator")}function Ho(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",17),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}const zo=f.Ps`
    query GetRoleDetail($id: ID!) {
        role(id: $id) {
            ...Role
        }
    }
    ${s.asA}
`;class me extends s.VE7{constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.detailForm=this.formBuilder.group({code:["",r.kI.required],description:["",r.kI.required],channelIds:[[]],permissions:[[]]}),this.permissionDefinitions=this.serverConfigService.getPermissionDefinitions()}ngOnInit(){this.init()}ngOnDestroy(){this.destroy()}updateCode(n){const t=this.detailForm.get(["code"]);t&&t.pristine&&t.setValue((0,qe.U)(n,"-"))}setPermission(n){const t=this.detailForm.get("permissions");if(t){const i=t.value,a=!0===n.value?(0,Yo.T)([...i,n.permission]):i.filter(c=>c!==n.permission);t.setValue(a),t.markAsDirty()}}create(){const{code:n,description:t,permissions:i,channelIds:a}=this.detailForm.value;if(!n||!t)return;const c={code:n,description:t,permissions:i??[],channelIds:a};this.dataService.administrator.createRole(c).subscribe(m=>{this.notificationService.success((0,l.J)("common.notify-create-success"),{entity:"Role"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",m.createRole.id],{relativeTo:this.route})},m=>{this.notificationService.error((0,l.J)("common.notify-create-error"),{entity:"Role"})})}save(){this.entity$.pipe((0,J.q)(1),(0,L.z)(({id:n})=>{const i={id:n,...this.detailForm.value};return this.dataService.administrator.updateRole(i)})).subscribe(n=>{this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"Role"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},n=>{this.notificationService.error((0,l.J)("common.notify-update-error"),{entity:"Role"})})}setFormValues(n,t){this.detailForm.patchValue({description:n.description,code:n.code,channelIds:n.channels.map(i=>i.id),permissions:n.permissions}),this.changeDetector.detectChanges()}}me.\u0275fac=function(n){return new(n||me)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},me.\u0275cmp=e.Xpm({type:me,selectors:[["vdr-role-detail"]],features:[e.qOj],decls:35,vars:37,consts:[["locationId","role-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],[4,"ngIf"],[1,"form-grid"],["for","description",3,"label"],["id","description","type","text","formControlName","description",3,"readonly","input"],["for","code",3,"label","readOnlyToggle"],["id","code","type","text","formControlName","code",3,"readonly"],[1,"mt-2"],[3,"title"],[3,"label"],["formControlName","channelIds",3,"vdrDisabled"],[1,"mt-2",3,"permissionDefinitions","activePermissions","readonly","permissionChange"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,Go,3,4,"button",1),e.ALo(6,"async"),e.YNc(7,jo,1,1,"ng-template",null,2,e.W1O),e.qZA()()(),e.TgZ(9,"form",3)(10,"vdr-page-detail-layout")(11,"vdr-page-detail-sidebar"),e.YNc(12,Ho,2,1,"vdr-card",4),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"vdr-page-block")(15,"vdr-card")(16,"div",5)(17,"vdr-form-field",6),e.ALo(18,"translate"),e.TgZ(19,"input",7),e.NdJ("input",function(a){return t.updateCode(a.target.value)}),e.ALo(20,"hasPermission"),e.qZA()(),e.TgZ(21,"vdr-form-field",8),e.ALo(22,"translate"),e.ALo(23,"hasPermission"),e._UZ(24,"input",9),e.ALo(25,"hasPermission"),e.qZA()()()()(),e.TgZ(26,"vdr-page-block",10)(27,"vdr-card",11),e.ALo(28,"translate"),e.TgZ(29,"vdr-form-field",12),e.ALo(30,"translate"),e._UZ(31,"vdr-channel-assignment-control",13),e.ALo(32,"hasPermission"),e.qZA(),e.TgZ(33,"vdr-permission-grid",14),e.NdJ("permissionChange",function(a){return t.setPermission(a)}),e.ALo(34,"hasPermission"),e.qZA()()()()),2&n){const i=e.MAs(8);let a;e.xp6(5),e.Q6J("ngIf",e.lcZ(6,15,t.isNew$))("ngIfElse",i),e.xp6(4),e.Q6J("formGroup",t.detailForm),e.xp6(3),e.Q6J("ngIf",e.lcZ(13,17,t.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(18,19,"common.description")),e.xp6(2),e.Q6J("readonly",!e.lcZ(20,21,"UpdateAdministrator")),e.xp6(2),e.Q6J("label",e.lcZ(22,23,"common.code"))("readOnlyToggle",e.lcZ(23,25,"UpdateAdministrator")),e.xp6(3),e.Q6J("readonly",!e.lcZ(25,27,"UpdateAdministrator")),e.xp6(3),e.Q6J("title",e.lcZ(28,29,"settings.permissions")),e.xp6(2),e.Q6J("label",e.lcZ(30,31,"settings.channel")),e.xp6(2),e.Q6J("vdrDisabled",!e.lcZ(32,33,"UpdateAdministrator")),e.xp6(2),e.Q6J("permissionDefinitions",t.permissionDefinitions)("activePermissions",null==(a=t.detailForm.get("permissions"))?null:a.value)("readonly",!e.lcZ(34,35,"UpdateAdministrator"))}},dependencies:[u.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,p.Kk,p.BN,p.mz,x.h,A.y,T.H,Z.W,Y.x,Eo.S,v.z,M.D,Q.T,U.W,F.A,B,u.Ov,h.X$,O.j],changeDetection:0});const it=(0,s.wwB)({location:"role-list",requiresPermission:o=>o.includes(s.y3$.DeleteAdministrator),getItemName:o=>o.description,bulkDelete:(o,n)=>o.administrator.deleteRoles(n).pipe((0,b.U)(t=>t.deleteRoles))});var Vo=d(9176);const Ko=function(){return["./","create"]};function Xo(o,n){1&o&&(e.TgZ(0,"a",10),e._UZ(1,"clr-icon",11),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,Ko)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"settings.create-new-role")," "))}function Wo(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function ei(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function ti(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const ni=function(o){return["./",o]};function oi(o,n){if(1&o&&(e.TgZ(0,"a",14)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",15),e.qZA()),2&o){const t=e.oxw().item;e.Q6J("routerLink",e.VKq(2,ni,t.id)),e.xp6(2),e.Oqu(t.description)}}function ii(o,n){if(1&o&&e._uU(0),2&o){const t=e.oxw().item;e.hij(" ",t.description," ")}}function ai(o,n){if(1&o&&(e.YNc(0,oi,4,4,"a",12),e.YNc(1,ii,1,1,"ng-template",null,13,e.W1O)),2&o){const t=n.item,i=e.MAs(2),a=e.oxw();e.Q6J("ngIf",!a.isDefaultRole(t))("ngIfElse",i)}}function si(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw().item;e.xp6(1),e.Oqu(t.code)}}function ri(o,n){if(1&o&&e.YNc(0,si,2,1,"span",16),2&o){const t=n.item,i=e.oxw();e.Q6J("ngIf",!i.isDefaultRole(t))}}function li(o,n){if(1&o&&(e.TgZ(0,"vdr-chip"),e._UZ(1,"vdr-channel-badge",18),e.TgZ(2,"div",19),e._uU(3),e.ALo(4,"translate"),e.ALo(5,"channelCodeToLabel"),e.qZA()()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("channelCode",t.code),e.xp6(2),e.Oqu(e.lcZ(4,2,e.lcZ(5,4,t.code)))}}function ci(o,n){if(1&o&&(e.ynx(0),e.YNc(1,li,6,6,"vdr-chip",17),e.BQk()),2&o){const t=e.oxw().item;e.xp6(1),e.Q6J("ngForOf",t.channels)}}function di(o,n){if(1&o&&e.YNc(0,ci,2,1,"ng-container",16),2&o){const t=n.item,i=e.oxw();e.Q6J("ngIf",!i.isDefaultRole(t))}}function mi(o,n){if(1&o&&(e.TgZ(0,"vdr-chip"),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Oqu(t)}}function ui(o,n){if(1&o&&(e.ynx(0),e._UZ(1,"clr-icon",11),e._uU(2),e.BQk()),2&o){const t=e.oxw(3).item,i=e.oxw();e.xp6(2),e.hij(" ",t.permissions.length-i.initialLimit," ")}}function pi(o,n){1&o&&e._UZ(0,"clr-icon",25)}function gi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).item,c=e.oxw();return e.KtG(c.toggleDisplayLimit(a))}),e.YNc(1,ui,3,1,"ng-container",20),e.YNc(2,pi,1,0,"ng-template",null,24,e.W1O),e.qZA()}if(2&o){const t=e.MAs(3),i=e.oxw(2).item,a=e.oxw();e.xp6(1),e.Q6J("ngIf",(a.displayLimit[i.id]||0)<i.permissions.length)("ngIfElse",t)}}function hi(o,n){if(1&o&&(e.ynx(0),e.TgZ(1,"div",21),e.YNc(2,mi,2,1,"vdr-chip",17),e.ALo(3,"slice"),e.YNc(4,gi,4,2,"button",22),e.qZA(),e.BQk()),2&o){const t=e.oxw().item,i=e.oxw();e.xp6(2),e.Q6J("ngForOf",e.Dn7(3,2,t.permissions,0,i.displayLimit[t.id]||3)),e.xp6(2),e.Q6J("ngIf",t.permissions.length>i.initialLimit)}}function _i(o,n){1&o&&(e.TgZ(0,"span",26),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"settings.default-role-label")))}function fi(o,n){if(1&o&&(e.YNc(0,hi,5,6,"ng-container",20),e.YNc(1,_i,3,3,"ng-template",null,13,e.W1O)),2&o){const t=n.item,i=e.MAs(2),a=e.oxw();e.Q6J("ngIf",!a.isDefaultRole(t))("ngIfElse",i)}}const Ci=function(){return["CreateAdministrator"]},vi=f.Ps`
    query GetRoleList($options: RoleListOptions) {
        roles(options: $options) {
            items {
                ...Role
            }
            totalItems
        }
    }
    ${s.asA}
`;class ue extends s.$ms{constructor(){super(),this.initialLimit=3,this.displayLimit={},this.filters=this.createFilterCollection().addDateFilters().addFilter({name:"code",type:{kind:"text"},label:(0,l.J)("common.code"),filterField:"code"}).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"code"}).addSort({name:"description"}).connectToRoute(this.route),super.configure({document:s.nY8,getItems:n=>n.roles,setVariables:(n,t)=>({options:{skip:n,take:t,filter:{code:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}toggleDisplayLimit(n){this.displayLimit[n.id]===n.permissions.length?this.displayLimit[n.id]=this.initialLimit:this.displayLimit[n.id]=n.permissions.length}isDefaultRole(n){return n.code===G.Wi||n.code===G.RO}}function bi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",!t.saveButtonEnabled()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function Zi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",!t.saveButtonEnabled()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}ue.\u0275fac=function(n){return new(n||ue)},ue.\u0275cmp=e.Xpm({type:ue,selectors:[["vdr-role-list"]],features:[e.qOj],decls:35,vars:50,consts:[["locationId","role-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],["id","role-list",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","role-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault"],[3,"heading","hiddenByDefault","sort"],[3,"heading","optional","sort"],[3,"heading","sort"],[3,"heading"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],["class","button-ghost",3,"routerLink",4,"ngIf","ngIfElse"],["defaultRole",""],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"channelCode"],[1,"ml-1"],[4,"ngIf","ngIfElse"],[1,"permissions-list"],["class","button-small",3,"click",4,"ngIf"],[1,"button-small",3,"click"],["collapse",""],["shape","minus"],[1,"default-role-label"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,Xo,4,5,"a",1),e.qZA()()(),e.TgZ(6,"vdr-data-table-2",2),e.NdJ("pageChange",function(a){return t.setPageNumber(a)})("itemsPerPageChange",function(a){return t.setItemsPerPage(a)}),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"async"),e.ALo(10,"async"),e._UZ(11,"vdr-bulk-action-menu",3)(12,"vdr-dt2-search",4),e.ALo(13,"translate"),e.TgZ(14,"vdr-dt2-column",5),e.ALo(15,"translate"),e.YNc(16,Wo,1,1,"ng-template"),e.qZA(),e.TgZ(17,"vdr-dt2-column",6),e.ALo(18,"translate"),e.YNc(19,ei,2,4,"ng-template"),e.qZA(),e.TgZ(20,"vdr-dt2-column",6),e.ALo(21,"translate"),e.YNc(22,ti,2,4,"ng-template"),e.qZA(),e.TgZ(23,"vdr-dt2-column",7),e.ALo(24,"translate"),e.YNc(25,ai,3,2,"ng-template"),e.qZA(),e.TgZ(26,"vdr-dt2-column",8),e.ALo(27,"translate"),e.YNc(28,ri,1,1,"ng-template"),e.qZA(),e.TgZ(29,"vdr-dt2-column",9),e.ALo(30,"translate"),e.YNc(31,di,1,1,"ng-template"),e.qZA(),e.TgZ(32,"vdr-dt2-column",9),e.ALo(33,"translate"),e.YNc(34,fi,3,2,"ng-template"),e.qZA()()),2&n&&(e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(49,Ci)),e.xp6(1),e.Q6J("items",e.lcZ(7,25,t.items$))("itemsPerPage",e.lcZ(8,27,t.itemsPerPage$))("totalItems",e.lcZ(9,29,t.totalItems$))("currentPage",e.lcZ(10,31,t.currentPage$))("filters",t.filters),e.xp6(5),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(13,33,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(15,35,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(18,37,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(21,39,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(24,41,"common.description"))("optional",!1)("sort",t.sorts.get("description")),e.xp6(3),e.Q6J("heading",e.lcZ(27,43,"common.code"))("sort",t.sorts.get("code")),e.xp6(3),e.Q6J("heading",e.lcZ(30,45,"settings.channel")),e.xp6(3),e.Q6J("heading",e.lcZ(33,47,"settings.permissions")))},dependencies:[g.qvL,u.sg,u.O5,y.rH,p.Kk,p.BN,p.mz,E.Y,T.H,Z.W,Vo.n,I.c,P.e,D.U,k.J,v.z,u.Ov,u.OU,h.X$,De.E,N.H],styles:[".default-role-label[_ngcontent-%COMP%]{color:var(--color-grey-400)}.permissions-list[_ngcontent-%COMP%]{max-width:500px;display:flex;flex-wrap:wrap;align-items:center;gap:4px}"],changeDetection:0});const Ti=function(){return["SuperAdmin","UpdateSeller"]};function yi(o,n){1&o&&e.YNc(0,Zi,3,4,"button",11),2&o&&e.Q6J("vdrIfPermissions",e.DdM(1,Ti))}function Ai(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",12),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function Li(o,n){if(1&o&&(e.TgZ(0,"vdr-card",13),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",14),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))}}const xi=f.Ps`
    query GetSellerDetail($id: ID!) {
        seller(id: $id) {
            ...SellerDetail
        }
    }
    fragment SellerDetail on Seller {
        id
        createdAt
        updatedAt
        name
    }
`;class pe extends s.VE7{constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.customFields=this.getCustomFieldConfig("Seller"),this.detailForm=this.formBuilder.group({name:["",r.kI.required],customFields:this.formBuilder.group(this.customFields.reduce((c,m)=>({...c,[m.name]:""}),{}))}),this.updatePermission=[s.y3$.SuperAdmin,s.y3$.UpdateSeller,s.y3$.CreateSeller]}ngOnInit(){this.init()}ngOnDestroy(){this.destroy()}saveButtonEnabled(){return this.detailForm.dirty&&this.detailForm.valid}create(){if(!this.detailForm.dirty)return;const n=this.detailForm.value;if(!n.name)return;const t={name:n.name,customFields:n.customFields};this.dataService.settings.createSeller(t).subscribe(i=>{if("Seller"===i.createSeller.__typename)this.notificationService.success((0,l.J)("common.notify-create-success"),{entity:"Seller"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",i.createSeller.id],{relativeTo:this.route})})}save(){if(!this.detailForm.dirty)return;const n=this.detailForm.value;this.entity$.pipe((0,J.q)(1),(0,L.z)(t=>{const i={id:t.id,name:n.name,customFields:n.customFields};return this.dataService.settings.updateSeller(i)})).subscribe(({updateSeller:t})=>{if("Seller"===t.__typename)this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"Seller"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()})}setFormValues(n,t){this.detailForm.patchValue({name:n.name}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),n)}}pe.\u0275fac=function(n){return new(n||pe)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},pe.\u0275cmp=e.Xpm({type:pe,selectors:[["vdr-seller-detail"]],features:[e.qOj],decls:23,vars:17,consts:[["locationId","seller-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],[4,"ngIf"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","seller-detail",3,"entity$","detailForm"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],["formGroupName","customFields",3,"title"],["entityName","Seller",3,"customFields","customFieldsFormGroup"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,bi,3,4,"button",1),e.ALo(6,"async"),e.YNc(7,yi,1,2,"ng-template",null,2,e.W1O),e.qZA()()(),e.TgZ(9,"form",3)(10,"vdr-page-detail-layout")(11,"vdr-page-detail-sidebar"),e.YNc(12,Ai,2,1,"vdr-card",4),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"vdr-page-block")(15,"vdr-card")(16,"div",5)(17,"vdr-form-field",6),e.ALo(18,"translate"),e._UZ(19,"input",7),e.ALo(20,"hasPermission"),e.qZA()()(),e.YNc(21,Li,3,5,"vdr-card",8),e._UZ(22,"vdr-custom-detail-component-host",9),e.qZA()()()),2&n){const i=e.MAs(8);e.xp6(5),e.Q6J("ngIf",e.lcZ(6,9,t.isNew$))("ngIfElse",i),e.xp6(4),e.Q6J("formGroup",t.detailForm),e.xp6(3),e.Q6J("ngIf",e.lcZ(13,11,t.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(18,13,"common.name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(20,15,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm)}},dependencies:[u.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,r.x0,p.Kk,p.BN,p.mz,x.h,A.y,T.H,Z.W,S.y,q.C,v.z,M.D,Q.T,U.W,F.A,u.Ov,h.X$,O.j],styles:["clr-alert[_ngcontent-%COMP%]{max-width:30rem;margin-bottom:12px}"],changeDetection:0});const at=(0,s.wwB)({location:"seller-list",requiresPermission:o=>o.includes(s.y3$.DeleteSeller),getItemName:o=>o.name,bulkDelete:(o,n)=>o.settings.deleteSellers(n).pipe((0,b.U)(t=>t.deleteSellers))}),Fi=function(){return["./","create"]};function Ji(o,n){1&o&&(e.TgZ(0,"a",9),e._UZ(1,"clr-icon",10),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,Fi)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"settings.create-new-seller")," "))}function Ii(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.Oqu(t.id)}}function Pi(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function Di(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const ki=function(o){return["./",o]};function Ni(o,n){if(1&o&&(e.TgZ(0,"a",11)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",12),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,ki,t.id)),e.xp6(2),e.Oqu(t.name)}}function Si(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",13),2&o){const t=n.$implicit,i=e.oxw();e.Q6J("customField",t)("sorts",i.sorts)}}const qi=function(){return["SuperAdmin","CreateSeller"]};f.Ps`
    query GetSellerList($options: SellerListOptions) {
        sellers(options: $options) {
            items {
                ...SellerListItem
            }
            totalItems
        }
    }
    fragment SellerListItem on Seller {
        id
        createdAt
        updatedAt
        name
    }
`;class ge extends s.$ms{constructor(){super(),this.customFields=this.getCustomFieldConfig("Seller"),this.filters=this.createFilterCollection().addDateFilters().addFilter({name:"name",type:{kind:"text"},label:(0,l.J)("common.name"),filterField:"name"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"name"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:s.fLo,getItems:n=>n.sellers,setVariables:(n,t)=>({options:{skip:n,take:t,filter:{name:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}}ge.\u0275fac=function(n){return new(n||ge)},ge.\u0275cmp=e.Xpm({type:ge,selectors:[["vdr-seller-list"]],features:[e.qOj],decls:27,vars:41,consts:[["locationId","seller-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],["id","seller-list",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","seller-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault"],[3,"heading","hiddenByDefault","sort"],[3,"heading","optional","sort"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"customField","sorts"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,Ji,4,5,"a",1),e.qZA()()(),e.TgZ(6,"vdr-data-table-2",2),e.NdJ("pageChange",function(a){return t.setPageNumber(a)})("itemsPerPageChange",function(a){return t.setItemsPerPage(a)}),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"async"),e.ALo(10,"async"),e._UZ(11,"vdr-bulk-action-menu",3)(12,"vdr-dt2-search",4),e.ALo(13,"translate"),e.TgZ(14,"vdr-dt2-column",5),e.ALo(15,"translate"),e.YNc(16,Ii,1,1,"ng-template"),e.qZA(),e.TgZ(17,"vdr-dt2-column",6),e.ALo(18,"translate"),e.YNc(19,Pi,2,4,"ng-template"),e.qZA(),e.TgZ(20,"vdr-dt2-column",6),e.ALo(21,"translate"),e.YNc(22,Di,2,4,"ng-template"),e.qZA(),e.TgZ(23,"vdr-dt2-column",7),e.ALo(24,"translate"),e.YNc(25,Ni,4,4,"ng-template"),e.qZA(),e.YNc(26,Si,1,2,"vdr-dt2-custom-field-column",8),e.qZA()),2&n&&(e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(40,qi)),e.xp6(1),e.Q6J("items",e.lcZ(7,22,t.items$))("itemsPerPage",e.lcZ(8,24,t.itemsPerPage$))("totalItems",e.lcZ(9,26,t.totalItems$))("currentPage",e.lcZ(10,28,t.currentPage$))("filters",t.filters),e.xp6(5),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(13,30,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(15,32,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(18,34,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(21,36,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(24,38,"common.name"))("optional",!1)("sort",t.sorts.get("name")),e.xp6(3),e.Q6J("ngForOf",t.customFields))},dependencies:[g.qvL,u.sg,y.rH,p.Kk,p.BN,p.mz,T.H,Z.W,I.c,P.e,D.U,k.J,R.j,v.z,u.Ov,h.X$,N.H],changeDetection:0});var st=d(8258),rt=d(1434),Me=d(2491);function Mi(o,n){if(1&o&&e._UZ(0,"vdr-object-tree",10),2&o){const t=e.oxw().$implicit;e.Q6J("value",t.metadata)}}function Qi(o,n){if(1&o&&(e.TgZ(0,"div",5)(1,"div",6)(2,"vdr-labeled-data",7),e.ALo(3,"translate"),e._uU(4),e.qZA(),e.TgZ(5,"div",8)(6,"vdr-labeled-data",7),e.ALo(7,"translate"),e._uU(8),e.ALo(9,"localeCurrency"),e.qZA(),e.TgZ(10,"vdr-labeled-data",7),e.ALo(11,"translate"),e._uU(12),e.ALo(13,"localeCurrency"),e.qZA()(),e.YNc(14,Mi,1,1,"vdr-object-tree",9),e.qZA()()),2&o){const t=n.$implicit,i=e.oxw();e.xp6(1),e.ekj("stale",i.testDataUpdated),e.xp6(1),e.Q6J("label",e.lcZ(3,9,"settings.shipping-method")),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("label",e.lcZ(7,11,"common.price")),e.xp6(2),e.hij(" ",e.xi3(9,13,t.price,i.currencyCode)," "),e.xp6(2),e.Q6J("label",e.lcZ(11,16,"common.price-with-tax")),e.xp6(2),e.hij(" ",e.xi3(13,18,t.priceWithTax,i.currencyCode)," "),e.xp6(2),e.Q6J("ngIf",t.metadata)}}function Ui(o,n){1&o&&(e.TgZ(0,"div",5),e._UZ(1,"clr-icon",11),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"settings.no-eligible-shipping-methods")," "))}class he{constructor(){this.okToRun=!1,this.testDataUpdated=!1,this.runTest=new e.vpe}}he.\u0275fac=function(n){return new(n||he)},he.\u0275cmp=e.Xpm({type:he,selectors:[["vdr-shipping-eligibility-test-result"]],inputs:{testResult:"testResult",okToRun:"okToRun",testDataUpdated:"testDataUpdated",currencyCode:"currencyCode"},outputs:{runTest:"runTest"},decls:8,vars:9,consts:[[1,"test-result",3,"title"],["class","card-span",4,"ngFor","ngForOf"],["class","card-span",4,"ngIf"],[1,"card-footer"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"card-span"],[1,"result-details"],[3,"label"],[1,"price-row"],[3,"value",4,"ngIf"],[3,"value"],["shape","ban",1,"is-solid","error"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-card",0),e.ALo(1,"translate"),e.YNc(2,Qi,15,21,"div",1),e.YNc(3,Ui,4,3,"div",2),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return t.runTest.emit()}),e._uU(6),e.ALo(7,"translate"),e.qZA()()()),2&n&&(e.Q6J("title",e.lcZ(1,5,"settings.test-result")),e.xp6(2),e.Q6J("ngForOf",t.testResult),e.xp6(1),e.Q6J("ngIf",0===(null==t.testResult?null:t.testResult.length)),e.xp6(2),e.Q6J("disabled",!t.okToRun),e.xp6(1),e.hij(" ",e.lcZ(7,7,"settings.test-shipping-methods")," "))},dependencies:[g.qvL,u.sg,u.O5,st.W,rt._,F.A,h.X$,Me.k],styles:["[_nghost-%COMP%]{display:block}.result-details[_ngcontent-%COMP%]{transition:opacity .2s}.result-details.stale[_ngcontent-%COMP%]{opacity:.5}.price-row[_ngcontent-%COMP%]{display:flex}.price-row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(:first-child){margin-left:24px}clr-icon.error[_ngcontent-%COMP%]{color:var(--color-error-500)}"],changeDetection:0});var Oi=d(9225),$i=d(3651);function Ri(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"tr",8)(1,"td",9),e._UZ(2,"img",10),e.qZA(),e.TgZ(3,"td",11),e._uU(4),e.qZA(),e.TgZ(5,"td",12),e._uU(6),e.qZA(),e.TgZ(7,"td",13),e._uU(8),e.ALo(9,"localeCurrency"),e.qZA(),e.TgZ(10,"td",14)(11,"input",15),e.NdJ("ngModelChange",function(a){const m=e.CHM(t).$implicit;return e.KtG(m.quantity=a)})("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.updateQuantity())}),e.qZA(),e.TgZ(12,"button",16),e.NdJ("click",function(){const c=e.CHM(t).$implicit,m=e.oxw(2);return e.KtG(m.removeLine(c))}),e._UZ(13,"clr-icon",17),e.qZA()(),e.TgZ(14,"td",18),e._uU(15),e.ALo(16,"localeCurrency"),e.qZA()()}if(2&o){const t=n.$implicit,i=e.oxw(2);e.xp6(2),e.Q6J("src",t.preview+"?preset=tiny",e.LSH),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.sku),e.xp6(2),e.hij(" ",e.xi3(9,6,t.unitPriceWithTax,i.currencyCode)," "),e.xp6(3),e.Q6J("ngModel",t.quantity),e.xp6(4),e.hij(" ",e.xi3(16,9,t.unitPriceWithTax*t.quantity,i.currencyCode)," ")}}function wi(o,n){if(1&o&&(e.TgZ(0,"table",4)(1,"thead")(2,"tr"),e._UZ(3,"th"),e.TgZ(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA()()(),e.YNc(19,Ri,17,12,"tr",5),e.TgZ(20,"tr",6)(21,"td",7),e._uU(22),e.ALo(23,"translate"),e.qZA(),e._UZ(24,"td")(25,"td")(26,"td")(27,"td"),e.TgZ(28,"td"),e._uU(29),e.ALo(30,"localeCurrency"),e.qZA()()()),2&o){const t=e.oxw();e.xp6(5),e.Oqu(e.lcZ(6,8,"order.product-name")),e.xp6(3),e.Oqu(e.lcZ(9,10,"order.product-sku")),e.xp6(3),e.Oqu(e.lcZ(12,12,"order.unit-price")),e.xp6(3),e.Oqu(e.lcZ(15,14,"order.quantity")),e.xp6(3),e.Oqu(e.lcZ(18,16,"order.total")),e.xp6(2),e.Q6J("ngForOf",t.lines),e.xp6(3),e.Oqu(e.lcZ(23,18,"order.sub-total")),e.xp6(7),e.Oqu(e.xi3(30,20,t.subTotal,t.currencyCode))}}function Yi(o,n){1&o&&(e.TgZ(0,"div",19)(1,"div",20),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"clr-icon",21),e.qZA()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"settings.add-products-to-test-order")))}class H{get subTotal(){return this.lines.reduce((n,t)=>n+t.unitPriceWithTax*t.quantity,0)}constructor(n,t){this.dataService=n,this.localStorageService=t,this.orderLinesChange=new e.vpe,this.lines=[]}ngOnInit(){this.lines=this.loadFromLocalStorage(),this.lines&&this.orderLinesChange.emit(this.lines),this.dataService.settings.getActiveChannel("cache-first").single$.subscribe(n=>{this.currencyCode=n.activeChannel.defaultCurrencyCode})}selectResult(n){n&&this.addToLines(n)}addToLines(n){this.lines.find(t=>t.id===n.productVariantId)||(this.lines.push({id:n.productVariantId,name:n.productVariantName,preview:n.productAsset?.preview??"",quantity:1,sku:n.sku,unitPriceWithTax:"SinglePrice"===n.priceWithTax.__typename&&n.priceWithTax.value||0}),this.persistToLocalStorage(),this.orderLinesChange.emit(this.lines))}updateQuantity(){this.persistToLocalStorage(),this.orderLinesChange.emit(this.lines)}removeLine(n){this.lines=this.lines.filter(t=>t.id!==n.id),this.persistToLocalStorage(),this.orderLinesChange.emit(this.lines)}persistToLocalStorage(){this.localStorageService.setForCurrentLocation("shippingTestOrder",this.lines)}loadFromLocalStorage(){return this.localStorageService.getForCurrentLocation("shippingTestOrder")||[]}}function Ei(o,n){if(1&o&&(e.TgZ(0,"option",10),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.hij(" ",t.name," ")}}H.\u0275fac=function(n){return new(n||H)(e.Y36(s.DoR),e.Y36(s.n2A))},H.\u0275cmp=e.Xpm({type:H,selectors:[["vdr-test-order-builder"]],outputs:{orderLinesChange:"orderLinesChange"},decls:5,vars:2,consts:[["class","order-table table",4,"ngIf","ngIfElse"],["emptyPlaceholder",""],[1,"card-block"],[3,"productSelected"],[1,"order-table","table"],["class","order-line",4,"ngFor","ngForOf"],[1,"sub-total"],[1,"left"],[1,"order-line"],[1,"align-middle","thumb"],[3,"src"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","unit-price"],[1,"align-middle","quantity"],["type","number","max","9999","min","1",3,"ngModel","ngModelChange","change"],[1,"icon-button",3,"click"],["shape","trash"],[1,"align-middle","total"],[1,"card-block","empty-placeholder","card-span"],[1,"empty-text"],["shape","arrow","dir","down","size","96"]],template:function(n,t){if(1&n&&(e.YNc(0,wi,31,23,"table",0),e.YNc(1,Yi,5,3,"ng-template",null,1,e.W1O),e.TgZ(3,"div",2)(4,"vdr-product-variant-selector",3),e.NdJ("productSelected",function(a){return t.selectResult(a)}),e.qZA()()),2&n){const i=e.MAs(2);e.Q6J("ngIf",t.lines.length)("ngIfElse",i)}},dependencies:[g.qvL,u.sg,u.O5,r.Fj,r.wV,r.JJ,r.qQ,r.Fd,r.On,Oi.Lv,A.y,$i.e,h.X$,Me.k],styles:[".empty-placeholder[_ngcontent-%COMP%]{color:var(--color-grey-400);text-align:center}.empty-text[_ngcontent-%COMP%]{font-size:22px}.thumb[_ngcontent-%COMP%]{max-width:50px}"],changeDetection:0});class z{constructor(n,t,i){this.formBuilder=n,this.dataService=t,this.localStorageService=i,this.addressChange=new e.vpe}ngOnInit(){this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(i=>i.countries.items);const t=this.localStorageService.getForCurrentLocation("shippingTestAddress")||{city:"",countryCode:"",postalCode:"",province:""};this.addressChange.emit(t),this.form=this.formBuilder.group(t),this.subscription=this.form.valueChanges.subscribe(i=>{this.localStorageService.setForCurrentLocation("shippingTestAddress",i),this.addressChange.emit(i)})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}function Gi(o,n){1&o&&e._UZ(0,"clr-icon",14)}function Bi(o,n){1&o&&e._UZ(0,"clr-icon",15)}function ji(o,n){1&o&&e._UZ(0,"clr-icon",16)}function Hi(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",4),e.ALo(1,"translate"),e._uU(2),e.ALo(3,"localeCurrency"),e.qZA()),2&o){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,"common.price")),e.xp6(2),e.hij(" ",e.xi3(3,4,null==t.testResult.quote?null:t.testResult.quote.price,t.currencyCode)," ")}}function zi(o,n){if(1&o&&(e.TgZ(0,"vdr-labeled-data",4),e.ALo(1,"translate"),e._uU(2),e.ALo(3,"localeCurrency"),e.qZA()),2&o){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,"common.price-with-tax")),e.xp6(2),e.hij(" ",e.xi3(3,4,null==t.testResult.quote?null:t.testResult.quote.priceWithTax,t.currencyCode)," ")}}function Vi(o,n){if(1&o&&e._UZ(0,"vdr-object-tree",17),2&o){const t=e.oxw();e.Q6J("value",null==t.testResult||null==t.testResult.quote?null:t.testResult.quote.metadata)}}z.\u0275fac=function(n){return new(n||z)(e.Y36(r.QS),e.Y36(s.DoR),e.Y36(s.n2A))},z.\u0275cmp=e.Xpm({type:z,selectors:[["vdr-test-address-form"]],outputs:{addressChange:"addressChange"},decls:20,vars:19,consts:[[1,"card"],[1,"card-header"],[1,"card-block"],[1,"form-grid",3,"formGroup"],[3,"label"],["formControlName","city","type","text"],["formControlName","province","type","text"],["formControlName","postalCode","type","text"],["name","countryCode","formControlName","countryCode"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",2)(5,"form",3)(6,"vdr-form-field",4),e.ALo(7,"translate"),e._UZ(8,"input",5),e.qZA(),e.TgZ(9,"vdr-form-field",4),e.ALo(10,"translate"),e._UZ(11,"input",6),e.qZA(),e.TgZ(12,"vdr-form-field",4),e.ALo(13,"translate"),e._UZ(14,"input",7),e.qZA(),e.TgZ(15,"vdr-form-field",4),e.ALo(16,"translate"),e.TgZ(17,"select",8),e.YNc(18,Ei,2,2,"option",9),e.ALo(19,"async"),e.qZA()()()()()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,7,"settings.test-address")," "),e.xp6(3),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("label",e.lcZ(7,9,"customer.city")),e.xp6(3),e.Q6J("label",e.lcZ(10,11,"customer.province")),e.xp6(3),e.Q6J("label",e.lcZ(13,13,"customer.postal-code")),e.xp6(3),e.Q6J("label",e.lcZ(16,15,"customer.country")),e.xp6(3),e.Q6J("ngForOf",e.lcZ(19,17,t.availableCountries$)))},dependencies:[u.sg,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.sg,r.u,x.h,A.y,u.Ov,h.X$],styles:["[_nghost-%COMP%]{display:block}clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}"],changeDetection:0});const Ki=function(o,n,t){return{success:o,error:n,unknown:t}};class _e{constructor(){this.okToRun=!1,this.testDataUpdated=!1,this.runTest=new e.vpe}}function Xi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.detailForm.pristine||t.detailForm.invalid||!t.selectedChecker||!t.selectedCalculator),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function Wi(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.detailForm.pristine||t.detailForm.invalid||!t.selectedChecker||!t.selectedCalculator),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function ea(o,n){if(1&o&&e.YNc(0,Wi,3,4,"button",25),2&o){const t=e.oxw();e.Q6J("vdrIfPermissions",t.updatePermission)}}function ta(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",26),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function na(o,n){if(1&o&&(e.TgZ(0,"option",27),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.AsE(" ",t.code,": ",t.description," ")}}function oa(o,n){if(1&o&&(e.TgZ(0,"vdr-card",28),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",29),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))}}function ia(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-configurable-input",30),e.NdJ("remove",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedChecker=null)}),e.ALo(1,"hasPermission"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("operation",t.selectedChecker)("operationDefinition",t.selectedCheckerDefinition)("readonly",!e.lcZ(1,3,t.updatePermission))}}function aa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){const c=e.CHM(t).$implicit,m=e.oxw(2);return e.KtG(m.selectChecker(c))}),e._uU(1),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function sa(o,n){if(1&o&&(e.TgZ(0,"div",31)(1,"vdr-dropdown")(2,"button",32),e._UZ(3,"clr-icon",33),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"vdr-dropdown-menu",34),e.YNc(7,aa,2,1,"button",35),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,2,"common.select")," "),e.xp6(3),e.Q6J("ngForOf",t.checkers)}}function ra(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-configurable-input",37),e.NdJ("remove",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedCalculator=null)}),e.ALo(1,"hasPermission"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("operation",t.selectedCalculator)("operationDefinition",t.selectedCalculatorDefinition)("readonly",!e.lcZ(1,3,t.updatePermission))}}function la(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){const c=e.CHM(t).$implicit,m=e.oxw(2);return e.KtG(m.selectCalculator(c))}),e._uU(1),e.qZA()}if(2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function ca(o,n){if(1&o&&(e.TgZ(0,"div",31)(1,"vdr-dropdown")(2,"button",32),e._UZ(3,"clr-icon",33),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"vdr-dropdown-menu",34),e.YNc(7,la,2,1,"button",35),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,2,"common.select")," "),e.xp6(3),e.Q6J("ngForOf",t.calculators)}}_e.\u0275fac=function(n){return new(n||_e)},_e.\u0275cmp=e.Xpm({type:_e,selectors:[["vdr-shipping-method-test-result"]],inputs:{testResult:"testResult",okToRun:"okToRun",testDataUpdated:"testDataUpdated",currencyCode:"currencyCode"},outputs:{runTest:"runTest"},decls:21,vars:24,consts:[[1,"test-result","card",3,"ngClass"],[1,"card-header"],[1,"card-block"],[1,"result-details"],[3,"label"],[1,"eligible-icon"],["shape","success-standard","class","is-solid success",4,"ngIf"],["shape","ban","class","is-solid error",4,"ngIf"],["shape","unknown-status",4,"ngIf"],[1,"price-row"],[3,"label",4,"ngIf"],[3,"value",4,"ngIf"],[1,"card-footer"],[1,"btn","btn-secondary",3,"disabled","click"],["shape","success-standard",1,"is-solid","success"],["shape","ban",1,"is-solid","error"],["shape","unknown-status"],[3,"value"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",2)(5,"div",3)(6,"vdr-labeled-data",4),e.ALo(7,"translate"),e.TgZ(8,"div",5),e.YNc(9,Gi,1,0,"clr-icon",6),e.YNc(10,Bi,1,0,"clr-icon",7),e.YNc(11,ji,1,0,"clr-icon",8),e.qZA(),e._uU(12),e.qZA(),e.TgZ(13,"div",9),e.YNc(14,Hi,4,7,"vdr-labeled-data",10),e.YNc(15,zi,4,7,"vdr-labeled-data",10),e.qZA(),e.YNc(16,Vi,1,1,"vdr-object-tree",11),e.qZA()(),e.TgZ(17,"div",12)(18,"button",13),e.NdJ("click",function(){return t.runTest.emit()}),e._uU(19),e.ALo(20,"translate"),e.qZA()()()),2&n&&(e.Q6J("ngClass",e.kEZ(20,Ki,!0===(null==t.testResult?null:t.testResult.eligible),!1===(null==t.testResult?null:t.testResult.eligible),!t.testResult)),e.xp6(2),e.hij(" ",e.lcZ(3,14,"settings.test-result")," "),e.xp6(3),e.ekj("stale",t.testDataUpdated),e.xp6(1),e.Q6J("label",e.lcZ(7,16,"settings.eligible")),e.xp6(3),e.Q6J("ngIf",null==t.testResult?null:t.testResult.eligible),e.xp6(1),e.Q6J("ngIf",!1===(null==t.testResult?null:t.testResult.eligible)),e.xp6(1),e.Q6J("ngIf",!t.testResult),e.xp6(1),e.hij(" ",null==t.testResult?null:t.testResult.eligible," "),e.xp6(2),e.Q6J("ngIf",null!=(null==t.testResult||null==t.testResult.quote?null:t.testResult.quote.price)),e.xp6(1),e.Q6J("ngIf",null!=(null==t.testResult||null==t.testResult.quote?null:t.testResult.quote.priceWithTax)),e.xp6(1),e.Q6J("ngIf",null==t.testResult||null==t.testResult.quote?null:t.testResult.quote.metadata),e.xp6(2),e.Q6J("disabled",!t.okToRun),e.xp6(1),e.hij(" ",e.lcZ(20,18,"settings.test-shipping-method")," "))},dependencies:[g.qvL,u.mk,u.O5,st.W,rt._,h.X$,Me.k],styles:["[_nghost-%COMP%]{display:block}.test-result.success[_ngcontent-%COMP%]   .card-block[_ngcontent-%COMP%]{background-color:var(--color-success-100)}.test-result.error[_ngcontent-%COMP%]   .card-block[_ngcontent-%COMP%]{background-color:var(--color-error-100)}.test-result.unknown[_ngcontent-%COMP%]   .card-block[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}.result-details[_ngcontent-%COMP%]{transition:opacity .2s}.result-details.stale[_ngcontent-%COMP%]{opacity:.5}.eligible-icon[_ngcontent-%COMP%]{display:inline-block}.eligible-icon[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{color:var(--color-success-500)}.eligible-icon[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:var(--color-error-500)}.price-row[_ngcontent-%COMP%]{display:flex}.price-row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(:first-child){margin-left:24px}"],changeDetection:0});const da=f.Ps`
    query GetShippingMethodDetail($id: ID!) {
        shippingMethod(id: $id) {
            ...ShippingMethod
        }
    }
    ${s.c3T}
`;class fe extends s.VE7{constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.customFields=this.getCustomFieldConfig("ShippingMethod"),this.detailForm=this.formBuilder.group({code:["",r.kI.required],name:["",r.kI.required],description:"",fulfillmentHandler:["",r.kI.required],checker:{},calculator:{},customFields:this.formBuilder.group(this.customFields.reduce((c,m)=>({...c,[m.name]:""}),{}))}),this.checkers=[],this.calculators=[],this.fulfillmentHandlers=[],this.testDataUpdated=!1,this.updatePermission=[s.y3$.UpdateSettings,s.y3$.UpdateShippingMethod],this.fetchTestResult$=new Je.x}ngOnInit(){this.init(),this.dataService.shippingMethod.getShippingMethodOperations().single$.subscribe(n=>{this.checkers=n.shippingEligibilityCheckers,this.calculators=n.shippingCalculators,this.fulfillmentHandlers=n.fulfillmentHandlers,this.changeDetector.markForCheck(),this.selectedCheckerDefinition=n.shippingEligibilityCheckers.find(t=>t.code===this.entity?.checker?.code),this.selectedCalculatorDefinition=n.shippingCalculators.find(t=>t.code===this.entity?.calculator?.code)}),this.activeChannel$=this.dataService.settings.getActiveChannel().mapStream(n=>n.activeChannel),this.testResult$=this.fetchTestResult$.pipe((0,Ie.w)(([n,t])=>{const{checker:i,calculator:a}=this.detailForm.value;if(!(this.selectedChecker&&this.selectedCalculator&&i&&a))return(0,Pe.of)(void 0);const c={shippingAddress:{...n,streetLine1:"test"},lines:t.map(m=>({productVariantId:m.id,quantity:m.quantity})),checker:(0,s.RnJ)(this.selectedChecker,i),calculator:(0,s.RnJ)(this.selectedCalculator,a)};return this.dataService.shippingMethod.testShippingMethod(c).mapSingle(m=>m.testShippingMethod)})),(0,Se.T)(this.detailForm.get(["checker"]).valueChanges,this.detailForm.get(["calculator"]).valueChanges).pipe((0,Re.R)(this.destroy$)).subscribe(()=>this.testDataUpdated=!0)}ngOnDestroy(){this.destroy()}updateCode(n,t){if(!n){const i=this.detailForm.get(["code"]);i&&i.pristine&&i.setValue((0,qe.U)(t,"-"))}}selectChecker(n){this.selectedCheckerDefinition=n,this.selectedChecker=(0,s.miO)(n);const t=this.detailForm.get("checker");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedChecker)),this.detailForm.markAsDirty()}selectCalculator(n){this.selectedCalculatorDefinition=n,this.selectedCalculator=(0,s.miO)(n);const t=this.detailForm.get("calculator");t&&(t.clearValidators(),t.updateValueAndValidity({onlySelf:!0}),t.patchValue(this.selectedCalculator)),this.detailForm.markAsDirty()}create(){const n=this.selectedChecker,t=this.selectedCalculator,{checker:i,calculator:a}=this.detailForm.value;if(!(n&&t&&i&&a))return;this.detailForm.value;const m={...this.getUpdatedShippingMethod({createdAt:"",updatedAt:"",id:"",code:"",name:"",description:"",fulfillmentHandlerCode:"",checker:void 0,calculator:void 0,translations:[]},this.detailForm,this.languageCode),checker:(0,s.RnJ)(n,i),calculator:(0,s.RnJ)(t,a)};this.dataService.shippingMethod.createShippingMethod(m).subscribe(C=>{this.notificationService.success((0,l.J)("common.notify-create-success"),{entity:"ShippingMethod"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",C.createShippingMethod.id],{relativeTo:this.route})},C=>{this.notificationService.error((0,l.J)("common.notify-create-error"),{entity:"ShippingMethod"})})}save(){const n=this.selectedChecker,t=this.selectedCalculator,{checker:i,calculator:a}=this.detailForm.value;!n||!t||!i||!a||(0,K.a)([this.entity$,this.languageCode$]).pipe((0,J.q)(1),(0,L.z)(([c,m])=>{this.detailForm.value;const _={...this.getUpdatedShippingMethod(c,this.detailForm,m),checker:(0,s.RnJ)(n,i),calculator:(0,s.RnJ)(t,a)};return this.dataService.shippingMethod.updateShippingMethod(_)})).subscribe(c=>{this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"ShippingMethod"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},c=>{console.error(c),this.notificationService.error((0,l.J)("common.notify-update-error"),{entity:"ShippingMethod"})})}setTestOrderLines(n){this.testOrderLines=n,this.testDataUpdated=!0}setTestAddress(n){this.testAddress=n,this.testDataUpdated=!0}allTestDataPresent(){return!!(this.testAddress&&this.testOrderLines&&this.testOrderLines.length&&this.selectedChecker&&this.selectedCalculator)}runTest(){this.fetchTestResult$.next([this.testAddress,this.testOrderLines]),this.testDataUpdated=!1}getUpdatedShippingMethod(n,t,i){const a=t.value;return{...(0,s.iSy)({translatable:n,updatedFields:a,customFieldConfig:this.customFields,languageCode:i,defaultTranslation:{languageCode:i,name:n.name||"",description:n.description||""}}),fulfillmentHandler:a.fulfillmentHandler}}setFormValues(n,t){const i=(0,s.ZIM)(n,t);this.detailForm.patchValue({name:i?.name??"",description:i?.description??"",code:n.code,fulfillmentHandler:n.fulfillmentHandlerCode,checker:n.checker||{},calculator:n.calculator||{}}),this.selectedChecker||(this.selectedChecker=n.checker&&{code:n.checker.code,args:n.checker.args.map(a=>({...a,value:(0,s.sux)(a.value)}))}),this.selectedCalculator||(this.selectedCalculator=n.calculator&&{code:n.calculator?.code,args:n.calculator?.args.map(a=>({...a,value:(0,s.sux)(a.value)}))}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),n,i)}}fe.\u0275fac=function(n){return new(n||fe)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},fe.\u0275cmp=e.Xpm({type:fe,selectors:[["vdr-shipping-method-detail"]],features:[e.qOj],decls:55,vars:69,consts:[[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","shipping-method-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],[4,"ngIf"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","code",3,"label","readOnlyToggle"],["id","code","type","text","formControlName","code",3,"readonly"],["formControlName","description",1,"form-grid-span",3,"readonly","label"],["for","fulfillmentHandler",3,"label"],["name","fulfillmentHandler","formControlName","fulfillmentHandler",3,"vdrDisabled"],[3,"value",4,"ngFor","ngForOf"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","shipping-method-detail",3,"entity$","detailForm"],[3,"title"],["class","card-span","formControlName","checker",3,"operation","operationDefinition","readonly","remove",4,"ngIf"],["class","card-span",4,"ngIf"],["class","card-span","formControlName","calculator",3,"operation","operationDefinition","readonly","remove",4,"ngIf"],[1,"card-span",3,"orderLinesChange"],[1,"mt-2",3,"addressChange"],[1,"mt-2",3,"currencyCode","okToRun","testDataUpdated","testResult","runTest"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],[3,"value"],["formGroupName","customFields",3,"title"],["entityName","ShippingMethod",3,"customFields","customFieldsFormGroup"],["formControlName","checker",1,"card-span",3,"operation","operationDefinition","readonly","remove"],[1,"card-span"],["vdrDropdownTrigger","",1,"btn","btn-outline"],["shape","plus"],["vdrPosition","bottom-left"],["type","button","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["type","button","vdrDropdownItem","",3,"click"],["formControlName","calculator",1,"card-span",3,"operation","operationDefinition","readonly","remove"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(a){return t.setLanguage(a)}),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e.qZA()(),e.TgZ(7,"vdr-ab-right"),e._UZ(8,"vdr-action-bar-items",1),e.YNc(9,Xi,3,4,"button",2),e.ALo(10,"async"),e.YNc(11,ea,1,1,"ng-template",null,3,e.W1O),e.qZA()()(),e.TgZ(13,"form",4)(14,"vdr-page-detail-layout")(15,"vdr-page-detail-sidebar"),e.YNc(16,ta,2,1,"vdr-card",5),e.ALo(17,"async"),e.qZA(),e.TgZ(18,"vdr-page-block")(19,"vdr-card")(20,"div",6)(21,"vdr-form-field",7),e.ALo(22,"translate"),e.TgZ(23,"input",8),e.NdJ("input",function(a){return t.updateCode(null==t.entity?null:t.entity.code,a.target.value)}),e.ALo(24,"hasPermission"),e.qZA()(),e.TgZ(25,"vdr-form-field",9),e.ALo(26,"translate"),e.ALo(27,"hasPermission"),e._UZ(28,"input",10),e.ALo(29,"hasPermission"),e.qZA(),e._UZ(30,"vdr-rich-text-editor",11),e.ALo(31,"hasPermission"),e.ALo(32,"translate"),e.TgZ(33,"vdr-form-field",12),e.ALo(34,"translate"),e.TgZ(35,"select",13),e.ALo(36,"hasPermission"),e.YNc(37,na,2,3,"option",14),e.qZA()()()(),e.YNc(38,oa,3,5,"vdr-card",15),e._UZ(39,"vdr-custom-detail-component-host",16),e.TgZ(40,"vdr-card",17),e.ALo(41,"translate"),e.YNc(42,ia,2,5,"vdr-configurable-input",18),e.YNc(43,sa,8,4,"div",19),e.qZA(),e.TgZ(44,"vdr-card",17),e.ALo(45,"translate"),e.YNc(46,ra,2,5,"vdr-configurable-input",20),e.YNc(47,ca,8,4,"div",19),e.qZA(),e.TgZ(48,"vdr-card",17),e.ALo(49,"translate"),e.TgZ(50,"vdr-test-order-builder",21),e.NdJ("orderLinesChange",function(a){return t.setTestOrderLines(a)}),e.qZA(),e.TgZ(51,"vdr-test-address-form",22),e.NdJ("addressChange",function(a){return t.setTestAddress(a)}),e.qZA(),e.TgZ(52,"vdr-shipping-method-test-result",23),e.NdJ("runTest",function(){return t.runTest()}),e.ALo(53,"async"),e.ALo(54,"async"),e.qZA()()()()()),2&n){const i=e.MAs(12);let a;e.xp6(3),e.Q6J("disabled",e.lcZ(4,31,t.isNew$))("availableLanguageCodes",e.lcZ(5,33,t.availableLanguages$))("currentLanguageCode",e.lcZ(6,35,t.languageCode$)),e.xp6(6),e.Q6J("ngIf",e.lcZ(10,37,t.isNew$))("ngIfElse",i),e.xp6(4),e.Q6J("formGroup",t.detailForm),e.xp6(3),e.Q6J("ngIf",e.lcZ(17,39,t.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(22,41,"common.name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(24,43,t.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(26,45,"common.code"))("readOnlyToggle",e.lcZ(27,47,t.updatePermission)),e.xp6(3),e.Q6J("readonly",!e.lcZ(29,49,t.updatePermission)),e.xp6(2),e.Q6J("readonly",!e.lcZ(31,51,t.updatePermission))("label",e.lcZ(32,53,"common.description")),e.xp6(3),e.Q6J("label",e.lcZ(34,55,"settings.fulfillment-handler")),e.xp6(2),e.Q6J("vdrDisabled",!e.lcZ(36,57,t.updatePermission)),e.xp6(2),e.Q6J("ngForOf",t.fulfillmentHandlers),e.xp6(1),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm),e.xp6(1),e.Q6J("title",e.lcZ(41,59,"settings.shipping-eligibility-checker")),e.xp6(2),e.Q6J("ngIf",t.selectedChecker&&t.selectedCheckerDefinition),e.xp6(1),e.Q6J("ngIf",!t.selectedChecker||!t.selectedCheckerDefinition),e.xp6(1),e.Q6J("title",e.lcZ(45,61,"settings.shipping-calculator")),e.xp6(2),e.Q6J("ngIf",t.selectedCalculator&&t.selectedCalculatorDefinition),e.xp6(1),e.Q6J("ngIf",!t.selectedCalculator||!t.selectedCalculatorDefinition),e.xp6(1),e.Q6J("title",e.lcZ(49,63,"settings.test-shipping-method")),e.xp6(4),e.Q6J("currencyCode",null==(a=e.lcZ(53,65,t.activeChannel$))?null:a.currencyCode)("okToRun",t.allTestDataPresent()&&t.testDataUpdated&&t.detailForm.valid)("testDataUpdated",t.testDataUpdated)("testResult",e.lcZ(54,67,t.testResult$))}},dependencies:[g.qvL,u.sg,u.O5,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.sg,r.u,r.x0,p.Kk,p.BN,p.mz,ze.q,x.h,A.y,j.S,Ve.Y,Ke.J,Xe.N,We.U,et.H,T.H,Z.W,Y.x,S.y,q.C,v.z,M.D,Q.T,U.W,F.A,H,z,_e,u.Ov,h.X$,O.j],changeDetection:0});const lt=(0,s.wwB)({location:"shipping-method-list",requiresPermission:o=>o.includes(s.y3$.DeleteShippingMethod),getItemName:o=>o.name,bulkDelete:(o,n)=>o.shippingMethod.deleteShippingMethods(n).pipe((0,b.U)(t=>t.deleteShippingMethods))}),ct=(f.Ps`
    mutation AssignShippingMethodsToChannel($input: AssignShippingMethodsToChannelInput!) {
        assignShippingMethodsToChannel(input: $input) {
            id
            name
        }
    }
`,f.Ps`
    mutation RemoveShippingMethodsFromChannel($input: RemoveShippingMethodsFromChannelInput!) {
        removeShippingMethodsFromChannel(input: $input) {
            id
            name
        }
    }
`,(0,s.z1G)({location:"shipping-method-list",requiresPermission:o=>o.includes(s.y3$.UpdateShippingMethod)||o.includes(s.y3$.UpdateSettings),getItemName:o=>o.name,bulkAssignToChannel:(o,n,t)=>o.mutate(s.pnb,{input:{channelId:t,shippingMethodIds:n}}).pipe((0,b.U)(i=>i.assignShippingMethodsToChannel))})),dt=(0,s.RBx)({location:"shipping-method-list",requiresPermission:o=>o.includes(s.y3$.DeleteShippingMethod)||o.includes(s.y3$.DeleteSettings),getItemName:o=>o.name,bulkRemoveFromChannel:(o,n,t)=>o.mutate(s.Yau,{input:{channelId:t,shippingMethodIds:n}}).pipe((0,b.U)(i=>i.removeShippingMethodsFromChannel))}),ma=function(){return["./","create"]};function ua(o,n){1&o&&(e.TgZ(0,"a",12),e._UZ(1,"clr-icon",13),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,ma)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"settings.create-new-shipping-method")," "))}function pa(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function ga(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function ha(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const _a=function(o){return["./",o]};function fa(o,n){if(1&o&&(e.TgZ(0,"a",14)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",15),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,_a,t.id)),e.xp6(2),e.Oqu(t.name)}}function Ca(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.code," ")}}function va(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.description," ")}}function ba(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.fulfillmentHandlerCode," ")}}function Za(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",16),2&o){const t=n.$implicit,i=e.oxw();e.Q6J("customField",t)("sorts",i.sorts)}}const Ta=function(){return["CreateSettings","CreateShippingMethod"]},ya=f.Ps`
    query GetShippingMethodList($options: ShippingMethodListOptions) {
        shippingMethods(options: $options) {
            items {
                ...ShippingMethodListItem
            }
            totalItems
        }
    }
    fragment ShippingMethodListItem on ShippingMethod {
        id
        createdAt
        updatedAt
        code
        name
        description
        fulfillmentHandlerCode
    }
`;class Ce extends s.$ms{constructor(){super(),this.customFields=this.getCustomFieldConfig("ShippingMethod"),this.filters=this.createFilterCollection().addDateFilters().addFilter({name:"name",type:{kind:"text"},label:(0,l.J)("common.name"),filterField:"name"}).addFilter({name:"code",type:{kind:"text"},label:(0,l.J)("common.code"),filterField:"code"}).addFilter({name:"description",type:{kind:"text"},label:(0,l.J)("common.description"),filterField:"description"}).addFilter({name:"fulfillmentHandler",type:{kind:"text"},label:(0,l.J)("settings.fulfillment-handler"),filterField:"fulfillmentHandlerCode"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"name"}).addSort({name:"code"}).addSort({name:"description"}).addSort({name:"fulfillmentHandlerCode"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:s.Gog,getItems:n=>n.shippingMethods,setVariables:(n,t)=>({options:{skip:n,take:t,filter:{name:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}}function Aa(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",!t.saveButtonEnabled()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function La(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",!t.saveButtonEnabled()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function xa(o,n){if(1&o&&e.YNc(0,La,3,4,"button",13),2&o){const t=e.oxw();e.Q6J("vdrIfPermissions",t.updatePermission)}}function Fa(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",14),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function Ja(o,n){if(1&o&&(e.TgZ(0,"vdr-card",15),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",16),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))}}Ce.\u0275fac=function(n){return new(n||Ce)},Ce.\u0275cmp=e.Xpm({type:Ce,selectors:[["vdr-shipping-method-list"]],features:[e.qOj],decls:39,vars:60,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","shipping-method-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],["id","shipping-method-list",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","shipping-method-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault"],[3,"heading","hiddenByDefault","sort"],[3,"heading","optional","sort"],[3,"heading","sort"],[3,"heading","sort","hiddenByDefault"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"customField","sorts"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(a){return t.setLanguage(a)}),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()(),e.TgZ(6,"vdr-ab-right"),e._UZ(7,"vdr-action-bar-items",1),e.YNc(8,ua,4,5,"a",2),e.qZA()()(),e.TgZ(9,"vdr-data-table-2",3),e.NdJ("pageChange",function(a){return t.setPageNumber(a)})("itemsPerPageChange",function(a){return t.setItemsPerPage(a)}),e.ALo(10,"async"),e.ALo(11,"async"),e.ALo(12,"async"),e.ALo(13,"async"),e._UZ(14,"vdr-bulk-action-menu",4)(15,"vdr-dt2-search",5),e.ALo(16,"translate"),e.TgZ(17,"vdr-dt2-column",6),e.ALo(18,"translate"),e.YNc(19,pa,1,1,"ng-template"),e.qZA(),e.TgZ(20,"vdr-dt2-column",7),e.ALo(21,"translate"),e.YNc(22,ga,2,4,"ng-template"),e.qZA(),e.TgZ(23,"vdr-dt2-column",7),e.ALo(24,"translate"),e.YNc(25,ha,2,4,"ng-template"),e.qZA(),e.TgZ(26,"vdr-dt2-column",8),e.ALo(27,"translate"),e.YNc(28,fa,4,4,"ng-template"),e.qZA(),e.TgZ(29,"vdr-dt2-column",9),e.ALo(30,"translate"),e.YNc(31,Ca,1,1,"ng-template"),e.qZA(),e.TgZ(32,"vdr-dt2-column",10),e.ALo(33,"translate"),e.YNc(34,va,1,1,"ng-template"),e.qZA(),e.TgZ(35,"vdr-dt2-column",9),e.ALo(36,"translate"),e.YNc(37,ba,1,1,"ng-template"),e.qZA(),e.YNc(38,Za,1,2,"vdr-dt2-custom-field-column",11),e.qZA()),2&n&&(e.xp6(3),e.Q6J("availableLanguageCodes",e.lcZ(4,31,t.availableLanguages$))("currentLanguageCode",e.lcZ(5,33,t.contentLanguage$)),e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(59,Ta)),e.xp6(1),e.Q6J("items",e.lcZ(10,35,t.items$))("itemsPerPage",e.lcZ(11,37,t.itemsPerPage$))("totalItems",e.lcZ(12,39,t.totalItems$))("currentPage",e.lcZ(13,41,t.currentPage$))("filters",t.filters),e.xp6(5),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(16,43,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(18,45,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(21,47,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(24,49,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(27,51,"common.name"))("optional",!1)("sort",t.sorts.get("name")),e.xp6(3),e.Q6J("heading",e.lcZ(30,53,"common.code"))("sort",t.sorts.get("code")),e.xp6(3),e.Q6J("heading",e.lcZ(33,55,"common.description"))("sort",t.sorts.get("description"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(36,57,"settings.fulfillment-handler"))("sort",t.sorts.get("fulfillmentHandlerCode")),e.xp6(3),e.Q6J("ngForOf",t.customFields))},dependencies:[g.qvL,u.sg,y.rH,p.Kk,p.BN,p.mz,j.S,T.H,Z.W,I.c,P.e,D.U,k.J,R.j,v.z,u.Ov,h.X$,N.H],changeDetection:0});const Ia=f.Ps`
    query GetTaxCategoryDetail($id: ID!) {
        taxCategory(id: $id) {
            ...TaxCategory
        }
    }
    ${s.pIN}
`;class ve extends s.VE7{constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.customFields=this.getCustomFieldConfig("TaxCategory"),this.detailForm=this.formBuilder.group({name:["",r.kI.required],isDefault:!1,customFields:this.formBuilder.group(this.customFields.reduce((c,m)=>({...c,[m.name]:""}),{}))}),this.updatePermission=[s.y3$.UpdateSettings,s.y3$.UpdateTaxCategory]}ngOnInit(){this.init()}ngOnDestroy(){this.destroy()}saveButtonEnabled(){return this.detailForm.dirty&&this.detailForm.valid}create(){if(!this.detailForm.dirty)return;const n=this.detailForm.value,t={name:n.name,isDefault:n.isDefault,customFields:n.customFields};this.dataService.settings.createTaxCategory(t).subscribe(i=>{this.notificationService.success((0,l.J)("common.notify-create-success"),{entity:"TaxCategory"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",i.createTaxCategory.id],{relativeTo:this.route})},i=>{this.notificationService.error((0,l.J)("common.notify-create-error"),{entity:"TaxCategory"})})}save(){if(!this.detailForm.dirty)return;const n=this.detailForm.value;this.entity$.pipe((0,J.q)(1),(0,L.z)(t=>{const i={id:t.id,name:n.name,isDefault:n.isDefault,customFields:n.customFields};return this.dataService.settings.updateTaxCategory(i)})).subscribe(t=>{this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"TaxCategory"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},t=>{this.notificationService.error((0,l.J)("common.notify-update-error"),{entity:"TaxCategory"})})}setFormValues(n,t){this.detailForm.patchValue({name:n.name,isDefault:n.isDefault}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get("customFields"),n)}}ve.\u0275fac=function(n){return new(n||ve)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},ve.\u0275cmp=e.Xpm({type:ve,selectors:[["vdr-tax-detail"]],features:[e.qOj],decls:28,vars:23,consts:[["locationId","tax-category-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],[4,"ngIf"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["for","isDefault",3,"label"],["type","checkbox","clrToggle","","id","isDefault","formControlName","isDefault",3,"vdrDisabled"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","tax-category-detail",3,"entity$","detailForm"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],["formGroupName","customFields",3,"title"],["entityName","TaxCategory",3,"customFields","customFieldsFormGroup"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,Aa,3,4,"button",1),e.ALo(6,"async"),e.YNc(7,xa,1,1,"ng-template",null,2,e.W1O),e.qZA()()(),e.TgZ(9,"form",3)(10,"vdr-page-detail-layout")(11,"vdr-page-detail-sidebar"),e.YNc(12,Fa,2,1,"vdr-card",4),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"vdr-page-block")(15,"vdr-card")(16,"div",5)(17,"vdr-form-field",6),e.ALo(18,"translate"),e._UZ(19,"input",7),e.ALo(20,"hasPermission"),e.qZA(),e.TgZ(21,"vdr-form-field",8),e.ALo(22,"translate"),e.TgZ(23,"clr-toggle-wrapper"),e._UZ(24,"input",9),e.ALo(25,"hasPermission"),e.qZA()()()(),e.YNc(26,Ja,3,5,"vdr-card",10),e._UZ(27,"vdr-custom-detail-component-host",11),e.qZA()()()),2&n){const i=e.MAs(8);e.xp6(5),e.Q6J("ngIf",e.lcZ(6,11,t.isNew$))("ngIfElse",i),e.xp6(4),e.Q6J("formGroup",t.detailForm),e.xp6(3),e.Q6J("ngIf",e.lcZ(13,13,t.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(18,15,"common.name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(20,17,t.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(22,19,"common.default-tax-category")),e.xp6(3),e.Q6J("vdrDisabled",!e.lcZ(25,21,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm)}},dependencies:[g.KKC,g.PEh,u.O5,r._Y,r.Fj,r.Wl,r.JJ,r.JL,r.sg,r.u,r.x0,p.Kk,p.BN,p.mz,x.h,A.y,T.H,Z.W,Y.x,S.y,q.C,v.z,M.D,Q.T,U.W,F.A,u.Ov,h.X$,O.j],changeDetection:0});const mt=(0,s.wwB)({location:"tax-category-list",requiresPermission:o=>o.includes(s.y3$.DeleteSettings)||o.includes(s.y3$.DeleteTaxCategory),getItemName:o=>o.name,bulkDelete:(o,n)=>o.settings.deleteTaxCategories(n).pipe((0,b.U)(t=>t.deleteTaxCategories))}),Pa=function(){return["./","create"]};function Da(o,n){1&o&&(e.TgZ(0,"a",10),e._UZ(1,"clr-icon",11),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,Pa)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"settings.create-new-tax-category")," "))}function ka(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function Na(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function Sa(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const qa=function(o){return["./",o]};function Ma(o,n){if(1&o&&(e.TgZ(0,"a",12)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",13),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,qa,t.id)),e.xp6(2),e.Oqu(t.name)}}function Qa(o,n){1&o&&(e.TgZ(0,"vdr-chip"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.default-tax-category")))}function Ua(o,n){if(1&o&&e.YNc(0,Qa,3,3,"vdr-chip",14),2&o){const t=n.item;e.Q6J("ngIf",t.isDefault)}}function Oa(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",15),2&o){const t=n.$implicit,i=e.oxw();e.Q6J("customField",t)("sorts",i.sorts)}}const $a=function(){return["CreateSettings","CreateTaxCategory"]},Ra=f.Ps`
    query GetTaxCategoryList($options: TaxCategoryListOptions) {
        taxCategories(options: $options) {
            items {
                ...TaxCategory
            }
            totalItems
        }
    }
    ${s.pIN}
`;class be extends s.$ms{constructor(){super(),this.customFields=this.serverConfigService.getCustomFieldsFor("TaxCategory"),this.filters=this.createFilterCollection().addFilter({name:"name",type:{kind:"text"},label:(0,l.J)("common.name"),filterField:"name"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"name"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:s.YJM,getItems:n=>n.taxCategories,setVariables:(n,t)=>({options:{skip:n,take:t,filter:{name:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}}be.\u0275fac=function(n){return new(n||be)},be.\u0275cmp=e.Xpm({type:be,selectors:[["vdr-tax-list"]],features:[e.qOj],decls:30,vars:44,consts:[["locationId","tax-category-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],["id","tax-category-list",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","tax-category-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault"],[3,"heading","hiddenByDefault","sort"],[3,"heading","optional","sort"],[3,"heading"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[4,"ngIf"],[3,"customField","sorts"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,Da,4,5,"a",1),e.qZA()()(),e.TgZ(6,"vdr-data-table-2",2),e.NdJ("pageChange",function(a){return t.setPageNumber(a)})("itemsPerPageChange",function(a){return t.setItemsPerPage(a)}),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"async"),e.ALo(10,"async"),e._UZ(11,"vdr-bulk-action-menu",3)(12,"vdr-dt2-search",4),e.ALo(13,"translate"),e.TgZ(14,"vdr-dt2-column",5),e.ALo(15,"translate"),e.YNc(16,ka,1,1,"ng-template"),e.qZA(),e.TgZ(17,"vdr-dt2-column",6),e.ALo(18,"translate"),e.YNc(19,Na,2,4,"ng-template"),e.qZA(),e.TgZ(20,"vdr-dt2-column",6),e.ALo(21,"translate"),e.YNc(22,Sa,2,4,"ng-template"),e.qZA(),e.TgZ(23,"vdr-dt2-column",7),e.ALo(24,"translate"),e.YNc(25,Ma,4,4,"ng-template"),e.qZA(),e.TgZ(26,"vdr-dt2-column",8),e.ALo(27,"translate"),e.YNc(28,Ua,1,1,"ng-template"),e.qZA(),e.YNc(29,Oa,1,2,"vdr-dt2-custom-field-column",9),e.qZA()),2&n&&(e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(43,$a)),e.xp6(1),e.Q6J("items",e.lcZ(7,23,t.items$))("itemsPerPage",e.lcZ(8,25,t.itemsPerPage$))("totalItems",e.lcZ(9,27,t.totalItems$))("currentPage",e.lcZ(10,29,t.currentPage$))("filters",t.filters),e.xp6(5),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(13,31,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(15,33,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(18,35,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(21,37,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(24,39,"common.name"))("optional",!1)("sort",t.sorts.get("name")),e.xp6(3),e.Q6J("heading",e.lcZ(27,41,"common.default-tax-category")),e.xp6(3),e.Q6J("ngForOf",t.customFields))},dependencies:[g.qvL,u.sg,u.O5,y.rH,p.Kk,p.BN,p.mz,E.Y,T.H,Z.W,I.c,P.e,D.U,k.J,R.j,v.z,u.Ov,h.X$,N.H],changeDetection:0});var wa=d(4712);function Ya(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",!t.saveButtonEnabled()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function Ea(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",!t.saveButtonEnabled()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function Ga(o,n){if(1&o&&e.YNc(0,Ea,3,4,"button",21),2&o){const t=e.oxw();e.Q6J("vdrIfPermissions",t.updatePermission)}}function Ba(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",22),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function ja(o,n){if(1&o&&(e.TgZ(0,"option",23),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function Ha(o,n){if(1&o&&(e.TgZ(0,"vdr-card",24),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",25),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))}}const za=f.Ps`
    query GetTaxRateDetail($id: ID!) {
        taxRate(id: $id) {
            ...TaxRate
        }
    }
    ${s.vC1}
`;class Ze extends s.VE7{constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.customFields=this.getCustomFieldConfig("TaxRate"),this.detailForm=this.formBuilder.group({name:["",r.kI.required],enabled:[!0],value:[0,r.kI.required],taxCategoryId:["",r.kI.required],zoneId:["",r.kI.required],customerGroupId:[""],customFields:this.formBuilder.group(this.customFields.reduce((c,m)=>({...c,[m.name]:""}),{}))}),this.updatePermission=[s.y3$.UpdateSettings,s.y3$.UpdateTaxRate]}ngOnInit(){this.init(),this.taxCategories$=this.dataService.settings.getTaxCategories({take:100}).mapSingle(n=>n.taxCategories.items)}ngOnDestroy(){this.destroy()}saveButtonEnabled(){return this.detailForm.dirty&&this.detailForm.valid}create(){if(!this.detailForm.dirty)return;const{name:n,enabled:t,value:i,taxCategoryId:a,zoneId:c,customerGroupId:m,customFields:C}=this.detailForm.value;if(!(n&&null!=t&&i&&a&&c))return;const _=this.detailForm.value,$={name:n,enabled:t,value:i,categoryId:a,zoneId:c,customerGroupId:_.customerGroupId,customFields:_.customFields};this.dataService.settings.createTaxRate($).subscribe(Ne=>{this.notificationService.success((0,l.J)("common.notify-create-success"),{entity:"TaxRate"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",Ne.createTaxRate.id],{relativeTo:this.route})},Ne=>{this.notificationService.error((0,l.J)("common.notify-create-error"),{entity:"TaxRate"})})}save(){if(!this.detailForm.dirty)return;const n=this.detailForm.value;this.entity$.pipe((0,J.q)(1),(0,L.z)(t=>{const i={id:t.id,name:n.name,enabled:n.enabled,value:n.value,categoryId:n.taxCategoryId,zoneId:n.zoneId,customerGroupId:n.customerGroupId,customFields:n.customFields};return this.dataService.settings.updateTaxRate(i)})).subscribe(t=>{this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"TaxRate"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},t=>{this.notificationService.error((0,l.J)("common.notify-update-error"),{entity:"TaxRate"})})}setFormValues(n,t){this.detailForm.patchValue({name:n.name,enabled:n.enabled,value:n.value,taxCategoryId:n.category?n.category.id:"",zoneId:n.zone?n.zone.id:"",customerGroupId:n.customerGroup?n.customerGroup.id:""}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get("customFields"),n)}}Ze.\u0275fac=function(n){return new(n||Ze)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},Ze.\u0275cmp=e.Xpm({type:Ze,selectors:[["vdr-tax-rate-detail"]],features:[e.qOj],decls:44,vars:44,consts:[["locationId","tax-rate-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","enabled",3,"label"],["type","checkbox","clrToggle","","id","enabled","formControlName","enabled",3,"vdrDisabled"],[4,"ngIf"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["for","value",3,"label"],["suffix","%"],["id","value","type","number","step","0.1","formControlName","value",3,"readonly"],["for","taxCategoryId",3,"label"],["name","taxCategoryId","formControlName","taxCategoryId",3,"vdrDisabled"],[3,"value",4,"ngFor","ngForOf"],["for","zoneId",3,"label"],["name","zoneId","formControlName","zoneId",3,"vdrDisabled"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","tax-rate-detail",3,"entity$","detailForm"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],[3,"value"],["formGroupName","customFields",3,"title"],["entityName","TaxRate",3,"customFields","customFieldsFormGroup"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,Ya,3,4,"button",1),e.ALo(6,"async"),e.YNc(7,Ga,1,1,"ng-template",null,2,e.W1O),e.qZA()()(),e.TgZ(9,"form",3)(10,"vdr-page-detail-layout")(11,"vdr-page-detail-sidebar")(12,"vdr-card")(13,"vdr-form-field",4),e.ALo(14,"translate"),e.TgZ(15,"clr-toggle-wrapper"),e._UZ(16,"input",5),e.ALo(17,"hasPermission"),e.qZA()()(),e.YNc(18,Ba,2,1,"vdr-card",6),e.ALo(19,"async"),e.qZA(),e.TgZ(20,"vdr-page-block")(21,"vdr-card")(22,"div",7)(23,"vdr-form-field",8),e.ALo(24,"translate"),e._UZ(25,"input",9),e.ALo(26,"hasPermission"),e.qZA(),e.TgZ(27,"vdr-form-field",10),e.ALo(28,"translate"),e.TgZ(29,"vdr-affixed-input",11),e._UZ(30,"input",12),e.ALo(31,"hasPermission"),e.qZA()(),e.TgZ(32,"vdr-form-field",13),e.ALo(33,"translate"),e.TgZ(34,"select",14),e.ALo(35,"hasPermission"),e.YNc(36,ja,2,2,"option",15),e.ALo(37,"async"),e.qZA()(),e.TgZ(38,"vdr-form-field",16),e.ALo(39,"translate"),e._UZ(40,"vdr-zone-selector",17),e.ALo(41,"hasPermission"),e.qZA()()(),e.YNc(42,Ha,3,5,"vdr-card",18),e._UZ(43,"vdr-custom-detail-component-host",19),e.qZA()()()),2&n){const i=e.MAs(8);e.xp6(5),e.Q6J("ngIf",e.lcZ(6,18,t.isNew$))("ngIfElse",i),e.xp6(4),e.Q6J("formGroup",t.detailForm),e.xp6(4),e.Q6J("label",e.lcZ(14,20,"common.enabled")),e.xp6(3),e.Q6J("vdrDisabled",!e.lcZ(17,22,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",e.lcZ(19,24,t.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(24,26,"common.name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(26,28,t.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(28,30,"settings.rate")),e.xp6(3),e.Q6J("readonly",!e.lcZ(31,32,t.updatePermission)),e.xp6(2),e.Q6J("label",e.lcZ(33,34,"settings.tax-category")),e.xp6(2),e.Q6J("vdrDisabled",!e.lcZ(35,36,t.updatePermission)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(37,38,t.taxCategories$)),e.xp6(2),e.Q6J("label",e.lcZ(39,40,"settings.zone")),e.xp6(2),e.Q6J("vdrDisabled",!e.lcZ(41,42,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm)}},dependencies:[g.KKC,g.PEh,u.sg,u.O5,r._Y,r.YN,r.Kr,r.Fj,r.wV,r.Wl,r.EJ,r.JJ,r.JL,r.sg,r.u,r.x0,p.Kk,p.BN,p.mz,wa.K,x.h,A.y,T.H,Z.W,Y.x,S.y,q.C,v.z,M.D,Q.T,U.W,F.A,Ee.A,u.Ov,h.X$,O.j],changeDetection:0});const ut=(0,s.wwB)({location:"tax-rate-list",requiresPermission:o=>o.includes(s.y3$.DeleteSettings)||o.includes(s.y3$.DeleteTaxRate),getItemName:o=>o.name,bulkDelete:(o,n)=>o.settings.deleteTaxRates(n).pipe((0,b.U)(t=>t.deleteTaxRates))}),Va=function(){return["./","create"]};function Ka(o,n){1&o&&(e.TgZ(0,"a",11),e._UZ(1,"clr-icon",12),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,Va)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"settings.create-new-tax-rate")," "))}function Xa(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function Wa(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function es(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const ts=function(o){return["./",o]};function ns(o,n){if(1&o&&(e.TgZ(0,"a",13)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",14),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,ts,t.id)),e.xp6(2),e.Oqu(t.name)}}function os(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.category.name," ")}}function is(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.zone.name," ")}}function as(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",null==t.customerGroup?null:t.customerGroup.name," ")}}function ss(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.value,"% ")}}function rs(o,n){1&o&&(e.TgZ(0,"vdr-chip",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.enabled")))}function ls(o,n){1&o&&(e.TgZ(0,"vdr-chip",18),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"common.disabled")))}function cs(o,n){if(1&o&&(e.YNc(0,rs,3,3,"vdr-chip",15),e.YNc(1,ls,3,3,"vdr-chip",16)),2&o){const t=n.item;e.Q6J("ngIf",t.enabled),e.xp6(1),e.Q6J("ngIf",!t.enabled)}}function ds(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",19),2&o){const t=n.$implicit,i=e.oxw();e.Q6J("customField",t)("sorts",i.sorts)}}const ms=function(){return["CreateSettings","CreateTaxRate"]},us=f.Ps`
    query GetTaxRateList($options: TaxRateListOptions) {
        taxRates(options: $options) {
            items {
                ...TaxRate
            }
            totalItems
        }
    }
    ${s.vC1}
`;class Te extends s.$ms{constructor(){super(),this.customFields=this.getCustomFieldConfig("TaxRate"),this.filters=this.createFilterCollection().addDateFilters().addFilter({name:"name",type:{kind:"text"},label:(0,l.J)("common.name"),filterField:"name"}).addFilter({name:"enabled",type:{kind:"boolean"},label:(0,l.J)("common.enabled"),filterField:"enabled"}).addFilter({name:"value",type:{kind:"number"},label:(0,l.J)("common.value"),filterField:"value"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"name"}).addSort({name:"value"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:s.Gah,getItems:n=>n.taxRates,setVariables:(n,t)=>({options:{skip:n,take:t,filter:{name:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}}Te.\u0275fac=function(n){return new(n||Te)},Te.\u0275cmp=e.Xpm({type:Te,selectors:[["vdr-tax-rate-list"]],features:[e.qOj],decls:42,vars:58,consts:[["locationId","tax-rate-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],["id","tax-rate-list",3,"items","itemsPerPage","totalItems","currentPage","filters","pageChange","itemsPerPageChange"],["locationId","tax-rate-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault"],[3,"heading","hiddenByDefault","sort"],[3,"heading","optional","sort"],[3,"heading"],[3,"heading","sort"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],["colorType","success",4,"ngIf"],["colorType","warning",4,"ngIf"],["colorType","success"],["colorType","warning"],[3,"customField","sorts"]],template:function(n,t){1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,Ka,4,5,"a",1),e.qZA()()(),e.TgZ(6,"vdr-data-table-2",2),e.NdJ("pageChange",function(a){return t.setPageNumber(a)})("itemsPerPageChange",function(a){return t.setItemsPerPage(a)}),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"async"),e.ALo(10,"async"),e._UZ(11,"vdr-bulk-action-menu",3)(12,"vdr-dt2-search",4),e.ALo(13,"translate"),e.TgZ(14,"vdr-dt2-column",5),e.ALo(15,"translate"),e.YNc(16,Xa,1,1,"ng-template"),e.qZA(),e.TgZ(17,"vdr-dt2-column",6),e.ALo(18,"translate"),e.YNc(19,Wa,2,4,"ng-template"),e.qZA(),e.TgZ(20,"vdr-dt2-column",6),e.ALo(21,"translate"),e.YNc(22,es,2,4,"ng-template"),e.qZA(),e.TgZ(23,"vdr-dt2-column",7),e.ALo(24,"translate"),e.YNc(25,ns,4,4,"ng-template"),e.qZA(),e.TgZ(26,"vdr-dt2-column",8),e.ALo(27,"translate"),e.YNc(28,os,1,1,"ng-template"),e.qZA(),e.TgZ(29,"vdr-dt2-column",8),e.ALo(30,"translate"),e.YNc(31,is,1,1,"ng-template"),e.qZA(),e.TgZ(32,"vdr-dt2-column",5),e.ALo(33,"translate"),e.YNc(34,as,1,1,"ng-template"),e.qZA(),e.TgZ(35,"vdr-dt2-column",9),e.ALo(36,"translate"),e.YNc(37,ss,1,1,"ng-template"),e.qZA(),e.TgZ(38,"vdr-dt2-column",8),e.ALo(39,"translate"),e.YNc(40,cs,2,2,"ng-template"),e.qZA(),e.YNc(41,ds,1,2,"vdr-dt2-custom-field-column",10),e.qZA()),2&n&&(e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(57,ms)),e.xp6(1),e.Q6J("items",e.lcZ(7,29,t.items$))("itemsPerPage",e.lcZ(8,31,t.itemsPerPage$))("totalItems",e.lcZ(9,33,t.totalItems$))("currentPage",e.lcZ(10,35,t.currentPage$))("filters",t.filters),e.xp6(5),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(13,37,"catalog.filter-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(15,39,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(18,41,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(21,43,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(24,45,"common.name"))("optional",!1)("sort",t.sorts.get("name")),e.xp6(3),e.Q6J("heading",e.lcZ(27,47,"settings.tax-category")),e.xp6(3),e.Q6J("heading",e.lcZ(30,49,"settings.zone")),e.xp6(3),e.Q6J("heading",e.lcZ(33,51,"customer.customer-group"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(36,53,"settings.tax-rate"))("sort",t.sorts.get("value")),e.xp6(3),e.Q6J("heading",e.lcZ(39,55,"common.enabled")),e.xp6(3),e.Q6J("ngForOf",t.customFields))},dependencies:[g.qvL,u.sg,u.O5,y.rH,p.Kk,p.BN,p.mz,E.Y,T.H,Z.W,I.c,P.e,D.U,k.J,R.j,v.z,u.Ov,h.X$,N.H],changeDetection:0});class ye{constructor(n){this.dataService=n,this.testDataUpdated=!1,this.fetchTestResult$=new Je.x}ngOnInit(){this.activeChannel$=this.dataService.settings.getActiveChannel().mapStream(n=>n.activeChannel),this.testResult$=this.fetchTestResult$.pipe((0,Ie.w)(([n,t])=>{const i={shippingAddress:{...n,streetLine1:"test"},lines:t.map(a=>({productVariantId:a.id,quantity:a.quantity}))};return this.dataService.shippingMethod.testEligibleShippingMethods(i).mapSingle(a=>a.testEligibleShippingMethods)}))}setTestOrderLines(n){this.testOrderLines=n,this.testDataUpdated=!0}setTestAddress(n){this.testAddress=n,this.testDataUpdated=!0}allTestDataPresent(){return!!(this.testAddress&&this.testOrderLines&&this.testOrderLines.length)}runTest(){this.fetchTestResult$.next([this.testAddress,this.testOrderLines]),this.testDataUpdated=!1}}function ps(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",!t.saveButtonEnabled()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.create")," ")}}function gs(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",!t.saveButtonEnabled()),e.xp6(1),e.hij(" ",e.lcZ(2,2,"common.update")," ")}}function hs(o,n){if(1&o&&e.YNc(0,gs,3,4,"button",11),2&o){const t=e.oxw();e.Q6J("vdrIfPermissions",t.updatePermission)}}function _s(o,n){if(1&o&&(e.TgZ(0,"vdr-card"),e._UZ(1,"vdr-page-entity-info",12),e.qZA()),2&o){const t=n.ngIf;e.xp6(1),e.Q6J("entity",t)}}function fs(o,n){if(1&o&&(e.TgZ(0,"vdr-card",13),e.ALo(1,"translate"),e._UZ(2,"vdr-tabbed-custom-fields",14),e.qZA()),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,3,"common.custom-fields")),e.xp6(2),e.Q6J("customFields",t.customFields)("customFieldsFormGroup",t.detailForm.get("customFields"))}}ye.\u0275fac=function(n){return new(n||ye)(e.Y36(s.DoR))},ye.\u0275cmp=e.Xpm({type:ye,selectors:[["vdr-test-shipping-methods"]],decls:9,vars:8,consts:[[1,"test-wrapper"],[1,""],[3,"orderLinesChange"],[3,"addressChange"],[1,"mt-1",3,"currencyCode","okToRun","testDataUpdated","testResult","runTest"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"div",0)(2,"div",1)(3,"vdr-test-order-builder",2),e.NdJ("orderLinesChange",function(a){return t.setTestOrderLines(a)}),e.qZA()(),e.TgZ(4,"div",1)(5,"vdr-test-address-form",3),e.NdJ("addressChange",function(a){return t.setTestAddress(a)}),e.qZA(),e.TgZ(6,"vdr-shipping-eligibility-test-result",4),e.NdJ("runTest",function(){return t.runTest()}),e.ALo(7,"async"),e.ALo(8,"async"),e.qZA()()()()),2&n){let i;e.xp6(6),e.Q6J("currencyCode",null==(i=e.lcZ(7,4,t.activeChannel$))?null:i.currencyCode)("okToRun",t.allTestDataPresent())("testDataUpdated",t.testDataUpdated)("testResult",e.lcZ(8,6,t.testResult$))}},dependencies:[v.z,H,z,he,u.Ov],styles:[".test-wrapper[_ngcontent-%COMP%]{display:flex;width:100%;gap:var(--space-unit)}.test-wrapper[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1}@media screen and (max-width: 992px){.test-wrapper[_ngcontent-%COMP%]{flex-direction:column}}"],changeDetection:0});const Cs=f.Ps`
    query GetZoneDetail($id: ID!) {
        zone(id: $id) {
            ...ZoneDetail
        }
    }
    fragment ZoneDetail on Zone {
        id
        createdAt
        updatedAt
        name
    }
`;class Ae extends s.VE7{constructor(n,t,i,a){super(),this.changeDetector=n,this.dataService=t,this.formBuilder=i,this.notificationService=a,this.customFields=this.getCustomFieldConfig("Zone"),this.detailForm=this.formBuilder.group({name:["",r.kI.required],customFields:this.formBuilder.group(this.customFields.reduce((c,m)=>({...c,[m.name]:""}),{}))}),this.updatePermission=[s.y3$.UpdateSettings,s.y3$.UpdateZone]}ngOnInit(){this.init()}ngOnDestroy(){this.destroy()}saveButtonEnabled(){return this.detailForm.dirty&&this.detailForm.valid}create(){if(!this.detailForm.dirty)return;const{name:n,customFields:t}=this.detailForm.value;if(!n)return;const i={name:n,customFields:t};this.dataService.settings.createZone(i).subscribe(a=>{this.notificationService.success((0,l.J)("common.notify-create-success"),{entity:"Zone"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck(),this.router.navigate(["../",a.createZone.id],{relativeTo:this.route})},a=>{this.notificationService.error((0,l.J)("common.notify-create-error"),{entity:"Zone"})})}save(){if(!this.detailForm.dirty)return;const n=this.detailForm.value;this.entity$.pipe((0,J.q)(1),(0,L.z)(t=>{const i={id:t.id,name:n.name,customFields:n.customFields};return this.dataService.settings.updateZone(i)})).subscribe(t=>{this.notificationService.success((0,l.J)("common.notify-update-success"),{entity:"Zone"}),this.detailForm.markAsPristine(),this.changeDetector.markForCheck()},t=>{this.notificationService.error((0,l.J)("common.notify-update-error"),{entity:"Zone"})})}setFormValues(n,t){this.detailForm.patchValue({name:n.name}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get("customFields"),n)}}Ae.\u0275fac=function(n){return new(n||Ae)(e.Y36(e.sBO),e.Y36(s.DoR),e.Y36(r.qu),e.Y36(s.gqp))},Ae.\u0275cmp=e.Xpm({type:Ae,selectors:[["vdr-zone-detail"]],features:[e.qOj],decls:23,vars:17,consts:[["locationId","zone-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],[4,"ngIf"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","zone-detail",3,"entity$","detailForm"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],["formGroupName","customFields",3,"title"],["entityName","Zone",3,"customFields","customFieldsFormGroup"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar"),e._UZ(2,"vdr-ab-left"),e.TgZ(3,"vdr-ab-right"),e._UZ(4,"vdr-action-bar-items",0),e.YNc(5,ps,3,4,"button",1),e.ALo(6,"async"),e.YNc(7,hs,1,1,"ng-template",null,2,e.W1O),e.qZA()()(),e.TgZ(9,"form",3)(10,"vdr-page-detail-layout")(11,"vdr-page-detail-sidebar"),e.YNc(12,_s,2,1,"vdr-card",4),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"vdr-page-block")(15,"vdr-card")(16,"div",5)(17,"vdr-form-field",6),e.ALo(18,"translate"),e._UZ(19,"input",7),e.ALo(20,"hasPermission"),e.qZA()()(),e.YNc(21,fs,3,5,"vdr-card",8),e._UZ(22,"vdr-custom-detail-component-host",9),e.qZA()()()),2&n){const i=e.MAs(8);e.xp6(5),e.Q6J("ngIf",e.lcZ(6,9,t.isNew$))("ngIfElse",i),e.xp6(4),e.Q6J("formGroup",t.detailForm),e.xp6(3),e.Q6J("ngIf",e.lcZ(13,11,t.entity$)),e.xp6(5),e.Q6J("label",e.lcZ(18,13,"common.name")),e.xp6(2),e.Q6J("readonly",!e.lcZ(20,15,t.updatePermission)),e.xp6(2),e.Q6J("ngIf",t.customFields.length),e.xp6(1),e.Q6J("entity$",t.entity$)("detailForm",t.detailForm)}},dependencies:[u.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,r.x0,p.Kk,p.BN,p.mz,x.h,A.y,T.H,Z.W,S.y,q.C,v.z,M.D,Q.T,U.W,F.A,u.Ov,h.X$,O.j],changeDetection:0});const pt=(0,s.wwB)({location:"zone-list",requiresPermission:o=>o.includes(s.y3$.DeleteSettings)||o.includes(s.y3$.DeleteZone),getItemName:o=>o.name,bulkDelete:(o,n)=>o.settings.deleteZones(n).pipe((0,b.U)(t=>t.deleteZones))});var vs=d(3618),bs=d(536),Zs=d(7284),Ts=d(1021),gt=d(3288);const ys=function(){return["./","create"]};function As(o,n){1&o&&(e.TgZ(0,"a",6),e._UZ(1,"clr-icon",7),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o&&(e.Q6J("routerLink",e.DdM(4,ys)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"settings.create-new-zone")," "))}function Ls(o,n){if(1&o&&e._uU(0),2&o){const t=n.item;e.hij(" ",t.id," ")}}function xs(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.createdAt,"short")," ")}}function Fs(o,n){if(1&o&&(e._uU(0),e.ALo(1,"localeDate")),2&o){const t=n.item;e.hij(" ",e.xi3(1,1,t.updatedAt,"short")," ")}}const ht=function(o){return["./",o]};function Js(o,n){if(1&o&&(e.TgZ(0,"a",16)(1,"span"),e._uU(2),e.qZA(),e._UZ(3,"clr-icon",17),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(2,ht,t.id)),e.xp6(2),e.Oqu(t.name)}}const Is=function(o){return{contents:o}};function Ps(o,n){if(1&o&&(e.TgZ(0,"a",18)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"clr-icon",19),e.qZA()),2&o){const t=n.item;e.Q6J("routerLink",e.VKq(6,ht,e.VKq(4,Is,t.id))),e.xp6(2),e.Oqu(e.lcZ(3,2,"settings.view-zone-members"))}}function Ds(o,n){if(1&o&&e._UZ(0,"vdr-dt2-custom-field-column",20),2&o){const t=n.$implicit,i=e.oxw(2);e.Q6J("customField",t)("sort",i.sorts)}}function ks(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-data-table-2",8),e.NdJ("pageChange",function(a){e.CHM(t);const c=e.oxw();return e.KtG(c.setPageNumber(a))})("itemsPerPageChange",function(a){e.CHM(t);const c=e.oxw();return e.KtG(c.setItemsPerPage(a))}),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e._UZ(6,"vdr-bulk-action-menu",9)(7,"vdr-dt2-search",10),e.ALo(8,"translate"),e.TgZ(9,"vdr-dt2-column",11),e.ALo(10,"translate"),e.YNc(11,Ls,1,1,"ng-template"),e.qZA(),e.TgZ(12,"vdr-dt2-column",12),e.ALo(13,"translate"),e.YNc(14,xs,2,4,"ng-template"),e.qZA(),e.TgZ(15,"vdr-dt2-column",12),e.ALo(16,"translate"),e.YNc(17,Fs,2,4,"ng-template"),e.qZA(),e.TgZ(18,"vdr-dt2-column",13),e.ALo(19,"translate"),e.YNc(20,Js,4,4,"ng-template"),e.qZA(),e.TgZ(21,"vdr-dt2-column",14),e.ALo(22,"translate"),e.YNc(23,Ps,5,8,"ng-template"),e.qZA(),e.YNc(24,Ds,1,2,"vdr-dt2-custom-field-column",15),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("items",e.lcZ(1,24,t.items$))("itemsPerPage",e.lcZ(2,26,t.itemsPerPage$))("totalItems",e.lcZ(3,28,t.totalItems$))("currentPage",e.lcZ(4,30,t.currentPage$))("filters",t.filters)("activeIndex",e.lcZ(5,32,t.activeIndex$)),e.xp6(6),e.Q6J("hostComponent",t)("selectionManager",t.selectionManager),e.xp6(1),e.Q6J("searchTermControl",t.searchTermControl)("searchTermPlaceholder",e.lcZ(8,34,"common.search-by-name")),e.xp6(2),e.Q6J("heading",e.lcZ(10,36,"common.id"))("hiddenByDefault",!0),e.xp6(3),e.Q6J("heading",e.lcZ(13,38,"common.created-at"))("hiddenByDefault",!0)("sort",t.sorts.get("createdAt")),e.xp6(3),e.Q6J("heading",e.lcZ(16,40,"common.updated-at"))("hiddenByDefault",!0)("sort",t.sorts.get("updatedAt")),e.xp6(3),e.Q6J("heading",e.lcZ(19,42,"common.name"))("optional",!1)("sort",t.sorts.get("name")),e.xp6(3),e.Q6J("heading",e.lcZ(22,44,"common.view-contents"))("optional",!1),e.xp6(3),e.Q6J("ngForOf",t.customFields)}}function Ns(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"vdr-zone-member-list",24),e.NdJ("selectionChange",function(a){e.CHM(t);const c=e.oxw(3);return e.KtG(c.selectedMemberIds=a)}),e.qZA()}if(2&o){const t=n.ngIf,i=e.oxw(3);e.Q6J("selectedMemberIds",i.selectedMemberIds)("activeZone",t)}}const Ss=function(o){return{zoneName:o}};function qs(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",22),e.NdJ("click",function(){const c=e.CHM(t).ngIf,m=e.oxw(2);return e.KtG(m.addToZone(c))}),e._UZ(2,"clr-icon",7),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.YNc(6,Ns,1,2,"vdr-zone-member-list",23),e.ALo(7,"async"),e.BQk()}if(2&o){const t=n.ngIf,i=e.oxw(2);e.xp6(4),e.Oqu(e.xi3(5,2,"settings.add-countries-to-zone",e.VKq(7,Ss,t.name))),e.xp6(2),e.Q6J("ngIf",e.lcZ(7,5,i.activeZone$))}}function Ms(o,n){if(1&o&&(e.YNc(0,qs,8,9,"ng-container",21),e.ALo(1,"async")),2&o){const t=e.oxw();e.Q6J("ngIf",e.lcZ(1,1,t.activeZone$))}}const Qs=function(){return["CreateSettings","CreateZone"]},Us=f.Ps`
    query GetZoneList($options: ZoneListOptions) {
        zones(options: $options) {
            items {
                ...ZoneListItem
            }
            totalItems
        }
    }
    fragment ZoneListItem on Zone {
        id
        createdAt
        updatedAt
        name
    }
`;class Le extends s.$ms{constructor(n,t,i){super(),this.dataService=n,this.notificationService=t,this.modalService=i,this.selectedMemberIds=[],this.customFields=this.serverConfigService.getCustomFieldsFor("Zone"),this.filters=this.createFilterCollection().addDateFilters().addFilter({name:"name",type:{kind:"text"},label:(0,l.J)("common.name"),filterField:"name"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"name"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),super.configure({document:s.xl3,getItems:a=>a.zones,setVariables:(a,c)=>({options:{skip:a,take:c,filter:{name:{contains:this.searchTermControl.value},...this.filters.createFilterInput()},filterOperator:this.searchTermControl.value?s.FnJ.OR:s.FnJ.AND,sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}ngOnInit(){super.ngOnInit();const n=this.route.paramMap.pipe((0,b.U)(t=>t.get("contents")),(0,bs.x)(),(0,He.b)(()=>this.selectedMemberIds=[]));this.activeZone$=(0,K.a)(this.items$,n).pipe((0,b.U)(([t,i])=>{if(i)return t.find(a=>a.id===i)})),this.activeIndex$=(0,K.a)(this.items$,n).pipe((0,b.U)(([t,i])=>i?t.findIndex(a=>a.id===i):-1))}setLanguage(n){this.dataService.client.setContentLanguage(n).subscribe()}closeMembers(){const n={...this.route.snapshot.params};delete n.contents,this.router.navigate(["./",n],{relativeTo:this.route,queryParamsHandling:"preserve"})}addToZone(n){this.modalService.fromComponent(ee,{locals:{zoneName:n.name,zoneId:n.id},size:"md"}).pipe((0,Ie.w)(t=>t?this.dataService.settings.addMembersToZone(n.id,t).pipe((0,Zs.h)(t)):vs.E)).subscribe({next:t=>{this.notificationService.success((0,l.J)("settings.add-countries-to-zone-success"),{countryCount:t.length,zoneName:n.name}),this.refreshMemberList()},error:t=>{this.notificationService.error(t)}})}refreshMemberList(){this.zoneMemberList?.refresh()}}Le.\u0275fac=function(n){return new(n||Le)(e.Y36(s.DoR),e.Y36(s.gqp),e.Y36(s.Z7U))},Le.\u0275cmp=e.Xpm({type:Le,selectors:[["vdr-zone-list"]],viewQuery:function(n,t){if(1&n&&e.Gf(w,5),2&n){let i;e.iGM(i=e.CRH())&&(t.zoneMemberList=i.first)}},features:[e.qOj],decls:14,vars:14,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","zone-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"rightPanelOpen","closeClicked"],["vdrSplitViewLeft",""],["vdrSplitViewRight","",3,"splitViewTitle"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],["id","zone-list",3,"items","itemsPerPage","totalItems","currentPage","filters","activeIndex","pageChange","itemsPerPageChange"],["locationId","zone-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],[3,"heading","hiddenByDefault"],[3,"heading","hiddenByDefault","sort"],[3,"heading","optional","sort"],[3,"heading","optional"],[3,"customField","sort",4,"ngFor","ngForOf"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],["queryParamsHandling","preserve",1,"button-small","bg-weight-150",3,"routerLink"],["shape","file-group"],[3,"customField","sort"],[4,"ngIf"],[1,"button-ghost","ml-4",3,"click"],["locationId","zone-members-list",3,"selectedMemberIds","activeZone","selectionChange",4,"ngIf"],["locationId","zone-members-list",3,"selectedMemberIds","activeZone","selectionChange"]],template:function(n,t){if(1&n&&(e.TgZ(0,"vdr-page-block")(1,"vdr-action-bar")(2,"vdr-ab-left")(3,"vdr-language-selector",0),e.NdJ("languageCodeChange",function(a){return t.setLanguage(a)}),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()(),e.TgZ(6,"vdr-ab-right"),e._UZ(7,"vdr-action-bar-items",1),e.YNc(8,As,4,5,"a",2),e.qZA()()(),e.TgZ(9,"vdr-split-view",3),e.NdJ("closeClicked",function(){return t.closeMembers()}),e.ALo(10,"async"),e.YNc(11,ks,25,46,"ng-template",4),e.YNc(12,Ms,2,3,"ng-template",5),e.ALo(13,"async"),e.qZA()),2&n){let i;e.xp6(3),e.Q6J("availableLanguageCodes",e.lcZ(4,5,t.availableLanguages$))("currentLanguageCode",e.lcZ(5,7,t.contentLanguage$)),e.xp6(5),e.Q6J("vdrIfPermissions",e.DdM(13,Qs)),e.xp6(1),e.Q6J("rightPanelOpen",e.lcZ(10,9,t.activeZone$)),e.xp6(3),e.Q6J("splitViewTitle",null==(i=e.lcZ(13,11,t.activeZone$))?null:i.name)}},dependencies:[g.qvL,u.sg,u.O5,y.rH,p.Kk,p.BN,p.mz,j.S,T.H,Z.W,I.c,P.e,D.U,k.J,R.j,Ts._,gt.L,gt.a,v.z,w,u.Ov,h.X$,N.H],styles:[".zone-wrapper[_ngcontent-%COMP%]{display:flex;height:calc(100% - 50px)}.zone-wrapper[_ngcontent-%COMP%]   .zone-list[_ngcontent-%COMP%]{flex:1;overflow:auto;margin-top:0}.zone-wrapper[_ngcontent-%COMP%]   .zone-list[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.zone-members[_ngcontent-%COMP%]{height:100%;width:0;opacity:0;visibility:hidden;overflow:auto;transition:width .3s,opacity .2s .3s,visibility 0s .3s}.zone-members.expanded[_ngcontent-%COMP%]{width:40vw;visibility:visible;opacity:1;padding-left:12px}.zone-members[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{margin:0;background:none;border:none;cursor:pointer}.zone-members[_ngcontent-%COMP%]     table.table{margin-top:0}.zone-members[_ngcontent-%COMP%]     table.table th{top:0}.zone-members[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"],changeDetection:0});const _t={location:"zone-members-list",label:(0,l.J)("settings.remove-from-zone"),icon:"trash",iconClass:"is-danger",requiresPermission:s.y3$.UpdateCustomerGroup,onClick:({injector:o,selection:n,hostComponent:t,clearSelection:i})=>{const a=o.get(s.DoR),c=o.get(s.gqp),m=t.activeZone,C=n.map(_=>_.id);a.settings.removeMembersFromZone(m.id,C).subscribe({complete:()=>{c.success((0,l.J)("settings.remove-countries-from-zone-success"),{countryCount:C.length,zoneName:m.name}),t.refresh(),i()}})}};class xe extends s.p_9{constructor(n,t){super(n,{__typename:"Administrator",id:"",createdAt:"",updatedAt:"",emailAddress:"",firstName:"",lastName:"",user:{roles:[]}},i=>t.administrator.getActiveAdministrator().mapStream(a=>a.activeAdministrator))}}xe.\u0275fac=function(n){return new(n||xe)(e.LFG(y.F0),e.LFG(s.DoR))},xe.\u0275prov=e.Yz7({token:xe,factory:xe.\u0275fac,providedIn:"root"});const ft=o=>[{path:"profile",component:s.IIO,data:{breadcrumb:(0,l.J)("breadcrumb.profile")},resolve:{detail:()=>(0,e.f3M)(s.DoR).query(s.fLu).mapSingle(n=>({entity:(0,Pe.of)(n.activeAdministrator)}))},children:o.getPageTabRoutes("profile")},{path:"administrators",component:s.IIO,data:{locationId:"administrator-list",breadcrumb:(0,l.J)("breadcrumb.administrators")},children:o.getPageTabRoutes("administrator-list")},{path:"administrators/:id",component:s.IIO,data:{locationId:"administrator-detail",breadcrumb:{label:(0,l.J)("breadcrumb.administrators"),link:["../","administrators"]}},children:o.getPageTabRoutes("administrator-detail")},{path:"channels",component:s.IIO,data:{locationId:"channel-list",breadcrumb:(0,l.J)("breadcrumb.channels")},children:o.getPageTabRoutes("channel-list")},{path:"channels/:id",component:s.IIO,data:{locationId:"channel-list",breadcrumb:{label:(0,l.J)("breadcrumb.channels"),link:["../","channels"]}},children:o.getPageTabRoutes("channel-detail")},{path:"sellers",component:s.IIO,data:{locationId:"seller-list",breadcrumb:(0,l.J)("breadcrumb.sellers")},children:o.getPageTabRoutes("seller-list")},{path:"sellers/:id",component:s.IIO,data:{locationId:"seller-list",breadcrumb:{label:(0,l.J)("breadcrumb.sellers"),link:["../","sellers"]}},children:o.getPageTabRoutes("seller-detail")},{path:"roles",component:s.IIO,data:{locationId:"role-list",breadcrumb:(0,l.J)("breadcrumb.roles")},children:o.getPageTabRoutes("role-list")},{path:"roles/:id",component:s.IIO,data:{locationId:"role-detail",breadcrumb:{label:(0,l.J)("breadcrumb.roles"),link:["../","roles"]}},children:o.getPageTabRoutes("role-detail")},{path:"tax-categories",component:s.IIO,data:{locationId:"tax-category-list",breadcrumb:(0,l.J)("breadcrumb.tax-categories")},children:o.getPageTabRoutes("tax-category-list")},{path:"tax-categories/:id",component:s.IIO,data:{locationId:"tax-category-detail",breadcrumb:{label:(0,l.J)("breadcrumb.tax-categories"),link:["../","tax-categories"]}},children:o.getPageTabRoutes("tax-category-detail")},{path:"tax-rates",component:s.IIO,data:{locationId:"tax-rate-list",breadcrumb:(0,l.J)("breadcrumb.tax-rates")},children:o.getPageTabRoutes("tax-rate-list")},{path:"tax-rates/:id",component:s.IIO,data:{locationId:"tax-rate-detail",breadcrumb:{label:(0,l.J)("breadcrumb.tax-rates"),link:["../","tax-rates"]}},children:o.getPageTabRoutes("tax-rate-detail")},{path:"countries",component:s.IIO,data:{locationId:"country-list",breadcrumb:(0,l.J)("breadcrumb.countries")},children:o.getPageTabRoutes("country-list")},{path:"countries/:id",component:s.IIO,data:{locationId:"country-detail",breadcrumb:{label:(0,l.J)("breadcrumb.countries"),link:["../","countries"]}},children:o.getPageTabRoutes("country-detail")},{path:"zones",component:s.IIO,data:{locationId:"zone-list",breadcrumb:(0,l.J)("breadcrumb.zones")},children:o.getPageTabRoutes("zone-list")},{path:"zones/:id",component:s.IIO,data:{locationId:"zone-detail",breadcrumb:{label:(0,l.J)("breadcrumb.zones"),link:["../","zones"]}},children:o.getPageTabRoutes("zone-detail")},{path:"shipping-methods",component:s.IIO,data:{locationId:"shipping-method-list",breadcrumb:(0,l.J)("breadcrumb.shipping-methods")},children:o.getPageTabRoutes("shipping-method-list")},{path:"shipping-methods/:id",component:s.IIO,data:{locationId:"shipping-method-detail",breadcrumb:{label:(0,l.J)("breadcrumb.shipping-methods"),link:["../","shipping-methods"]}},children:o.getPageTabRoutes("shipping-method-detail")},{path:"payment-methods",component:s.IIO,data:{locationId:"payment-method-list",breadcrumb:(0,l.J)("breadcrumb.payment-methods")},children:o.getPageTabRoutes("payment-method-list")},{path:"payment-methods/:id",component:s.IIO,data:{locationId:"payment-method-detail",breadcrumb:{label:(0,l.J)("breadcrumb.payment-methods"),link:["../","payment-methods"]}},children:o.getPageTabRoutes("payment-method-detail")},{path:"global-settings",component:s.IIO,data:{breadcrumb:(0,l.J)("breadcrumb.global-settings"),locationId:"global-setting-detail"},resolve:{detail:()=>(0,e.f3M)(s.DoR).query(s.e$I).mapSingle(n=>({entity:(0,Pe.of)(n.globalSettings)}))},children:o.getPageTabRoutes("global-setting-detail")}];class Fe{constructor(n,t){this.bulkActionRegistryService=n,n.registerBulkAction(at),n.registerBulkAction(Be),n.registerBulkAction(Ye),n.registerBulkAction(it),n.registerBulkAction(ct),n.registerBulkAction(dt),n.registerBulkAction(lt),n.registerBulkAction(nt),n.registerBulkAction(ot),n.registerBulkAction(tt),n.registerBulkAction(mt),n.registerBulkAction(ut),n.registerBulkAction(je),n.registerBulkAction(pt),n.registerBulkAction(_t),t.registerPageTab({priority:0,location:"seller-list",tab:(0,l.J)("breadcrumb.sellers"),route:"",component:ge}),t.registerPageTab({priority:0,location:"seller-detail",tab:(0,l.J)("settings.seller"),route:"",component:(0,s.IX9)({component:pe,query:s.z_Z,entityKey:"seller",getBreadcrumbs:i=>[{label:i?i.name:(0,l.J)("settings.create-new-seller"),link:[i?.id]}]})}),t.registerPageTab({priority:0,location:"channel-list",tab:(0,l.J)("breadcrumb.channels"),route:"",component:ie}),t.registerPageTab({priority:0,location:"channel-detail",tab:(0,l.J)("settings.channel"),route:"",component:(0,s.IX9)({component:oe,query:s.TVA,entityKey:"channel",getBreadcrumbs:i=>[{label:i?i.code===G.z$?"common.default-channel":i.code:(0,l.J)("settings.create-new-channel"),link:[i?.id]}]})}),t.registerPageTab({priority:0,location:"administrator-list",tab:(0,l.J)("breadcrumb.administrators"),route:"",component:ne}),t.registerPageTab({priority:0,location:"administrator-detail",tab:(0,l.J)("settings.administrator"),route:"",component:(0,s.IX9)({component:te,query:s.nB8,entityKey:"administrator",getBreadcrumbs:i=>[{label:i?`${i.firstName} ${i.lastName}`:(0,l.J)("admin.create-new-administrator"),link:[i?.id]}]})}),t.registerPageTab({priority:0,location:"role-list",tab:(0,l.J)("breadcrumb.roles"),route:"",component:ue}),t.registerPageTab({priority:0,location:"role-detail",tab:(0,l.J)("settings.role"),route:"",component:(0,s.IX9)({component:me,query:s.uaX,entityKey:"role",getBreadcrumbs:i=>[{label:i?i.description:(0,l.J)("settings.create-new-role"),link:[i?.id]}]})}),t.registerPageTab({priority:0,location:"shipping-method-list",tab:(0,l.J)("breadcrumb.shipping-methods"),route:"",component:Ce}),t.registerPageTab({priority:0,location:"shipping-method-detail",tab:(0,l.J)("settings.shipping-method"),route:"",component:(0,s.IX9)({component:fe,query:s.od1,entityKey:"shippingMethod",getBreadcrumbs:i=>[{label:i?i.name:(0,l.J)("settings.create-new-shipping-method"),link:[i?.id]}]})}),t.registerPageTab({priority:0,location:"shipping-method-list",tab:(0,l.J)("settings.test-shipping-methods"),route:"test",component:ye}),t.registerPageTab({priority:0,location:"payment-method-list",tab:(0,l.J)("breadcrumb.payment-methods"),route:"",component:ce}),t.registerPageTab({priority:0,location:"payment-method-detail",tab:(0,l.J)("settings.payment-method"),route:"",component:(0,s.IX9)({component:le,query:s.C8l,entityKey:"paymentMethod",getBreadcrumbs:i=>[{label:i?i.name:(0,l.J)("settings.create-new-payment-method"),link:[i?.id]}]})}),t.registerPageTab({priority:0,location:"tax-category-list",tab:(0,l.J)("breadcrumb.tax-categories"),route:"",component:be}),t.registerPageTab({priority:0,location:"tax-category-detail",tab:(0,l.J)("settings.tax-category"),route:"",component:(0,s.IX9)({component:ve,query:s.uHZ,entityKey:"taxCategory",getBreadcrumbs:i=>[{label:i?i.name:(0,l.J)("settings.create-new-tax-category"),link:[i?.id]}]})}),t.registerPageTab({priority:0,location:"tax-rate-list",tab:(0,l.J)("breadcrumb.tax-rates"),route:"",component:Te}),t.registerPageTab({priority:0,location:"tax-rate-detail",tab:(0,l.J)("settings.tax-rate"),route:"",component:(0,s.IX9)({component:Ze,query:s.OSW,entityKey:"taxRate",getBreadcrumbs:i=>[{label:i?i.name:(0,l.J)("settings.create-new-tax-rate"),link:[i?.id]}]})}),t.registerPageTab({priority:0,location:"country-list",tab:(0,l.J)("breadcrumb.countries"),route:"",component:se}),t.registerPageTab({priority:0,location:"country-detail",tab:(0,l.J)("settings.country"),route:"",component:(0,s.IX9)({component:ae,query:s.f19,entityKey:"country",getBreadcrumbs:i=>[{label:i?i.name:(0,l.J)("settings.create-new-country"),link:[i?.id]}]})}),t.registerPageTab({priority:0,location:"zone-list",tab:(0,l.J)("breadcrumb.zones"),route:"",component:Le}),t.registerPageTab({priority:0,location:"zone-detail",tab:(0,l.J)("settings.zone"),route:"",component:(0,s.IX9)({component:Ae,query:s.Dlg,entityKey:"zone",getBreadcrumbs:i=>[{label:i?i.name:(0,l.J)("settings.create-new-zone"),link:[i?.id]}]})}),t.registerPageTab({priority:0,location:"global-setting-detail",tab:(0,l.J)("breadcrumb.global-settings"),route:"",component:re}),t.registerPageTab({priority:0,location:"profile",tab:(0,l.J)("breadcrumb.profile"),route:"",component:de})}}Fe.\u0275fac=function(n){return new(n||Fe)(e.LFG(s._4w),e.LFG(s.PhL))},Fe.\u0275mod=e.oAB({type:Fe}),Fe.\u0275inj=e.cJS({providers:[{provide:y.Z6,useFactory:o=>ft(o),multi:!0,deps:[s.PhL]}],imports:[s.m81,y.Bz.forChild([])]})}}]);
//# sourceMappingURL=94.3274a9070d061d38.js.map