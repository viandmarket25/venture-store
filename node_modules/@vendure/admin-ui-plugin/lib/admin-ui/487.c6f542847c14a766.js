"use strict";(self.webpackChunkvendure_admin=self.webpackChunkvendure_admin||[]).push([[487],{7487:(It,$,i)=>{i.r($),i.d($,{DEFAULT_DASHBOARD_WIDGET_LAYOUT:()=>N,DEFAULT_WIDGETS:()=>Y,DashboardComponent:()=>g,DashboardModule:()=>_,DashboardWidgetComponent:()=>m,GET_ORDER_CHART_DATA:()=>At,GET_ORDER_SUMMARY:()=>Mt,LatestOrdersWidgetComponent:()=>u,LatestOrdersWidgetModule:()=>h,OrderChartWidgetComponent:()=>f,OrderSummaryWidgetComponent:()=>v,OrderSummaryWidgetModule:()=>y,TestWidgetComponent:()=>b,TestWidgetModule:()=>C,WelcomeWidgetComponent:()=>Z,WelcomeWidgetModule:()=>x,dashboardRoutes:()=>R});var d=i(5209),G=i(5387),p=i(2303),E=i(5244),t=i(3162),O=i(296),c=i(7347),w=i(9119),q=i(9014),Q=i(433),B=i(8308),H=i(9182),V=i(3736),K=i(3827),X=i(5368),U=i(7790),T=i(2477);const z=["portal"];function tt(n,e){1&n&&t.Hsn(0)}function et(n,e){}class m{constructor(e){this.componentFactoryResolver=e}ngAfterViewInit(){this.loadWidget()}loadWidget(){var e=this;return(0,X.Z)(function*(){const o=e.widgetConfig.loadComponent(),r=o instanceof Promise?yield o:o;e.componentRef=e.portal.createComponent(e.componentFactoryResolver.resolveComponentFactory(r)),e.componentRef.changeDetectorRef.detectChanges()})()}ngOnDestroy(){this.componentRef&&this.componentRef.destroy()}}function nt(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){const s=t.CHM(o).$implicit,l=t.oxw();return t.KtG(l.addWidget(s))}),t._uU(1),t.qZA()}if(2&n){const o=e.$implicit;t.xp6(1),t.hij(" ",o," ")}}m.\u0275fac=function(e){return new(e||m)(t.Y36(t._Vd))},m.\u0275cmp=t.Xpm({type:m,selectors:[["vdr-dashboard-widget"]],viewQuery:function(e,o){if(1&e&&t.Gf(z,5,t.s_b),2&e){let r;t.iGM(r=t.CRH())&&(o.portal=r.first)}},inputs:{widgetConfig:"widgetConfig"},ngContentSelectors:["*"],decls:5,vars:3,consts:[[3,"title"],["vdrCardControls",""],["portal",""]],template:function(e,o){if(1&e&&(t.F$t(),t.TgZ(0,"vdr-card",0),t.ALo(1,"translate"),t.YNc(2,tt,1,0,"ng-template",1),t.YNc(3,et,0,0,"ng-template",null,2,t.W1O),t.qZA()),2&e){let r;t.Q6J("title",t.lcZ(1,1,null!==(r=o.widgetConfig.title)&&void 0!==r?r:""))}},dependencies:[U.A,U.D,T.X$],styles:["[_nghost-%COMP%]{display:block}.card[_ngcontent-%COMP%]{margin-top:0;min-height:200px}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"],changeDetection:0});const rt=function(n){return{width:n}};function at(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){const s=t.CHM(o).$implicit,l=t.oxw(2).$implicit,A=t.oxw(2);return t.KtG(A.setWidgetWidth(l,s))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&n){const o=e.$implicit,r=t.oxw(2).$implicit;t.Q6J("disabled",o===r.width),t.xp6(1),t.hij(" ",t.xi3(2,2,"dashboard.widget-width",t.VKq(5,rt,o))," ")}}function it(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"vdr-dashboard-widget",13)(1,"div",14)(2,"div",15),t._UZ(3,"clr-icon",16),t.qZA(),t.TgZ(4,"vdr-dropdown")(5,"button",17),t._UZ(6,"clr-icon",3),t.qZA(),t.TgZ(7,"vdr-dropdown-menu",4)(8,"h4",18),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.YNc(11,at,3,7,"button",19),t._UZ(12,"div",20),t.TgZ(13,"button",8),t.NdJ("click",function(){t.CHM(o);const a=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.removeWidget(a))}),t._UZ(14,"clr-icon",21),t._uU(15),t.ALo(16,"translate"),t.qZA()()()()()}if(2&n){const o=t.oxw().$implicit,r=t.oxw(2);t.Q6J("widgetConfig",o.config),t.xp6(9),t.Oqu(t.lcZ(10,4,"dashboard.widget-resize")),t.xp6(2),t.Q6J("ngForOf",r.getSupportedWidths(o.config)),t.xp6(4),t.hij(" ",t.lcZ(16,6,"dashboard.remove-widget")," ")}}function dt(n,e){if(1&n&&(t.TgZ(0,"div",11),t.YNc(1,it,17,8,"vdr-dashboard-widget",12),t.qZA()),2&n){const o=e.$implicit,r=t.oxw(2);t.Q6J("ngClass",r.getClassForWidth(o.width))("cdkDragData",o),t.xp6(1),t.Q6J("vdrIfPermissions",o.config.requiresPermissions||null)}}const st=function(n){return{index:n}};function ct(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"div",9),t.NdJ("cdkDropListDropped",function(a){t.CHM(o);const s=t.oxw();return t.KtG(s.drop(a))}),t.YNc(1,dt,2,3,"div",10),t.qZA()}if(2&n){const o=e.$implicit,r=e.index,a=t.oxw();t.Q6J("cdkDropListData",t.VKq(3,st,r)),t.xp6(1),t.Q6J("ngForOf",o)("ngForTrackBy",a.trackRowItem)}}class g{constructor(e,o,r,a){this.dashboardWidgetService=e,this.localStorageService=o,this.changedDetectorRef=r,this.dataService=a,this.deletionMarker="__delete__",this.setTitle=(0,d.sZ5)()}ngOnInit(){this.availableWidgetIds$=this.dataService.client.userStatus().stream$.pipe((0,p.U)(({userStatus:e})=>e.permissions),(0,p.U)(e=>this.dashboardWidgetService.getAvailableIds(e)),(0,E.b)(e=>this.widgetLayout=this.initLayout(e))),this.setTitle("breadcrumb.dashboard")}getClassForWidth(e){switch(e){case 3:return"clr-col-12 clr-col-sm-6 clr-col-lg-3";case 4:return"clr-col-12 clr-col-sm-6 clr-col-lg-4";case 6:return"clr-col-12 clr-col-lg-6";case 8:return"clr-col-12 clr-col-lg-8";case 12:return"clr-col-12";default:(0,G.assertNever)(e)}}getSupportedWidths(e){return e.supportedWidths||[3,4,6,8,12]}setWidgetWidth(e,o){e.width=o,this.recalculateLayout()}trackRow(e,o){return o.map(a=>`${a.id}:${a.width}`).join("|")}trackRowItem(e,o){return o.config}addWidget(e){const o=this.dashboardWidgetService.getWidgetById(e);if(o){const a={id:e,config:o,width:this.getSupportedWidths(o)[0]};let s;this.widgetLayout&&this.widgetLayout.length?s=this.widgetLayout[this.widgetLayout.length-1]:(s=[],this.widgetLayout?.push(s)),s.push(a),this.recalculateLayout()}}removeWidget(e){e.id=this.deletionMarker,this.recalculateLayout()}drop(e){const{currentIndex:o,previousIndex:r,previousContainer:a,container:s}=e;if((r!==o||a.data.index!==s.data.index)&&this.widgetLayout){const l=this.widgetLayout[a.data.index],A=this.widgetLayout[s.data.index];l.splice(r,1),A.splice(o,0,e.item.data),this.recalculateLayout()}}initLayout(e){const o=this.localStorageService.get("dashboardWidgetLayout");let r;return o&&(r=o.filter(a=>e.includes(a.id))),this.dashboardWidgetService.getWidgetLayout(r)}recalculateLayout(){if(this.widgetLayout){const o=this.widgetLayout.reduce((r,a)=>[...r,...a],[]).filter(r=>r.id!==this.deletionMarker).map(r=>({id:r.id,width:r.width}));this.widgetLayout=this.dashboardWidgetService.getWidgetLayout(o),this.localStorageService.set("dashboardWidgetLayout",o),setTimeout(()=>this.changedDetectorRef.markForCheck())}}}g.\u0275fac=function(e){return new(e||g)(t.Y36(d.ayj),t.Y36(d.n2A),t.Y36(t.sBO),t.Y36(d.DoR))},g.\u0275cmp=t.Xpm({type:g,selectors:[["vdr-dashboard"]],decls:13,vars:8,consts:[[1,"widget-header","mb-1"],["vdrDropdownTrigger","",1,"btn","btn-secondary","btn-sm"],["shape","plus"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["cdkDropListGroup",""],["class","clr-row dashboard-row","cdkDropList","","cdkDropListOrientation","horizontal",3,"cdkDropListData","cdkDropListDropped",4,"ngFor","ngForOf","ngForTrackBy"],["vdrDropdownItem","",3,"click"],["cdkDropList","","cdkDropListOrientation","horizontal",1,"clr-row","dashboard-row",3,"cdkDropListData","cdkDropListDropped"],["class","dashboard-item","cdkDrag","",3,"ngClass","cdkDragData",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"dashboard-item",3,"ngClass","cdkDragData"],[3,"widgetConfig",4,"vdrIfPermissions"],[3,"widgetConfig"],[1,"flex"],["cdkDragHandle","",1,"drag-handle"],["shape","drag-handle","size","24"],["vdrDropdownTrigger","",1,"icon-button"],[1,"dropdown-header"],["vdrDropdownItem","",3,"disabled","click",4,"ngFor","ngForOf"],["role","separator",1,"dropdown-divider"],["shape","trash",1,"is-danger"],["vdrDropdownItem","",3,"disabled","click"]],template:function(e,o){1&e&&(t.TgZ(0,"vdr-page-block")(1,"div",0)(2,"vdr-dropdown")(3,"button",1),t._UZ(4,"clr-icon",2),t._uU(5),t.ALo(6,"translate"),t._UZ(7,"clr-icon",3),t.qZA(),t.TgZ(8,"vdr-dropdown-menu",4),t.YNc(9,nt,2,1,"button",5),t.ALo(10,"async"),t.qZA()()(),t.TgZ(11,"div",6),t.YNc(12,ct,2,5,"div",7),t.qZA()()),2&e&&(t.xp6(5),t.hij(" ",t.lcZ(6,4,"dashboard.add-widget")," "),t.xp6(4),t.Q6J("ngForOf",t.lcZ(10,6,o.availableWidgetIds$)),t.xp6(3),t.Q6J("ngForOf",o.widgetLayout)("ngForTrackBy",o.trackRow))},dependencies:[O.q0d,O.qvL,c.mk,c.sg,w.Wj,w.Fd,w.Zt,w.Bh,q.J,Q.N,B.U,H.H,V.H,K.z,m,c.Ov,T.X$],styles:[".widget-header[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.placeholder[_ngcontent-%COMP%]{color:var(--color-grey-300);text-align:center}.placeholder[_ngcontent-%COMP%]   .version[_ngcontent-%COMP%]{font-size:3em;margin:24px;line-height:1em}.placeholder[_ngcontent-%COMP%]     .clr-i-outline{fill:var(--color-grey-200)}vdr-dashboard-widget[_ngcontent-%COMP%]{margin-bottom:24px}.drag-handle[_ngcontent-%COMP%]{cursor:move}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.dashboard-row[_ngcontent-%COMP%]{padding:0;border-width:1;margin-bottom:6px;transition:padding .2s,margin .2s}.dashboard-row.cdk-drop-list-dragging[_ngcontent-%COMP%], .dashboard-row.cdk-drop-list-receiving[_ngcontent-%COMP%]{border:2px dashed var(--color-component-border-200);border-radius:var(--border-radius);padding:6px}.dashboard-row.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dashboard-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],changeDetection:0});var k=i(3576);const R=[{path:"",component:g,pathMatch:"full"}];var D=i(8511),W=i(7698),lt=i(9705),pt=i(2814),mt=i(8862),gt=i(7869),I=i(5881),ut=i(2491);const ht=function(n){return["/orders/",n]};function ft(n,e){if(1&n&&(t.TgZ(0,"a",3)(1,"span"),t._uU(2),t.qZA(),t._UZ(3,"clr-icon",4),t.qZA()),2&n){const o=e.item;t.Q6J("routerLink",t.VKq(2,ht,o.id)),t.xp6(2),t.Oqu(o.code)}}function vt(n,e){if(1&n&&t._UZ(0,"vdr-order-state-label",5),2&n){const o=e.item;t.Q6J("state",o.state)}}function yt(n,e){if(1&n&&t._UZ(0,"vdr-customer-label",6),2&n){const o=e.item;t.Q6J("customer",o.customer)}}function _t(n,e){if(1&n&&(t._uU(0),t.ALo(1,"localeCurrency")),2&n){const o=e.item;t.hij(" ",t.xi3(1,1,o.totalWithTax,o.currencyCode)," ")}}function Ct(n,e){if(1&n&&(t._uU(0),t.ALo(1,"timeAgo")),2&n){const o=e.item;t.hij(" ",t.lcZ(1,1,o.orderPlacedAt)," ")}}W.Ps`
    query GetLatestOrders($options: OrderListOptions) {
        orders(options: $options) {
            items {
                id
                createdAt
                updatedAt
                type
                orderPlacedAt
                code
                state
                total
                totalWithTax
                currencyCode
                customer {
                    id
                    firstName
                    lastName
                }
            }
        }
    }
`;class u{constructor(e){this.dataService=e}ngOnInit(){this.latestOrders$=this.dataService.query(d.pUH,{options:{take:10,filter:{active:{eq:!1},state:{notIn:["Cancelled","Draft"]}},sort:{orderPlacedAt:d.Asd.DESC}}}).refetchOnChannelChange().mapStream(e=>e.orders.items)}}u.\u0275fac=function(e){return new(e||u)(t.Y36(d.DoR))},u.\u0275cmp=t.Xpm({type:u,selectors:[["vdr-latest-orders-widget"]],decls:17,vars:20,consts:[["id","latest-orders-widget-list",3,"items"],[3,"heading"],[3,"heading","hiddenByDefault"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"state"],[3,"customer"]],template:function(e,o){1&e&&(t.TgZ(0,"vdr-data-table-2",0),t.ALo(1,"async"),t.TgZ(2,"vdr-dt2-column",1),t.ALo(3,"translate"),t.YNc(4,ft,4,4,"ng-template"),t.qZA(),t.TgZ(5,"vdr-dt2-column",2),t.ALo(6,"translate"),t.YNc(7,vt,1,1,"ng-template"),t.qZA(),t.TgZ(8,"vdr-dt2-column",2),t.ALo(9,"translate"),t.YNc(10,yt,1,1,"ng-template"),t.qZA(),t.TgZ(11,"vdr-dt2-column",1),t.ALo(12,"translate"),t.YNc(13,_t,2,4,"ng-template"),t.qZA(),t.TgZ(14,"vdr-dt2-column",1),t.ALo(15,"translate"),t.YNc(16,Ct,2,3,"ng-template"),t.qZA()()),2&e&&(t.Q6J("items",t.lcZ(1,8,o.latestOrders$)),t.xp6(2),t.Q6J("heading",t.lcZ(3,10,"common.code")),t.xp6(3),t.Q6J("heading",t.lcZ(6,12,"order.state"))("hiddenByDefault",!0),t.xp6(3),t.Q6J("heading",t.lcZ(9,14,"customer.customer"))("hiddenByDefault",!0),t.xp6(3),t.Q6J("heading",t.lcZ(12,16,"order.total")),t.xp6(3),t.Q6J("heading",t.lcZ(15,18,"order.placed-at")))},dependencies:[O.qvL,k.rH,lt.d,pt.G,mt.e,gt.U,c.Ov,T.X$,I.e,ut.k],styles:["vdr-data-table[_ngcontent-%COMP%]     table{margin-top:0}vdr-order-state-label[_ngcontent-%COMP%]{display:inline-block;margin-top:2px}"],changeDetection:0});class h{}h.\u0275fac=function(e){return new(e||h)},h.\u0275mod=t.oAB({type:h}),h.\u0275inj=t.cJS({imports:[d.IR2,d.m81]});var xt=i(8077),F=i(4400),Ot=i(7296),L=i(407),J=i(536),Tt=i(6821),bt=i(9767);function Zt(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"div",2)(1,"button",3),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.metricType$.next(a.MetricType.OrderTotal))}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",4),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.metricType$.next(a.MetricType.OrderCount))}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.metricType$.next(a.MetricType.AverageOrderValue))}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t._UZ(10,"div",5),t.TgZ(11,"button",3),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.refresh())}),t._UZ(12,"clr-icon",6),t.qZA()()}if(2&n){const o=e.ngIf,r=t.oxw();t.xp6(1),t.ekj("active",o===r.MetricType.OrderTotal),t.xp6(1),t.hij(" ",t.lcZ(3,9,"dashboard.metric-order-total-value")," "),t.xp6(2),t.ekj("active",o===r.MetricType.OrderCount),t.xp6(1),t.hij(" ",t.lcZ(6,11,"dashboard.metric-number-of-orders")," "),t.xp6(2),t.ekj("active",o===r.MetricType.AverageOrderValue),t.xp6(1),t.hij(" ",t.lcZ(9,13,"dashboard.metric-average-order-value")," ")}}const At=W.Ps`
    query GetOrderChartData($refresh: Boolean, $types: [MetricType!]!) {
        metricSummary(input: { interval: Daily, types: $types, refresh: $refresh }) {
            interval
            type
            entries {
                label
                value
            }
        }
    }
`;class f{constructor(e){this.dataService=e,this.refresh$=new xt.x,this.metricType$=new F.X(d.t0y.OrderTotal),this.MetricType=d.t0y}ngOnInit(){const e=this.dataService.settings.getActiveChannel().refetchOnChannelChange().mapStream(a=>a.activeChannel.defaultCurrencyCode||void 0),o=this.dataService.client.uiState().mapStream(a=>a.uiState),r=this.metricType$.pipe((0,J.x)());this.metrics$=(0,Ot.a)(r,e,o).pipe((0,L.w)(([a,s,l])=>this.refresh$.pipe((0,Tt.O)(!1),(0,L.w)(A=>this.dataService.query(d.UZ,{types:[a],refresh:A}).mapSingle(M=>M.metricSummary).pipe((0,p.U)(M=>{const Ut=a===d.t0y.OrderCount?"number":"currency",kt=`${l.language}-${l.locale}`,Rt={formatValueAs:Ut,currencyCode:s,locale:kt};return M.find(S=>S.type===a)?.entries.map(S=>({...S,formatOptions:Rt}))??[]}))))))}refresh(){this.refresh$.next(!0)}}f.\u0275fac=function(e){return new(e||f)(t.Y36(d.DoR))},f.\u0275cmp=t.Xpm({type:f,selectors:[["vdr-order-chart-widget"]],decls:4,vars:6,consts:[[3,"entries"],["class","flex",4,"ngIf"],[1,"flex"],[1,"button-small",3,"click"],[1,"ml-1","button-small",3,"click"],[1,"flex-spacer"],["shape","refresh"]],template:function(e,o){1&e&&(t._UZ(0,"vdr-chart",0),t.ALo(1,"async"),t.YNc(2,Zt,13,15,"div",1),t.ALo(3,"async")),2&e&&(t.Q6J("entries",t.lcZ(1,2,o.metrics$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,4,o.metricType$)))},dependencies:[O.qvL,c.O5,bt.x,c.Ov,T.X$],styles:[".button-small.active[_ngcontent-%COMP%]{background-color:var(--color-primary-200);color:var(--color-primary-900)}"],changeDetection:0});var wt=i(5698),P=i.n(wt),j=i(5822),Dt=i(2050);function Wt(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"div",7)(1,"button",8),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.selection$.next({timeframe:"day",date:a.today}))}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",9),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.selection$.next({timeframe:"day",date:a.yesterday}))}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",9),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.selection$.next({timeframe:"week"}))}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",9),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.selection$.next({timeframe:"month"}))}),t._uU(11),t.ALo(12,"translate"),t.qZA()()}if(2&n){const o=e.ngIf,r=t.oxw();t.xp6(1),t.ekj("active",o.date===r.today),t.xp6(1),t.hij(" ",t.lcZ(3,12,"dashboard.today")," "),t.xp6(2),t.ekj("active",o.date===r.yesterday),t.xp6(1),t.hij(" ",t.lcZ(6,14,"dashboard.yesterday")," "),t.xp6(2),t.ekj("active","week"===o.timeframe),t.xp6(1),t.hij(" ",t.lcZ(9,16,"dashboard.thisWeek")," "),t.xp6(2),t.ekj("active","month"===o.timeframe),t.xp6(1),t.hij(" ",t.lcZ(12,18,"dashboard.thisMonth")," ")}}function Lt(n,e){if(1&n&&(t.TgZ(0,"div",10),t._uU(1),t.ALo(2,"localeDate"),t.ALo(3,"localeDate"),t.qZA()),2&n){const o=e.ngIf;t.xp6(1),t.AsE(" ",t.lcZ(2,2,o.start)," - ",t.lcZ(3,4,o.end)," ")}}const Mt=W.Ps`
    query GetOrderSummary($start: DateTime!, $end: DateTime!) {
        orders(options: { filter: { orderPlacedAt: { between: { start: $start, end: $end } } } }) {
            totalItems
            items {
                id
                totalWithTax
                currencyCode
            }
        }
    }
`;class v{constructor(e){this.dataService=e,this.today=new Date,this.yesterday=new Date((new Date).setDate(this.today.getDate()-1)),this.selection$=new F.X({timeframe:"day",date:this.today})}ngOnInit(){this.dateRange$=this.selection$.pipe((0,J.x)(),(0,p.U)(o=>({start:P()(o.date).startOf(o.timeframe).toDate(),end:P()(o.date).endOf(o.timeframe).toDate()})),(0,j.d)(1));const e=this.dateRange$.pipe((0,L.w)(({start:o,end:r})=>this.dataService.query(d.OY9,{start:o.toISOString(),end:r.toISOString()}).refetchOnChannelChange().mapStream(a=>a.orders)),(0,j.d)(1));this.totalOrderCount$=e.pipe((0,p.U)(o=>o.totalItems)),this.totalOrderValue$=e.pipe((0,p.U)(o=>o.items.reduce((r,a)=>r+a.totalWithTax,0)/100)),this.currencyCode$=this.dataService.settings.getActiveChannel().refetchOnChannelChange().mapStream(o=>o.activeChannel.defaultCurrencyCode||void 0)}}v.\u0275fac=function(e){return new(e||v)(t.Y36(d.DoR))},v.\u0275cmp=t.Xpm({type:v,selectors:[["vdr-order-summary-widget"]],decls:22,vars:23,consts:[[1,"stats"],[1,"stat"],[1,"stat-figure"],[1,"stat-label"],[1,"footer"],["class","flex",4,"ngIf"],["class","date-range p5",4,"ngIf"],[1,"flex"],[1,"button-small",3,"click"],[1,"ml-1","button-small",3,"click"],[1,"date-range","p5"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"div",3),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"div",1)(9,"div",2),t._uU(10),t.ALo(11,"currency"),t.ALo(12,"async"),t.ALo(13,"async"),t.qZA(),t.TgZ(14,"div",3),t._uU(15),t.ALo(16,"translate"),t.qZA()()(),t.TgZ(17,"div",4),t.YNc(18,Wt,13,20,"div",5),t.ALo(19,"async"),t.YNc(20,Lt,4,6,"div",6),t.ALo(21,"async"),t.qZA()),2&e&&(t.xp6(3),t.Oqu(t.lcZ(4,6,o.totalOrderCount$)),t.xp6(3),t.Oqu(t.lcZ(7,8,"dashboard.total-orders")),t.xp6(4),t.hij(" ",t.xi3(11,10,t.lcZ(12,13,o.totalOrderValue$),t.lcZ(13,15,o.currencyCode$)||void 0)," "),t.xp6(5),t.Oqu(t.lcZ(16,17,"dashboard.total-order-value")),t.xp6(3),t.Q6J("ngIf",t.lcZ(19,19,o.selection$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(21,21,o.dateRange$)))},dependencies:[c.O5,c.Ov,c.H9,T.X$,Dt.H],styles:[".stats[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}.stat[_ngcontent-%COMP%]{text-align:center}.stat-figure[_ngcontent-%COMP%]{font-size:2rem;line-height:3rem}.stat-label[_ngcontent-%COMP%]{text-transform:uppercase}.date-range[_ngcontent-%COMP%]{margin-top:0}.footer[_ngcontent-%COMP%]{margin-top:24px;display:flex;flex-direction:column;justify-content:space-between}.button-small.active[_ngcontent-%COMP%]{background-color:var(--color-primary-200);color:var(--color-primary-900)}"],changeDetection:0});class y{}y.\u0275fac=function(e){return new(e||y)},y.\u0275mod=t.oAB({type:y}),y.\u0275inj=t.cJS({imports:[d.IR2]});const N=[{id:"metrics",width:12},{id:"orderSummary",width:6},{id:"latestOrders",width:6}],Y={metrics:{title:(0,D.J)("dashboard.metrics"),supportedWidths:[6,8,12],loadComponent:()=>f,requiresPermissions:[d.y3$.ReadOrder]},orderSummary:{title:(0,D.J)("dashboard.orders-summary"),loadComponent:()=>v,supportedWidths:[4,6,8,12],requiresPermissions:[d.y3$.ReadOrder]},latestOrders:{title:(0,D.J)("dashboard.latest-orders"),loadComponent:()=>u,supportedWidths:[6,8,12],requiresPermissions:[d.y3$.ReadOrder]}};class _{constructor(e){Object.entries(Y).map(([o,r])=>{e.getWidgetById(o)||e.registerWidget(o,r)}),0===e.getDefaultLayout().length&&e.setDefaultLayout(N)}}_.\u0275fac=function(e){return new(e||_)(t.LFG(d.ayj))},_.\u0275mod=t.oAB({type:_}),_.\u0275inj=t.cJS({imports:[d.m81,k.Bz.forChild(R)]});class b{}b.\u0275fac=function(e){return new(e||b)},b.\u0275cmp=t.Xpm({type:b,selectors:[["vdr-test-widget"]],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"This is a test widget!"),t.qZA())},changeDetection:0});class C{}function St(n,e){if(1&n&&(t.TgZ(0,"p",4),t._uU(1),t.qZA()),2&n){const o=t.oxw(2);t.xp6(1),t.AsE(" ",o.hideVendureBranding?"":"Vendure"," ",o.hideVersion?"":"Admin UI v"+o.version," ")}}function $t(n,e){if(1&n&&(t.TgZ(0,"div")(1,"h4",3),t._uU(2),t._UZ(3,"br"),t.TgZ(4,"small",4),t._uU(5),t.ALo(6,"timeAgo"),t.qZA()(),t.YNc(7,St,2,2,"p",5),t.qZA()),2&n){const o=e.ngIf,r=t.oxw();t.xp6(2),t.AsE(" Welcome, ",o.firstName," ",o.lastName,""),t.xp6(3),t.hij("Last login: ",t.lcZ(6,4,o.user.lastLogin),""),t.xp6(2),t.Q6J("ngIf",!r.hideVendureBranding||!r.hideVersion)}}C.\u0275fac=function(e){return new(e||C)},C.\u0275mod=t.oAB({type:C}),C.\u0275inj=t.cJS({});class Z{constructor(e){this.dataService=e,this.version=d.s5M,this.brand=(0,d.hq7)().brand,this.hideVendureBranding=(0,d.hq7)().hideVendureBranding,this.hideVersion=(0,d.hq7)().hideVersion}ngOnInit(){this.administrator$=this.dataService.administrator.getActiveAdministrator().mapStream(e=>e.activeAdministrator||null)}}Z.\u0275fac=function(e){return new(e||Z)(t.Y36(d.DoR))},Z.\u0275cmp=t.Xpm({type:Z,selectors:[["vdr-welcome-widget"]],decls:4,vars:3,consts:[[4,"ngIf"],[1,"placeholder"],["shape","line-chart","size","128"],[1,""],[1,"p5"],["class","p5",4,"ngIf"]],template:function(e,o){1&e&&(t.YNc(0,$t,8,6,"div",0),t.ALo(1,"async"),t.TgZ(2,"div",1),t._UZ(3,"clr-icon",2),t.qZA()),2&e&&t.Q6J("ngIf",t.lcZ(1,1,o.administrator$))},dependencies:[O.qvL,c.O5,c.Ov,I.e],styles:["[_nghost-%COMP%]{display:flex;justify-content:space-between}.placeholder[_ngcontent-%COMP%]{color:var(--color-grey-200)}"],changeDetection:0});class x{}x.\u0275fac=function(e){return new(e||x)},x.\u0275mod=t.oAB({type:x}),x.\u0275inj=t.cJS({imports:[d.IR2]})}}]);
//# sourceMappingURL=487.c6f542847c14a766.js.map